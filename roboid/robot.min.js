function RoboidWriteQueue(c){this.setSize(c);this.output=Array(19)}RoboidWriteQueue.prototype.setSize=function(c){this.buffer=Array(c);this.mask=c-1;this.consumer=this.provider=0};RoboidWriteQueue.prototype.reset=function(){this.consumer=this.provider=0};
RoboidWriteQueue.prototype.stringToUtf8ByteArray=function(c){for(var a=[],e=0,d,b=0;b<c.length;b++)d=c.charCodeAt(b),128>d?a[e++]=d:(2048>d?a[e++]=d>>6|192:(55296==(d&64512)&&b+1<c.length&&56320==(c.charCodeAt(b+1)&64512)?(d=65536+((d&1023)<<10)+(c.charCodeAt(++b)&1023),a[e++]=d>>18|240,a[e++]=d>>12&63|128):a[e++]=d>>12|224,a[e++]=d>>6&63|128),a[e++]=d&63|128);return a};
RoboidWriteQueue.prototype.push=function(c,a){var e=this.buffer,d=this.mask,b=this.provider,f=this.consumer;if(0<c.length)for(var g=this.stringToUtf8ByteArray(c),h=0;h<g.length;++h)(b-f&d)==d&&(f=f+1&d),e[b]=g[h],b=b+1&d;a&&((b-f&d)==d&&(f=f+1&d),e[b]=13,b=b+1&d);this.provider=b;this.consumer=f};RoboidWriteQueue.prototype.pushRaw=function(c,a,e){for(var d=this.buffer,b=this.mask,f=this.provider,g=this.consumer;a<e;++a)(f-g&b)==b&&(g=g+1&b),d[f]=c[a],f=f+1&b;this.provider=f;this.consumer=g};
RoboidWriteQueue.prototype.pop=function(){var c=this.provider,a=this.consumer;if(c!=a){var e=this.buffer,d=this.mask,b=this.output,f=c-a&d;18<f&&(f=18);b[0]=f;for(var g=1;g<=f&&a!=c;++g)b[g]=e[a],a=a+1&d;for(;18>=g;++g)b[g]=0;this.consumer=a;return b}};function RoboidReadQueue(c){this.setSize(c)}RoboidReadQueue.prototype.setSize=function(c){this.buffer=Array(c);this.mask=c-1;this.consumer=this.provider=0};RoboidReadQueue.prototype.reset=function(){this.consumer=this.provider=0};
RoboidReadQueue.prototype.utf8ByteArrayToString=function(c,a,e){for(var d=this.mask,b=[],f=0,g,h,k,l;a!=e;)if(g=c[a],a=a+1&d,128>g)b[f++]=String.fromCharCode(g);else if(191<g&&224>g){if(a==e)break;h=c[a];a=a+1&d;b[f++]=String.fromCharCode((g&31)<<6|h&63)}else if(239<g&&365>g){if(a==e)break;h=c[a];a=a+1&d;if(a==e)break;k=c[a];a=a+1&d;if(a==e)break;l=c[a];a=a+1&d;g=((g&7)<<18|(h&63)<<12|(k&63)<<6|l&63)-65536;b[f++]=String.fromCharCode(55296+(g>>10));b[f++]=String.fromCharCode(56320+(g&1023))}else{if(a==
e)break;h=c[a];a=a+1&d;if(a==e)break;k=c[a];a=a+1&d;b[f++]=String.fromCharCode((g&15)<<12|(h&63)<<6|k&63)}this.consumer=a;return b.join("")};RoboidReadQueue.prototype.push=function(c,a){var e=c[a];if(0<e){18<e&&(e=18);var d=this.buffer,b=this.mask,f=this.provider,g=this.consumer;e+=a;for(var h=1+a;h<=e;++h)(f-g&b)==b&&(g=g+1&b),d[f]=c[h],f=f+1&b;this.provider=f;this.consumer=g}};
RoboidReadQueue.prototype.pop=function(c){var a=this.provider,e=this.consumer;if(a!=e){if(0==c)return this.utf8ByteArrayToString(this.buffer,e,a);for(var d=this.buffer,b=this.mask,f=-1;e!=a;){if(d[e]==c){f=e;break}e=e+1&b}if(0<=f)return c=this.utf8ByteArrayToString(d,this.consumer,f),this.consumer=this.consumer+1&b,c}};
function Hamster(a){this.sensory={map:0,signalStrength:0,leftProximity:0,rightProximity:0,leftFloor:0,rightFloor:0,accelerationX:0,accelerationY:0,accelerationZ:0,light:0,temperature:0,inputA:0,inputB:0,lineTracerState:0,tilt:0,batteryState:2,handFound:!1};this.motoring={module:"hamster",index:a,map:4227858432,leftWheel:0,rightWheel:0,buzzer:0,outputA:0,outputB:0,leftLed:0,rightLed:0,note:0,lineTracerMode:0,lineTracerSpeed:5,ioModeA:0,ioModeB:0,motion:0,radius:5};this.wheelId=this.blockId=0;this.lineTracerCallback=
this.wheelTimer=void 0;this.boardCount=this.boardState=this.boardCommand=0;this.boardCallback=void 0;this.noteId=0;this.noteTimer2=this.noteTimer1=void 0;this.ioId=0;this.ioTimer=void 0;this.tempo=60;this.timeouts=[]}
Hamster.prototype.reset=function(){var a=this.motoring;a.map=4261150720;a.leftWheel=0;a.rightWheel=0;a.buzzer=0;a.outputA=0;a.outputB=0;a.leftLed=0;a.rightLed=0;a.note=0;a.lineTracerMode=0;a.lineTracerSpeed=5;a.ioModeA=0;a.ioModeB=0;a.motion=0;a.radius=5;this.wheelId=this.blockId=0;this.lineTracerCallback=this.wheelTimer=void 0;this.boardCount=this.boardState=this.boardCommand=0;this.boardCallback=void 0;this.noteId=0;this.noteTimer2=this.noteTimer1=void 0;this.ioId=0;this.ioTimer=void 0;this.tempo=
60;this.__removeAllTimeouts()};Hamster.prototype.__removeTimeout=function(a){clearTimeout(a);a=this.timeouts.indexOf(a);0<=a&&this.timeouts.splice(a,1)};Hamster.prototype.__removeAllTimeouts=function(){var a=this.timeouts,b;for(b in a)clearTimeout(a[b]);this.timeouts=[]};Hamster.prototype.clearMotoring=function(){this.motoring.map=4227858432};Hamster.prototype.clearEvent=function(){};Hamster.prototype.__issueWheelId=function(){return this.wheelId=this.blockId=this.blockId%65535+1};
Hamster.prototype.__cancelWheel=function(){this.wheelId=0;void 0!==this.wheelTimer&&this.__removeTimeout(this.wheelTimer);this.wheelTimer=void 0};Hamster.prototype.__setLineTracerMode=function(a){this.motoring.lineTracerMode=a;this.motoring.map|=2097152};Hamster.prototype.__setLineTracerSpeed=function(a){this.motoring.lineTracerSpeed=a;this.motoring.map|=1048576};Hamster.prototype.__cancelLineTracer=function(){this.lineTracerCallback=void 0};
Hamster.prototype.__cancelBoard=function(){this.boardCount=this.boardState=this.boardCommand=0;this.boardCallback=void 0};Hamster.prototype.__setLeftLed=function(a){this.motoring.leftLed=a;this.motoring.map|=16777216};Hamster.prototype.__setRightLed=function(a){this.motoring.rightLed=a;this.motoring.map|=8388608};Hamster.prototype.__setNote=function(a){this.motoring.note=a;this.motoring.map|=4194304};Hamster.prototype.__issueNoteId=function(){return this.noteId=this.blockId=this.blockId%65535+1};
Hamster.prototype.__cancelNote=function(){this.noteId=0;void 0!==this.noteTimer1&&this.__removeTimeout(this.noteTimer1);void 0!==this.noteTimer2&&this.__removeTimeout(this.noteTimer2);this.noteTimer2=this.noteTimer1=void 0};Hamster.prototype.__setIoModeA=function(a){this.motoring.ioModeA=a;this.motoring.map|=524288};Hamster.prototype.__setIoModeB=function(a){this.motoring.ioModeB=a;this.motoring.map|=262144};
Hamster.prototype.__issueIoId=function(){return this.ioId=this.blockId=this.blockId%65535+1};Hamster.prototype.__cancelIo=function(){this.ioId=0;void 0!==this.ioTimer&&this.__removeTimeout(this.ioTimer);this.ioTimer=void 0};
Hamster.prototype.handleSensory=function(){var a=this,b=a.sensory;if(a.lineTracerCallback&&0!=(b.map&16)&&64==b.lineTracerState){a.__setLineTracerMode(0);var c=a.lineTracerCallback;a.__cancelLineTracer();c&&c()}if(a.boardCallback){var d=a.motoring;if(1==a.boardCommand)switch(a.boardState){case 1:2>a.boardCount?(50>b.leftFloor&&50>b.rightFloor?a.boardCount++:a.boardCount=0,b=b.leftFloor-b.rightFloor,d.leftWheel=45+.25*b,d.rightWheel=45-.25*b):(a.boardCount=0,a.boardState=2);break;case 2:b=b.leftFloor-
b.rightFloor;d.leftWheel=45+.25*b;d.rightWheel=45-.25*b;a.boardState=3;a.wheelTimer=setTimeout(function(){d.leftWheel=0;d.rightWheel=0;a.boardState=4;void 0!==a.wheelTimer&&a.__removeTimeout(a.wheelTimer);a.wheelTimer=void 0},250);a.timeouts.push(a.wheelTimer);break;case 3:b=b.leftFloor-b.rightFloor;d.leftWheel=45+.25*b;d.rightWheel=45-.25*b;break;case 4:d.leftWheel=0,d.rightWheel=0,b=a.boardCallback,a.__cancelBoard(),b&&b()}else if(2==a.boardCommand)switch(a.boardState){case 1:2>a.boardCount?50<
b.leftFloor&&a.boardCount++:(a.boardCount=0,a.boardState=2);break;case 2:20>b.leftFloor&&(a.boardState=3);break;case 3:2>a.boardCount?20>b.leftFloor&&a.boardCount++:(a.boardCount=0,a.boardState=4);break;case 4:50<b.leftFloor&&(a.boardState=5);break;case 5:b=b.leftFloor-b.rightFloor,-15<b?(d.leftWheel=0,d.rightWheel=0,b=a.boardCallback,a.__cancelBoard(),b&&b()):(d.leftWheel=.5*b,d.rightWheel=.5*-b)}else if(3==a.boardCommand)switch(a.boardState){case 1:2>a.boardCount?50<b.rightFloor&&a.boardCount++:
(a.boardCount=0,a.boardState=2);break;case 2:20>b.rightFloor&&(a.boardState=3);break;case 3:2>a.boardCount?20>b.rightFloor&&a.boardCount++:(a.boardCount=0,a.boardState=4);break;case 4:50<b.rightFloor&&(a.boardState=5);break;case 5:b=b.rightFloor-b.leftFloor,-15<b?(d.leftWheel=0,d.rightWheel=0,b=a.boardCallback,a.__cancelBoard(),b&&b()):(d.leftWheel=.5*-b,d.rightWheel=.5*b)}}};
Hamster.prototype.__board=function(a,b,c,d){var e=this.motoring;this.__cancelWheel();this.__cancelLineTracer();e.leftWheel=a;e.rightWheel=b;e.motion=0;this.boardCommand=c;this.boardCount=0;this.boardState=1;this.boardCallback=d;this.__setLineTracerMode(0)};Hamster.prototype.boardForward=function(a){this.__board(45,45,1,a)};Hamster.prototype.boardTurn=function(a,b){"left"==a?this.__board(-45,45,2,b):this.__board(45,-45,3,b)};
Hamster.prototype.__motion=function(a,b,c,d,e){var g=this,f=g.motoring;g.__cancelBoard();g.__cancelWheel();g.__cancelLineTracer();if((d=parseFloat(d))&&0<d){var h=g.__issueWheelId();f.leftWheel=b;f.rightWheel=c;f.motion=a;g.__setLineTracerMode(0);g.wheelTimer=setTimeout(function(){g.wheelId==h&&(f.leftWheel=0,f.rightWheel=0,f.motion=0,g.__cancelWheel(),e())},1E3*d);g.timeouts.push(g.wheelTimer)}else f.leftWheel=0,f.rightWheel=0,f.motion=0,g.__setLineTracerMode(0),e()};
Hamster.prototype.moveForward=function(a){this.__motion(1,30,30,1,a)};Hamster.prototype.moveBackward=function(a){this.__motion(2,-30,-30,1,a)};Hamster.prototype.turn=function(a,b){"left"==a?this.__motion(3,-30,30,1,b):this.__motion(4,30,-30,1,b)};Hamster.prototype.moveForwardSecs=function(a,b){0>a?this.__motion(2,-30,-30,-a,b):this.__motion(1,30,30,a,b)};Hamster.prototype.moveBackwardSecs=function(a,b){0>a?this.__motion(1,30,30,-a,b):this.__motion(2,-30,-30,a,b)};
Hamster.prototype.turnSecs=function(a,b,c){"left"==a?0>b?this.__motion(4,30,-30,-b,c):this.__motion(3,-30,30,b,c):0>b?this.__motion(3,-30,30,-b,c):this.__motion(4,30,-30,b,c)};Hamster.prototype.__stopMotion=function(){var a=this.motoring;this.__cancelBoard();this.__cancelWheel();this.__cancelLineTracer();a.leftWheel=0;a.rightWheel=0;a.motion=0;this.__setLineTracerMode(0)};Hamster.prototype.moveForwardUnit=function(a,b,c){"seconds"==b?this.moveForwardSecs(a,c):this.__stopMotion()};
Hamster.prototype.moveBackwardUnit=function(a,b,c){"seconds"==b?this.moveBackwardSecs(a,c):this.__stopMotion()};Hamster.prototype.turnUnit=function(a,b,c,d){"seconds"==c?this.turnSecs(a,b,d):this.__stopMotion()};
Hamster.prototype.pivotWheelUnit=function(a,b,c,d,e){"seconds"==c?"left"==a?"forward"==d?0>b?this.__motion(6,0,-30,-b,e):this.__motion(5,0,30,b,e):0>b?this.__motion(5,0,30,-b,e):this.__motion(6,0,-30,b,e):"forward"==d?0>b?this.__motion(8,-30,0,-b,e):this.__motion(7,30,0,b,e):0>b?this.__motion(7,30,0,-b,e):this.__motion(8,-30,0,b,e):this.__stopMotion()};
Hamster.prototype.swingBodyUnit=function(a,b,c,d,e,g){"seconds"==c?(d=parseFloat(d),"number"==typeof d&&0<=d?(this.motoring.radius=d,"left"==a?"forward"==e?0>b?this.__motion(10,0,0,-b,g):this.__motion(9,0,0,b,g):0>b?this.__motion(9,0,0,-b,g):this.__motion(10,0,0,b,g):"forward"==e?0>b?this.__motion(12,0,0,-b,g):this.__motion(11,0,0,b,g):0>b?this.__motion(11,0,0,-b,g):this.__motion(12,0,0,b,g)):(this.__stopMotion(),g())):this.__stopMotion()};
Hamster.prototype.pivotUnit=function(a,b,c,d,e){"seconds"==c?"left pen"==a?"forward"==d?0>b?this.__motion(14,0,0,-b,e):this.__motion(13,0,0,b,e):0>b?this.__motion(13,0,0,-b,e):this.__motion(14,0,0,b,e):"right pen"==a?"forward"==d?0>b?this.__motion(16,0,0,-b,e):this.__motion(15,0,0,b,e):0>b?this.__motion(15,0,0,-b,e):this.__motion(16,0,0,b,e):"left wheel"==a?"forward"==d?0>b?this.__motion(6,0,-30,-b,e):this.__motion(5,0,30,b,e):0>b?this.__motion(5,0,30,-b,e):this.__motion(6,0,-30,b,e):"forward"==d?
0>b?this.__motion(8,-30,0,-b,e):this.__motion(7,30,0,b,e):0>b?this.__motion(7,30,0,-b,e):this.__motion(8,-30,0,b,e):this.__stopMotion()};
Hamster.prototype.swingUnit=function(a,b,c,d,e,g,f){"seconds"==d?(e=parseFloat(e),"number"==typeof e&&0<=e?(this.motoring.radius=e,"left pen"==a?"left"==b?"forward"==g?0>c?this.__motion(18,0,0,-c,f):this.__motion(17,0,0,c,f):0>c?this.__motion(17,0,0,-c,f):this.__motion(18,0,0,c,f):"forward"==g?0>c?this.__motion(20,0,0,-c,f):this.__motion(19,0,0,c,f):0>c?this.__motion(19,0,0,-c,f):this.__motion(20,0,0,c,f):"right pen"==a?"left"==b?"forward"==g?0>c?this.__motion(22,0,0,-c,f):this.__motion(21,0,0,c,
f):0>c?this.__motion(21,0,0,-c,f):this.__motion(22,0,0,c,f):"forward"==g?0>c?this.__motion(24,0,0,-c,f):this.__motion(23,0,0,c,f):0>c?this.__motion(23,0,0,-c,f):this.__motion(24,0,0,c,f):"left"==b?"forward"==g?0>c?this.__motion(10,0,0,-c,f):this.__motion(9,0,0,c,f):0>c?this.__motion(9,0,0,-c,f):this.__motion(10,0,0,c,f):"forward"==g?0>c?this.__motion(12,0,0,-c,f):this.__motion(11,0,0,c,f):0>c?this.__motion(11,0,0,-c,f):this.__motion(12,0,0,c,f)):(this.__stopMotion(),f())):this.__stopMotion()};
Hamster.prototype.setWheels=function(a,b){var c=this.motoring;this.__cancelBoard();this.__cancelWheel();this.__cancelLineTracer();a=parseFloat(a);b=parseFloat(b);"number"==typeof a&&(c.leftWheel=a);"number"==typeof b&&(c.rightWheel=b);c.motion=0;this.__setLineTracerMode(0)};
Hamster.prototype.changeWheels=function(a,b){var c=this.motoring;this.__cancelBoard();this.__cancelWheel();this.__cancelLineTracer();a=parseFloat(a);b=parseFloat(b);"number"==typeof a&&(c.leftWheel+=a);"number"==typeof b&&(c.rightWheel+=b);c.motion=0;this.__setLineTracerMode(0)};
Hamster.prototype.setWheel=function(a,b){var c=this.motoring;this.__cancelBoard();this.__cancelWheel();this.__cancelLineTracer();b=parseFloat(b);"number"==typeof b&&("left"==a?c.leftWheel=b:("right"!=a&&(c.leftWheel=b),c.rightWheel=b));c.motion=0;this.__setLineTracerMode(0)};
Hamster.prototype.changeWheel=function(a,b){var c=this.motoring;this.__cancelBoard();this.__cancelWheel();this.__cancelLineTracer();b=parseFloat(b);"number"==typeof b&&("left"==a?c.leftWheel+=b:("right"!=a&&(c.leftWheel+=b),c.rightWheel+=b));c.motion=0;this.__setLineTracerMode(0)};
Hamster.prototype.followLine=function(a,b){var c=this.motoring;this.__cancelBoard();this.__cancelWheel();this.__cancelLineTracer();var d=1;"right"==b?d=2:"both"==b&&(d=3);"white"==a&&(d+=7);c.leftWheel=0;c.rightWheel=0;c.motion=0;this.__setLineTracerMode(d)};
Hamster.prototype.followLineUntil=function(a,b,c){var d=this.motoring;this.__cancelBoard();this.__cancelWheel();var e=4;"right"==b?e=5:"front"==b?e=6:"rear"==b&&(e=7);"white"==a&&(e+=7);d.leftWheel=0;d.rightWheel=0;d.motion=0;this.__setLineTracerMode(e);this.lineTracerCallback=c};Hamster.prototype.setLineTracerSpeed=function(a){a=parseInt(a);"number"==typeof a&&this.__setLineTracerSpeed(a)};Hamster.prototype.setLineTracerGain=function(a){};
Hamster.prototype.stop=function(){var a=this.motoring;this.__cancelBoard();this.__cancelWheel();this.__cancelLineTracer();a.leftWheel=0;a.rightWheel=0;a.motion=0;this.__setLineTracerMode(0)};Hamster.prototype.__COLORS={red:4,orange:4,yellow:6,green:2,"sky blue":3,blue:1,violet:5,purple:5,white:7};Hamster.prototype.setLed=function(a,b){(b=this.__COLORS[b])&&0<b&&("left"==a?this.__setLeftLed(b):("right"!=a&&this.__setLeftLed(b),this.__setRightLed(b)))};
Hamster.prototype.clearLed=function(a){"left"==a?this.__setLeftLed(0):("right"!=a&&this.__setLeftLed(0),this.__setRightLed(0))};Hamster.prototype.setRgbArray=function(a,b){};Hamster.prototype.setRgb=function(a,b,c,d){};Hamster.prototype.changeRgb=function(a,b,c,d){};
Hamster.prototype.runBeep=function(a,b,c){if(a){var d=this,e=d.motoring;e.buzzer=440;d.__setNote(0);d.noteTimer1=setTimeout(function(){b&&d.noteId!=b||(e.buzzer=0,void 0!==d.noteTimer1&&d.__removeTimeout(d.noteTimer1),d.noteTimer1=void 0)},100);d.timeouts.push(d.noteTimer1);d.noteTimer2=setTimeout(function(){b&&d.noteId!=b||(e.buzzer=0,void 0!==d.noteTimer2&&d.__removeTimeout(d.noteTimer2),d.noteTimer2=void 0,0>a?d.runBeep(-1,b,c):1==a?(d.__cancelNote(),b&&c&&c()):d.runBeep(a-1,b,c))},200);d.timeouts.push(d.noteTimer2)}};
Hamster.prototype.beep=function(a){this.__cancelNote();var b=this.__issueNoteId();this.runBeep(1,b,a)};Hamster.prototype.playSound=function(a,b){this.__cancelNote();this.motoring.buzzer=0;this.__setNote(0);b=parseInt(b);"beep"==a&&b&&this.runBeep(b)};Hamster.prototype.playSoundUntil=function(a,b,c){this.__cancelNote();this.motoring.buzzer=0;this.__setNote(0);(b=parseInt(b))?"beep"==a&&(a=this.__issueNoteId(),this.runBeep(b,a,c)):c()};
Hamster.prototype.setBuzzer=function(a){var b=this.motoring;this.__cancelNote();a=parseFloat(a);"number"==typeof a&&(b.buzzer=a);this.__setNote(0)};Hamster.prototype.changeBuzzer=function(a){var b=this.motoring;this.__cancelNote();a=parseFloat(a);"number"==typeof a&&(b.buzzer+=a);this.__setNote(0)};Hamster.prototype.clearBuzzer=function(){this.__cancelNote();this.motoring.buzzer=0;this.__setNote(0)};Hamster.prototype.clearSound=function(){this.clearBuzzer()};
Hamster.prototype.__NOTES={C:4,"C\u266f (D\u266d)":5,D:6,"D\u266f (E\u266d)":7,E:8,F:9,"F\u266f (G\u266d)":10,G:11,"G\u266f (A\u266d)":12,A:13,"A\u266f (B\u266d)":14,B:15};Hamster.prototype.playNote=function(a,b){var c=this.motoring;this.__cancelNote();a=this.__NOTES[a];b=parseInt(b);c.buzzer=0;a&&b&&0<b&&8>b?this.__setNote(a+12*(b-1)):this.__setNote(0)};
Hamster.prototype.playNoteBeat=function(a,b,c,d){var e=this,g=e.motoring;e.__cancelNote();a=e.__NOTES[a];b=parseInt(b);c=parseFloat(c);g.buzzer=0;if(a&&b&&0<b&&8>b&&c&&0<c&&0<e.tempo){var f=e.__issueNoteId();e.__setNote(a+12*(b-1));a=6E4*c/e.tempo;b=100<a?100:0;0<b&&(e.noteTimer1=setTimeout(function(){e.noteId==f&&(e.__setNote(0),void 0!==e.noteTimer1&&e.__removeTimeout(e.noteTimer1),e.noteTimer1=void 0)},a-b),e.timeouts.push(e.noteTimer1));e.noteTimer2=setTimeout(function(){e.noteId==f&&(e.__setNote(0),
e.__cancelNote(),d())},a);e.timeouts.push(e.noteTimer2)}else e.__setNote(0),d()};Hamster.prototype.restBeat=function(a,b){var c=this,d=c.motoring;c.__cancelNote();a=parseFloat(a);d.buzzer=0;c.__setNote(0);if(a&&0<a&&0<c.tempo){var e=c.__issueNoteId();c.noteTimer1=setTimeout(function(){c.noteId==e&&(c.__cancelNote(),b())},6E4*a/c.tempo);c.timeouts.push(c.noteTimer1)}else b()};Hamster.prototype.setTempo=function(a){a=parseFloat(a);"number"==typeof a&&(this.tempo=a,1>this.tempo&&(this.tempo=1))};
Hamster.prototype.changeTempo=function(a){a=parseFloat(a);"number"==typeof a&&(this.tempo+=a,1>this.tempo&&(this.tempo=1))};Hamster.prototype.getLeftProximity=function(){return this.sensory.leftProximity};Hamster.prototype.getRightProximity=function(){return this.sensory.rightProximity};Hamster.prototype.getLeftFloor=function(){return this.sensory.leftFloor};Hamster.prototype.getRightFloor=function(){return this.sensory.rightFloor};Hamster.prototype.getAccelerationX=function(){return this.sensory.accelerationX};
Hamster.prototype.getAccelerationY=function(){return this.sensory.accelerationY};Hamster.prototype.getAccelerationZ=function(){return this.sensory.accelerationZ};Hamster.prototype.getLight=function(){return this.sensory.light};Hamster.prototype.getTemperature=function(){return this.sensory.temperature};Hamster.prototype.getSignalStrength=function(){return this.sensory.signalStrength};
Hamster.prototype.checkHandFound=function(){var a=this.sensory;return void 0===a.handFound?40<a.leftProximity||40<a.rightProximity:a.handFound};Hamster.prototype.checkTilt=function(a){switch(a){case "tilt forward":return 1==this.sensory.tilt;case "tilt backward":return-1==this.sensory.tilt;case "tilt left":return 2==this.sensory.tilt;case "tilt right":return-2==this.sensory.tilt;case "tilt flip":return 3==this.sensory.tilt;case "not tilt":return-3==this.sensory.tilt}return!1};
Hamster.prototype.__BATTERY_STATES={normal:2,low:1,empty:0};Hamster.prototype.checkBattery=function(a){return this.sensory.batteryState==this.__BATTERY_STATES[a]};Hamster.prototype.__IO_MODES={"analog input":0,"digital input":1,"servo output":8,"pwm output":9,"digital output":10};Hamster.prototype.setIoMode=function(a,b){this.__cancelIo();b=this.__IO_MODES[b];"number"==typeof b&&("A"==a?this.__setIoModeA(b):("B"!=a&&this.__setIoModeA(b),this.__setIoModeB(b)))};
Hamster.prototype.setOutput=function(a,b){var c=this.motoring;this.__cancelIo();b=parseFloat(b);"number"==typeof b&&("A"==a?c.outputA=b:("B"!=a&&(c.outputA=b),c.outputB=b))};Hamster.prototype.changeOutput=function(a,b){var c=this.motoring;this.__cancelIo();b=parseFloat(b);"number"==typeof b&&("A"==a?c.outputA+=b:("B"!=a&&(c.outputA+=b),c.outputB+=b))};
Hamster.prototype.gripper=function(a,b){var c=this,d=c.motoring;c.__cancelIo();var e=c.__issueIoId();c.__setIoModeA(10);c.__setIoModeB(10);"open"==a?(d.outputA=1,d.outputB=0):(d.outputA=0,d.outputB=1);c.ioTimer=setTimeout(function(){c.ioId==e&&(c.__cancelIo(),b())},500);c.timeouts.push(c.ioTimer)};Hamster.prototype.releaseGripper=function(){var a=this.motoring;this.__cancelIo();this.__setIoModeA(10);this.__setIoModeB(10);a.outputA=0;a.outputB=0};Hamster.prototype.getInputA=function(){return this.sensory.inputA};
Hamster.prototype.getInputB=function(){return this.sensory.inputB};Hamster.prototype.writeSerial=function(a,b,c){this.__cancelIo()};Hamster.prototype.readSerialUltil=function(a,b){this.__cancelIo()};Hamster.prototype.setSerialRate=function(a){this.__cancelIo()};Hamster.prototype.getSerialInput=function(){return""};
function HamsterS(a){this.sensory={map1:0,map2:0,signalStrength:0,leftProximity:0,rightProximity:0,leftFloor:0,rightFloor:0,accelerationX:0,accelerationY:0,accelerationZ:0,light:0,temperature:0,inputA:0,inputB:0,tilt:0,serial:"",pulseCount:0,wheelState:0,soundState:0,lineTracerState:0,batteryState:2,handFound:!1};this.motoring={module:"hamsterS",index:a,map1:4227858432,map2:3221225472,leftWheel:0,rightWheel:0,leftRed:0,leftGreen:0,leftBlue:0,rightRed:0,rightGreen:0,rightBlue:0,buzzer:0,outputA:0,
outputB:0,pulse:0,note:0,sound:0,lineTracerMode:0,lineTracerGain:4,lineTracerSpeed:5,ioModeA:0,ioModeB:0,serial:void 0,motionType:0,motionUnit:0,motionSpeed:0,motionValue:0,motionRadius:0};this.blockId=0;this.lineTracerCallback=this.motionCallback=void 0;this.boardCount=this.boardState=this.boardCommand=0;this.boardCallback=void 0;this.currentSound=0;this.soundRepeat=1;this.soundCallback=void 0;this.noteId=0;this.noteTimer2=this.noteTimer1=void 0;this.ioId=0;this.ioTimer=void 0;this.serialDelimiter=
0;this.serialRate=176;this.writeSerialCallbacks=[];this.readSerialCallbacks=[];this.serialInput="";this.tap=this.freeFall=!1;this.tempo=60;this.speed=5;this.gain=-1;this.writeQueue=new RoboidWriteQueue(64);this.readQueue=new RoboidReadQueue(64);this.timeouts=[]}
HamsterS.prototype.reset=function(){var a=this.motoring;a.map1=4235984896;a.map2=4194304E3;a.leftWheel=0;a.rightWheel=0;a.leftRed=0;a.leftGreen=0;a.leftBlue=0;a.rightRed=0;a.rightGreen=0;a.rightBlue=0;a.buzzer=0;a.outputA=0;a.outputB=0;a.pulse=0;a.note=0;a.sound=0;a.lineTracerMode=0;a.lineTracerGain=4;a.lineTracerSpeed=5;a.ioModeA=0;a.ioModeB=0;a.serial=void 0;a.motionType=0;a.motionUnit=0;a.motionSpeed=0;a.motionValue=0;this.blockId=a.motionRadius=0;this.lineTracerCallback=this.motionCallback=void 0;
this.boardCount=this.boardState=this.boardCommand=0;this.boardCallback=void 0;this.currentSound=0;this.soundRepeat=1;this.soundCallback=void 0;this.noteId=0;this.noteTimer2=this.noteTimer1=void 0;this.ioId=0;this.ioTimer=void 0;this.serialDelimiter=0;this.serialRate=176;this.writeSerialCallbacks=[];this.readSerialCallbacks=[];this.serialInput="";this.tap=this.freeFall=!1;this.tempo=60;this.speed=5;this.gain=-1;this.__removeAllTimeouts();this.writeQueue.reset();this.readQueue.reset()};
HamsterS.prototype.__removeTimeout=function(a){clearTimeout(a);a=this.timeouts.indexOf(a);0<=a&&this.timeouts.splice(a,1)};HamsterS.prototype.__removeAllTimeouts=function(){var a=this.timeouts,b;for(b in a)clearTimeout(a[b]);this.timeouts=[]};HamsterS.prototype.__fireWriteSerialCallbacks=function(){var a=this.writeSerialCallbacks,b;for(b in a)a[b]();this.writeSerialCallbacks=[]};
HamsterS.prototype.__fireReadSerialCallbacks=function(){var a=this.readSerialCallbacks,b;for(b in a)a[b]();this.readSerialCallbacks=[]};HamsterS.prototype.clearMotoring=function(){this.motoring.map1=4227858432;this.motoring.map2=3221225472};HamsterS.prototype.clearEvent=function(){this.tap=this.freeFall=!1};HamsterS.prototype.__setPulse=function(a){this.motoring.pulse=a;this.motoring.map2|=536870912};
HamsterS.prototype.__setLineTracerMode=function(a){this.motoring.lineTracerMode=a;this.motoring.map1|=2097152};HamsterS.prototype.__setLineTracerGain=function(a){this.motoring.lineTracerGain=a;this.motoring.map2|=134217728};HamsterS.prototype.__setLineTracerSpeed=function(a){this.motoring.lineTracerSpeed=a;this.motoring.map1|=1048576};HamsterS.prototype.__cancelLineTracer=function(){this.lineTracerCallback=void 0};
HamsterS.prototype.__setMotion=function(a,b,c,e,d){var f=this.motoring;f.motionType=a;f.motionUnit=b;f.motionSpeed=c;f.motionValue=e;f.motionRadius=d;f.map2|=33554432};HamsterS.prototype.__cancelMotion=function(){this.motionCallback=void 0};HamsterS.prototype.__cancelBoard=function(){this.boardCount=this.boardState=this.boardCommand=0;this.boardCallback=void 0};HamsterS.prototype.__setNote=function(a){this.motoring.note=a;this.motoring.map1|=4194304};
HamsterS.prototype.__issueNoteId=function(){return this.noteId=this.blockId=this.blockId%65535+1};HamsterS.prototype.__cancelNote=function(){this.noteId=0;void 0!==this.noteTimer1&&this.__removeTimeout(this.noteTimer1);void 0!==this.noteTimer2&&this.__removeTimeout(this.noteTimer2);this.noteTimer2=this.noteTimer1=void 0};HamsterS.prototype.__setSound=function(a){this.motoring.sound=a;this.motoring.map2|=268435456};
HamsterS.prototype.__runSound=function(a,b){"number"!=typeof b&&(b=1);0>b&&(b=-1);b&&(this.currentSound=a,this.soundRepeat=b,this.__setSound(a))};HamsterS.prototype.__cancelSound=function(){this.soundCallback=void 0};HamsterS.prototype.__setIoModeA=function(a){this.motoring.ioModeA=a;this.motoring.map1|=524288};HamsterS.prototype.__setIoModeB=function(a){this.motoring.ioModeB=a;this.motoring.map1|=262144};HamsterS.prototype.__issueIoId=function(){return this.ioId=this.blockId=this.blockId%65535+1};
HamsterS.prototype.__cancelIo=function(){this.ioId=0;void 0!==this.ioTimer&&this.__removeTimeout(this.ioTimer);this.ioTimer=void 0};HamsterS.prototype.__setSerial=function(a){var b=this.motoring;void 0==b.serial&&(b.serial=Array(19));for(var c=0;19>c;++c)b.serial[c]=a[c];b.map2|=67108864};
HamsterS.prototype.handleSensory=function(){var a=this,b=a.sensory;b.map2&32768&&(a.freeFall=!0);b.map2&16384&&(a.tap=!0);if(a.lineTracerCallback&&0!=(b.map1&16)&&64==b.lineTracerState){a.__setLineTracerMode(0);var c=a.lineTracerCallback;a.__cancelLineTracer();c&&c()}if(a.boardCallback){var e=a.motoring;if(1==a.boardCommand)switch(a.boardState){case 1:2>a.boardCount?(50>b.leftFloor&&50>b.rightFloor?a.boardCount++:a.boardCount=0,c=b.leftFloor-b.rightFloor,e.leftWheel=45+.25*c,e.rightWheel=45-.25*c):
(a.boardCount=0,a.boardState=2);break;case 2:c=b.leftFloor-b.rightFloor;e.leftWheel=45+.25*c;e.rightWheel=45-.25*c;a.boardState=3;a.wheelTimer=setTimeout(function(){e.leftWheel=0;e.rightWheel=0;a.boardState=4;void 0!==a.wheelTimer&&a.__removeTimeout(a.wheelTimer);a.wheelTimer=void 0},250);a.timeouts.push(a.wheelTimer);break;case 3:c=b.leftFloor-b.rightFloor;e.leftWheel=45+.25*c;e.rightWheel=45-.25*c;break;case 4:e.leftWheel=0,e.rightWheel=0,c=a.boardCallback,a.__cancelBoard(),c&&c()}else if(2==a.boardCommand)switch(a.boardState){case 1:2>
a.boardCount?50<b.leftFloor&&a.boardCount++:(a.boardCount=0,a.boardState=2);break;case 2:20>b.leftFloor&&(a.boardState=3);break;case 3:2>a.boardCount?20>b.leftFloor&&a.boardCount++:(a.boardCount=0,a.boardState=4);break;case 4:50<b.leftFloor&&(a.boardState=5);break;case 5:c=b.leftFloor-b.rightFloor,-15<c?(e.leftWheel=0,e.rightWheel=0,c=a.boardCallback,a.__cancelBoard(),c&&c()):(e.leftWheel=.5*c,e.rightWheel=.5*-c)}else if(3==a.boardCommand)switch(a.boardState){case 1:2>a.boardCount?50<b.rightFloor&&
a.boardCount++:(a.boardCount=0,a.boardState=2);break;case 2:20>b.rightFloor&&(a.boardState=3);break;case 3:2>a.boardCount?20>b.rightFloor&&a.boardCount++:(a.boardCount=0,a.boardState=4);break;case 4:50<b.rightFloor&&(a.boardState=5);break;case 5:c=b.rightFloor-b.leftFloor,-15<c?(e.leftWheel=0,e.rightWheel=0,c=a.boardCallback,a.__cancelBoard(),c&&c()):(e.leftWheel=.5*-c,e.rightWheel=.5*c)}}a.motionCallback&&0!=(b.map2&2048)&&2==b.wheelState&&(a.motoring.leftWheel=0,a.motoring.rightWheel=0,c=a.motionCallback,
a.__cancelMotion(),c&&c());0!=(b.map2&1024)&&0==b.soundState&&(0<a.currentSound?0>a.soundRepeat?a.__runSound(a.currentSound,-1):1<a.soundRepeat?(a.soundRepeat--,a.__runSound(a.currentSound,a.soundRepeat)):(a.currentSound=0,a.soundRepeat=1,c=a.soundCallback,a.__cancelSound(),c&&c()):(a.currentSound=0,a.soundRepeat=1,c=a.soundCallback,a.__cancelSound(),c&&c()));b.map2&8192&&b.serial&&a.readQueue.push(b.serial,0);b.map2&512&&((b=a.writeQueue.pop())?a.__setSerial(b):a.__fireWriteSerialCallbacks());0<
a.readSerialCallbacks.length&&(b=a.readQueue.pop(a.serialDelimiter))&&(a.serialInput=b,a.__fireReadSerialCallbacks())};HamsterS.prototype.__board=function(a,b,c,e){var d=this.motoring;this.__cancelMotion();this.__cancelLineTracer();d.leftWheel=a;d.rightWheel=b;this.boardCommand=c;this.boardCount=0;this.boardState=1;this.boardCallback=e;this.__setPulse(0);this.__setMotion(0,0,0,0,0);this.__setLineTracerMode(0)};HamsterS.prototype.boardForward=function(a){this.__board(45,45,1,a)};
HamsterS.prototype.boardTurn=function(a,b){"left"==a?this.__board(-45,45,2,b):this.__board(45,-45,3,b)};HamsterS.prototype.__UNITS={cm:1,degrees:1,seconds:2,pulses:3};HamsterS.prototype.__motion=function(a,b){var c=this.motoring;this.__cancelBoard();this.__cancelLineTracer();c.leftWheel=0;c.rightWheel=0;this.__setPulse(0);this.__setMotion(a,1,0,0,0);this.motionCallback=b;this.__setLineTracerMode(0)};
HamsterS.prototype.__motionUnit=function(a,b,c,e){var d=this.motoring;this.__cancelBoard();this.__cancelMotion();this.__cancelLineTracer();d.leftWheel=0;d.rightWheel=0;this.__setPulse(0);(c=parseFloat(c))&&0<c?(this.__setMotion(a,b,0,c,0),this.motionCallback=e,this.__setLineTracerMode(0)):(this.__setMotion(0,0,0,0,0),this.__setLineTracerMode(0),e())};
HamsterS.prototype.__motionUnitRadius=function(a,b,c,e,d){var f=this.motoring;this.__cancelBoard();this.__cancelMotion();this.__cancelLineTracer();f.leftWheel=0;f.rightWheel=0;this.__setPulse(0);c=parseFloat(c);e=parseFloat(e);c&&0<c&&"number"==typeof e&&0<=e?(this.__setMotion(a,b,0,c,e),this.motionCallback=d,this.__setLineTracerMode(0)):(this.__setMotion(0,0,0,0,0),this.__setLineTracerMode(0),d())};HamsterS.prototype.moveForward=function(a){this.__motion(101,a)};
HamsterS.prototype.moveBackward=function(a){this.__motion(102,a)};HamsterS.prototype.turn=function(a,b){"left"==a?this.__motion(103,b):this.__motion(104,b)};HamsterS.prototype.moveForwardSecs=function(a,b){0>a?this.__motionUnit(2,2,-a,b):this.__motionUnit(1,2,a,b)};HamsterS.prototype.moveBackwardSecs=function(a,b){0>a?this.__motionUnit(1,2,-a,b):this.__motionUnit(2,2,a,b)};
HamsterS.prototype.turnSecs=function(a,b,c){"left"==a?0>b?this.__motionUnit(4,2,-b,c):this.__motionUnit(3,2,b,c):0>b?this.__motionUnit(3,2,-b,c):this.__motionUnit(4,2,b,c)};HamsterS.prototype.moveForwardUnit=function(a,b,c){0>a?this.__motionUnit(2,this.__UNITS[b],-a,c):this.__motionUnit(1,this.__UNITS[b],a,c)};HamsterS.prototype.moveBackwardUnit=function(a,b,c){0>a?this.__motionUnit(1,this.__UNITS[b],-a,c):this.__motionUnit(2,this.__UNITS[b],a,c)};
HamsterS.prototype.turnUnit=function(a,b,c,e){"left"==a?0>b?this.__motionUnit(4,this.__UNITS[c],-b,e):this.__motionUnit(3,this.__UNITS[c],b,e):0>b?this.__motionUnit(3,this.__UNITS[c],-b,e):this.__motionUnit(4,this.__UNITS[c],b,e)};
HamsterS.prototype.pivotWheelUnit=function(a,b,c,e,d){c=this.__UNITS[c];"left"==a?"forward"==e?0>b?this.__motionUnit(6,c,-b,d):this.__motionUnit(5,c,b,d):0>b?this.__motionUnit(5,c,-b,d):this.__motionUnit(6,c,b,d):"forward"==e?0>b?this.__motionUnit(8,c,-b,d):this.__motionUnit(7,c,b,d):0>b?this.__motionUnit(7,c,-b,d):this.__motionUnit(8,c,b,d)};
HamsterS.prototype.swingBodyUnit=function(a,b,c,e,d,f){c=this.__UNITS[c];"left"==a?"forward"==d?0>b?this.__motionUnitRadius(10,c,-b,e,f):this.__motionUnitRadius(9,c,b,e,f):0>b?this.__motionUnitRadius(9,c,-b,e,f):this.__motionUnitRadius(10,c,b,e,f):"forward"==d?0>b?this.__motionUnitRadius(12,c,-b,e,f):this.__motionUnitRadius(11,c,b,e,f):0>b?this.__motionUnitRadius(11,c,-b,e,f):this.__motionUnitRadius(12,c,b,e,f)};
HamsterS.prototype.pivotUnit=function(a,b,c,e,d){c=this.__UNITS[c];"left pen"==a?"forward"==e?0>b?this.__motionUnit(14,c,-b,d):this.__motionUnit(13,c,b,d):0>b?this.__motionUnit(13,c,-b,d):this.__motionUnit(14,c,b,d):"right pen"==a?"forward"==e?0>b?this.__motionUnit(16,c,-b,d):this.__motionUnit(15,c,b,d):0>b?this.__motionUnit(15,c,-b,d):this.__motionUnit(16,c,b,d):"left wheel"==a?"forward"==e?0>b?this.__motionUnit(6,c,-b,d):this.__motionUnit(5,c,b,d):0>b?this.__motionUnit(5,c,-b,d):this.__motionUnit(6,
c,b,d):"forward"==e?0>b?this.__motionUnit(8,c,-b,d):this.__motionUnit(7,c,b,d):0>b?this.__motionUnit(7,c,-b,d):this.__motionUnit(8,c,b,d)};
HamsterS.prototype.swingUnit=function(a,b,c,e,d,f,g){e=this.__UNITS[e];"left pen"==a?"left"==b?"forward"==f?0>c?this.__motionUnitRadius(18,e,-c,d,g):this.__motionUnitRadius(17,e,c,d,g):0>c?this.__motionUnitRadius(17,e,-c,d,g):this.__motionUnitRadius(18,e,c,d,g):"forward"==f?0>c?this.__motionUnitRadius(20,e,-c,d,g):this.__motionUnitRadius(19,e,c,d,g):0>c?this.__motionUnitRadius(19,e,-c,d,g):this.__motionUnitRadius(20,e,c,d,g):"right pen"==a?"left"==b?"forward"==f?0>c?this.__motionUnitRadius(22,e,-c,
d,g):this.__motionUnitRadius(21,e,c,d,g):0>c?this.__motionUnitRadius(21,e,-c,d,g):this.__motionUnitRadius(22,e,c,d,g):"forward"==f?0>c?this.__motionUnitRadius(24,e,-c,d,g):this.__motionUnitRadius(23,e,c,d,g):0>c?this.__motionUnitRadius(23,e,-c,d,g):this.__motionUnitRadius(24,e,c,d,g):"left"==b?"forward"==f?0>c?this.__motionUnitRadius(10,e,-c,d,g):this.__motionUnitRadius(9,e,c,d,g):0>c?this.__motionUnitRadius(9,e,-c,d,g):this.__motionUnitRadius(10,e,c,d,g):"forward"==f?0>c?this.__motionUnitRadius(12,
e,-c,d,g):this.__motionUnitRadius(11,e,c,d,g):0>c?this.__motionUnitRadius(11,e,-c,d,g):this.__motionUnitRadius(12,e,c,d,g)};HamsterS.prototype.setWheels=function(a,b){var c=this.motoring;this.__cancelBoard();this.__cancelMotion();this.__cancelLineTracer();a=parseFloat(a);b=parseFloat(b);"number"==typeof a&&(c.leftWheel=a);"number"==typeof b&&(c.rightWheel=b);this.__setPulse(0);this.__setMotion(0,0,0,0,0);this.__setLineTracerMode(0)};
HamsterS.prototype.changeWheels=function(a,b){var c=this.motoring;this.__cancelBoard();this.__cancelMotion();this.__cancelLineTracer();a=parseFloat(a);b=parseFloat(b);"number"==typeof a&&(c.leftWheel+=a);"number"==typeof b&&(c.rightWheel+=b);this.__setPulse(0);this.__setMotion(0,0,0,0,0);this.__setLineTracerMode(0)};
HamsterS.prototype.setWheel=function(a,b){var c=this.motoring;this.__cancelBoard();this.__cancelMotion();this.__cancelLineTracer();b=parseFloat(b);"number"==typeof b&&("left"==a?c.leftWheel=b:("right"!=a&&(c.leftWheel=b),c.rightWheel=b));this.__setPulse(0);this.__setMotion(0,0,0,0,0);this.__setLineTracerMode(0)};
HamsterS.prototype.changeWheel=function(a,b){var c=this.motoring;this.__cancelBoard();this.__cancelMotion();this.__cancelLineTracer();b=parseFloat(b);"number"==typeof b&&("left"==a?c.leftWheel+=b:("right"!=a&&(c.leftWheel+=b),c.rightWheel+=b));this.__setPulse(0);this.__setMotion(0,0,0,0,0);this.__setLineTracerMode(0)};
HamsterS.prototype.followLine=function(a,b){var c=this.motoring;this.__cancelBoard();this.__cancelMotion();this.__cancelLineTracer();var e=1;"right"==b?e=2:"both"==b&&(e=3);"white"==a&&(e+=7);c.leftWheel=0;c.rightWheel=0;this.__setPulse(0);this.__setMotion(0,0,0,0,0);this.__setLineTracerMode(e)};
HamsterS.prototype.followLineUntil=function(a,b,c){var e=this.motoring;this.__cancelBoard();this.__cancelMotion();var d=4;"right"==b?d=5:"front"==b?d=6:"rear"==b&&(d=7);"white"==a&&(d+=7);e.leftWheel=0;e.rightWheel=0;this.__setPulse(0);this.__setMotion(0,0,0,0,0);this.__setLineTracerMode(d);this.lineTracerCallback=c};HamsterS.prototype.__GAINS={1:6,2:6,3:5,4:5,5:4,6:4,7:3,8:3};
HamsterS.prototype.setLineTracerSpeed=function(a){a=parseInt(a);var b=this.gain;0>b&&(b=this.__GAINS[a]);a&&b&&0<a&&0<b&&(this.speed=a,this.__setLineTracerSpeed(a),this.__setLineTracerGain(b))};HamsterS.prototype.setLineTracerGain=function(a){(a=parseInt(a))&&0<a?(this.gain=a,this.__setLineTracerGain(a)):(this.gain=-1,(a=this.__GAINS[this.speed])&&0<a&&this.__setLineTracerGain(a))};
HamsterS.prototype.stop=function(){var a=this.motoring;this.__cancelBoard();this.__cancelMotion();this.__cancelLineTracer();a.leftWheel=0;a.rightWheel=0;this.__setPulse(0);this.__setMotion(0,0,0,0,0);this.__setLineTracerMode(0)};HamsterS.prototype.__RGBS={red:[255,0,0],orange:[255,63,0],yellow:[255,255,0],green:[0,255,0],"sky blue":[0,255,255],blue:[0,0,255],violet:[63,0,255],purple:[255,0,255],white:[255,255,255]};
HamsterS.prototype.setLed=function(a,b){var c=this.__RGBS[b];c&&this.setRgb(a,c[0],c[1],c[2])};HamsterS.prototype.clearLed=function(a){this.setRgb(a,0,0,0)};HamsterS.prototype.setRgbArray=function(a,b){b&&this.setRgb(a,b[0],b[1],b[2])};
HamsterS.prototype.setRgb=function(a,b,c,e){var d=this.motoring;b=parseInt(b);c=parseInt(c);e=parseInt(e);"left"==a?("number"==typeof b&&(d.leftRed=b),"number"==typeof c&&(d.leftGreen=c),"number"==typeof e&&(d.leftBlue=e)):"right"==a?("number"==typeof b&&(d.rightRed=b),"number"==typeof c&&(d.rightGreen=c),"number"==typeof e&&(d.rightBlue=e)):("number"==typeof b&&(d.leftRed=b,d.rightRed=b),"number"==typeof c&&(d.leftGreen=c,d.rightGreen=c),"number"==typeof e&&(d.leftBlue=e,d.rightBlue=e))};
HamsterS.prototype.changeRgb=function(a,b,c,e){var d=this.motoring;b=parseInt(b);c=parseInt(c);e=parseInt(e);"left"==a?("number"==typeof b&&(d.leftRed+=b),"number"==typeof c&&(d.leftGreen+=c),"number"==typeof e&&(d.leftBlue+=e)):"right"==a?("number"==typeof b&&(d.rightRed+=b),"number"==typeof c&&(d.rightGreen+=c),"number"==typeof e&&(d.rightBlue+=e)):("number"==typeof b&&(d.leftRed+=b,d.rightRed+=b),"number"==typeof c&&(d.leftGreen+=c,d.rightGreen+=c),"number"==typeof e&&(d.leftBlue+=e,d.rightBlue+=
e))};HamsterS.prototype.__SOUNDS={beep:1,"random beep":2,noise:10,siren:3,engine:4,chop:11,robot:5,dibidibidip:8,"good job":9,happy:12,angry:13,sad:14,sleep:15,march:6,birthday:7};HamsterS.prototype.beep=function(a){this.playSoundUntil("beep",1,a)};HamsterS.prototype.playSound=function(a,b){var c=this.motoring;this.__cancelNote();this.__cancelSound();a=this.__SOUNDS[a];b=parseInt(b);c.buzzer=0;this.__setNote(0);a&&b?this.__runSound(a,b):this.__runSound(0)};
HamsterS.prototype.playSoundUntil=function(a,b,c){var e=this.motoring;this.__cancelNote();this.__cancelSound();a=this.__SOUNDS[a];b=parseInt(b);e.buzzer=0;this.__setNote(0);a&&b?(this.__runSound(a,b),this.soundCallback=c):(this.__runSound(0),c())};HamsterS.prototype.setBuzzer=function(a){var b=this.motoring;this.__cancelNote();this.__cancelSound();a=parseFloat(a);"number"==typeof a&&(b.buzzer=a);this.__setNote(0);this.__runSound(0)};
HamsterS.prototype.changeBuzzer=function(a){var b=this.motoring;this.__cancelNote();this.__cancelSound();a=parseFloat(a);"number"==typeof a&&(b.buzzer+=a);this.__setNote(0);this.__runSound(0)};HamsterS.prototype.clearBuzzer=function(){this.clearSound()};HamsterS.prototype.clearSound=function(){this.__cancelNote();this.__cancelSound();this.motoring.buzzer=0;this.__setNote(0);this.__runSound(0)};
HamsterS.prototype.__NOTES={C:4,"C\u266f (D\u266d)":5,D:6,"D\u266f (E\u266d)":7,E:8,F:9,"F\u266f (G\u266d)":10,G:11,"G\u266f (A\u266d)":12,A:13,"A\u266f (B\u266d)":14,B:15};HamsterS.prototype.playNote=function(a,b){var c=this.motoring;this.__cancelNote();this.__cancelSound();a=this.__NOTES[a];b=parseInt(b);c.buzzer=0;a&&b&&0<b&&8>b?this.__setNote(a+12*(b-1)):this.__setNote(0);this.__runSound(0)};
HamsterS.prototype.playNoteBeat=function(a,b,c,e){var d=this,f=d.motoring;d.__cancelNote();d.__cancelSound();a=this.__NOTES[a];b=parseInt(b);c=parseFloat(c);f.buzzer=0;if(a&&b&&0<b&&8>b&&c&&0<c&&0<d.tempo){var g=d.__issueNoteId();d.__setNote(a+12*(b-1));a=6E4*c/d.tempo;b=100<a?100:0;0<b&&(d.noteTimer1=setTimeout(function(){d.noteId==g&&(d.__setNote(0),void 0!==d.noteTimer1&&d.__removeTimeout(d.noteTimer1),d.noteTimer1=void 0)},a-b),d.timeouts.push(d.noteTimer1));d.noteTimer2=setTimeout(function(){d.noteId==
g&&(d.__setNote(0),d.__cancelNote(),e())},a);d.timeouts.push(d.noteTimer2);d.__runSound(0)}else d.__setNote(0),d.__runSound(0),e()};HamsterS.prototype.restBeat=function(a,b){var c=this,e=c.motoring;c.__cancelNote();c.__cancelSound();a=parseFloat(a);e.buzzer=0;c.__setNote(0);c.__runSound(0);if(a&&0<a&&0<c.tempo){var d=c.__issueNoteId();c.noteTimer1=setTimeout(function(){c.noteId==d&&(c.__cancelNote(),b())},6E4*a/c.tempo);c.timeouts.push(c.noteTimer1)}else b()};
HamsterS.prototype.setTempo=function(a){a=parseFloat(a);"number"==typeof a&&(this.tempo=a,1>this.tempo&&(this.tempo=1))};HamsterS.prototype.changeTempo=function(a){a=parseFloat(a);"number"==typeof a&&(this.tempo+=a,1>this.tempo&&(this.tempo=1))};HamsterS.prototype.getLeftProximity=function(){return this.sensory.leftProximity};HamsterS.prototype.getRightProximity=function(){return this.sensory.rightProximity};HamsterS.prototype.getLeftFloor=function(){return this.sensory.leftFloor};
HamsterS.prototype.getRightFloor=function(){return this.sensory.rightFloor};HamsterS.prototype.getAccelerationX=function(){return this.sensory.accelerationX};HamsterS.prototype.getAccelerationY=function(){return this.sensory.accelerationY};HamsterS.prototype.getAccelerationZ=function(){return this.sensory.accelerationZ};HamsterS.prototype.getLight=function(){return this.sensory.light};HamsterS.prototype.getTemperature=function(){return this.sensory.temperature};
HamsterS.prototype.getSignalStrength=function(){return this.sensory.signalStrength};HamsterS.prototype.checkHandFound=function(){var a=this.sensory;return void 0===a.handFound?50<a.leftProximity||50<a.rightProximity:a.handFound};
HamsterS.prototype.checkTilt=function(a){var b=this.sensory;switch(a){case "tilt forward":return 1==b.tilt;case "tilt backward":return-1==b.tilt;case "tilt left":return 2==b.tilt;case "tilt right":return-2==b.tilt;case "tilt flip":return 3==b.tilt;case "not tilt":return-3==b.tilt;case "tap":return this.tap;case "free fall":return this.freeFall}return!1};HamsterS.prototype.__BATTERY_STATES={normal:2,low:1,empty:0};HamsterS.prototype.checkBattery=function(a){return this.sensory.batteryState==this.__BATTERY_STATES[a]};
HamsterS.prototype.__IO_MODES={"analog input":0,"digital input":1,"digital input (pull up)":2,"digital input (pull down)":3,"voltage input":5,"servo output":8,"pwm output":9,"digital output":10};HamsterS.prototype.setIoMode=function(a,b){this.__cancelIo();b=this.__IO_MODES[b];"number"==typeof b&&("A"==a?this.__setIoModeA(b):("B"!=a&&this.__setIoModeA(b),this.__setIoModeB(b)))};
HamsterS.prototype.setOutput=function(a,b){var c=this.motoring;this.__cancelIo();b=parseFloat(b);"number"==typeof b&&("A"==a?c.outputA=b:("B"!=a&&(c.outputA=b),c.outputB=b))};HamsterS.prototype.changeOutput=function(a,b){var c=this.motoring;this.__cancelIo();b=parseFloat(b);"number"==typeof b&&("A"==a?c.outputA+=b:("B"!=a&&(c.outputA+=b),c.outputB+=b))};
HamsterS.prototype.gripper=function(a,b){var c=this,e=c.motoring;c.__cancelIo();var d=c.__issueIoId();c.__setIoModeA(10);c.__setIoModeB(10);"open"==a?(e.outputA=1,e.outputB=0):(e.outputA=0,e.outputB=1);c.ioTimer=setTimeout(function(){c.ioId==d&&(c.__cancelIo(),b())},500);c.timeouts.push(c.ioTimer)};HamsterS.prototype.releaseGripper=function(){var a=this.motoring;this.__cancelIo();this.__setIoModeA(10);this.__setIoModeB(10);a.outputA=0;a.outputB=0};HamsterS.prototype.getInputA=function(){return this.sensory.inputA};
HamsterS.prototype.getInputB=function(){return this.sensory.inputB};HamsterS.prototype.writeSerial=function(a,b,c){this.__cancelIo();this.__setIoModeA(this.serialRate);this.__setIoModeB(this.serialRate);var e=this.writeQueue;e.push(b,"string"!=a);if(a=e.pop())this.writeSerialCallbacks.push(c),this.__setSerial(a)};HamsterS.prototype.__SERIAL_DELIMITERS={all:0,"until new line":13,"until ,(comma)":44,"until :(colon)":58,"until $":36,"until #":35};
HamsterS.prototype.readSerialUltil=function(a,b){this.__cancelIo();this.__setIoModeA(this.serialRate);this.__setIoModeB(this.serialRate);a=this.__SERIAL_DELIMITERS[a];"number"==typeof a&&(this.serialDelimiter=a,this.readSerialCallbacks.push(b))};HamsterS.prototype.__SERIAL_BAUDS={9600:176,14400:177,19200:178,28800:179,38400:180,57600:181,76800:182,115200:183};HamsterS.prototype.setSerialRate=function(a){this.__cancelIo();(a=this.__SERIAL_BAUDS[a])&&0<a&&(this.serialRate=a,this.__setIoModeA(a),this.__setIoModeB(a))};
HamsterS.prototype.getSerialInput=function(){return this.serialInput};
function Turtle(a){this.sensory={map:0,signalStrength:0,colorRed:0,colorGreen:0,colorBlue:0,colorClear:0,floor:0,accelerationX:0,accelerationY:0,accelerationZ:0,temperature:0,button:0,colorNumber:-1,colorPattern:-1,pulseCount:0,tilt:0,wheelState:0,soundState:0,lineTracerState:0,batteryState:2};this.motoring={module:"turtle",index:a,map:4160749568,leftWheel:0,rightWheel:0,ledRed:0,ledGreen:0,ledBlue:0,buzzer:0,pulse:0,note:0,sound:0,lineTracerMode:0,lineTracerGain:5,lineTracerSpeed:5,lamp:1,lock:0,
motionType:0,motionUnit:0,motionSpeed:0,motionValue:0,motionRadius:0};this.blockId=0;this.lineTracerCallback=this.motionCallback=void 0;this.currentSound=0;this.soundRepeat=1;this.soundCallback=void 0;this.noteId=0;this.noteTimer2=this.noteTimer1=void 0;this.longPressed=this.doubleClicked=this.clicked=!1;this.colorPattern=-1;this.tempo=60;this.timeouts=[]}
Turtle.prototype.reset=function(){var a=this.motoring;a.map=4293132288;a.leftWheel=0;a.rightWheel=0;a.ledRed=0;a.ledGreen=0;a.ledBlue=0;a.buzzer=0;a.pulse=0;a.note=0;a.sound=0;a.lineTracerMode=0;a.lineTracerGain=5;a.lineTracerSpeed=5;a.lamp=1;a.lock=0;a.motionType=0;a.motionUnit=0;a.motionSpeed=0;a.motionValue=0;this.blockId=a.motionRadius=0;this.lineTracerCallback=this.motionCallback=void 0;this.currentSound=0;this.soundRepeat=1;this.soundCallback=void 0;this.noteId=0;this.noteTimer2=this.noteTimer1=
void 0;this.longPressed=this.doubleClicked=this.clicked=!1;this.colorPattern=-1;this.tempo=60;this.__removeAllTimeouts()};Turtle.prototype.__removeTimeout=function(a){clearTimeout(a);a=this.timeouts.indexOf(a);0<=a&&this.timeouts.splice(a,1)};Turtle.prototype.__removeAllTimeouts=function(){var a=this.timeouts,b;for(b in a)clearTimeout(a[b]);this.timeouts=[]};Turtle.prototype.clearMotoring=function(){this.motoring.map=4160749568};
Turtle.prototype.clearEvent=function(){this.longPressed=this.doubleClicked=this.clicked=!1;this.colorPattern=-1};Turtle.prototype.__setPulse=function(a){this.motoring.pulse=a;this.motoring.map|=67108864};Turtle.prototype.__setLineTracerMode=function(a){this.motoring.lineTracerMode=a;this.motoring.map|=8388608};Turtle.prototype.__setLineTracerGain=function(a){this.motoring.lineTracerGain=a;this.motoring.map|=4194304};
Turtle.prototype.__setLineTracerSpeed=function(a){this.motoring.lineTracerSpeed=a;this.motoring.map|=2097152};Turtle.prototype.__cancelLineTracer=function(){this.lineTracerCallback=void 0};Turtle.prototype.__setMotion=function(a,b,c,d,e){var f=this.motoring;f.motionType=a;f.motionUnit=b;f.motionSpeed=c;f.motionValue=d;f.motionRadius=e;f.map|=262144};Turtle.prototype.__cancelMotion=function(){this.motionCallback=void 0};
Turtle.prototype.__setNote=function(a){this.motoring.note=a;this.motoring.map|=33554432};Turtle.prototype.__issueNoteId=function(){return this.noteId=this.blockId=this.blockId%65535+1};Turtle.prototype.__cancelNote=function(){this.noteId=0;void 0!==this.noteTimer1&&this.__removeTimeout(this.noteTimer1);void 0!==this.noteTimer2&&this.__removeTimeout(this.noteTimer2);this.noteTimer2=this.noteTimer1=void 0};Turtle.prototype.__setSound=function(a){this.motoring.sound=a;this.motoring.map|=16777216};
Turtle.prototype.__runSound=function(a,b){"number"!=typeof b&&(b=1);0>b&&(b=-1);b&&(this.currentSound=a,this.soundRepeat=b,this.__setSound(a))};Turtle.prototype.__cancelSound=function(){this.soundCallback=void 0};
Turtle.prototype.handleSensory=function(){var a=this.sensory;a.map&2048&&(this.clicked=!0);a.map&1024&&(this.doubleClicked=!0);a.map&512&&(this.longPressed=!0);a.map&128&&(this.colorPattern=a.colorPattern);if(this.lineTracerCallback&&0!=(a.map&8)&&2==a.lineTracerState){this.__setLineTracerMode(0);var b=this.lineTracerCallback;this.__cancelLineTracer();b&&b()}this.motionCallback&&0!=(a.map&32)&&0==a.wheelState&&(this.motoring.leftWheel=0,this.motoring.rightWheel=0,b=this.motionCallback,this.__cancelMotion(),
b&&b());0!=(a.map&16)&&0==a.soundState&&(0<this.currentSound?0>this.soundRepeat?this.__runSound(this.currentSound,-1):1<this.soundRepeat?(this.soundRepeat--,this.__runSound(this.currentSound,this.soundRepeat)):(this.currentSound=0,this.soundRepeat=1,a=this.soundCallback,this.__cancelSound(),a&&a()):(this.currentSound=0,this.soundRepeat=1,a=this.soundCallback,this.__cancelSound(),a&&a()))};Turtle.prototype.__UNITS={cm:1,degrees:1,seconds:2,pulses:3};
Turtle.prototype.__motion=function(a,b){var c=this.motoring;this.__cancelLineTracer();c.leftWheel=0;c.rightWheel=0;this.__setPulse(0);this.__setMotion(a,1,0,0,0);this.motionCallback=b;this.__setLineTracerMode(0)};
Turtle.prototype.__motionUnit=function(a,b,c,d){var e=this.motoring;this.__cancelLineTracer();this.__cancelMotion();e.leftWheel=0;e.rightWheel=0;this.__setPulse(0);(c=parseFloat(c))&&0<c?(this.__setMotion(a,b,0,c,0),this.motionCallback=d,this.__setLineTracerMode(0)):(this.__setMotion(0,0,0,0,0),this.__setLineTracerMode(0),d())};
Turtle.prototype.__motionUnitRadius=function(a,b,c,d,e){var f=this.motoring;this.__cancelLineTracer();this.__cancelMotion();f.leftWheel=0;f.rightWheel=0;this.__setPulse(0);c=parseFloat(c);d=parseFloat(d);c&&0<c&&"number"==typeof d&&0<=d?(this.__setMotion(a,b,0,c,d),this.motionCallback=e,this.__setLineTracerMode(0)):(this.__setMotion(0,0,0,0,0),this.__setLineTracerMode(0),e())};Turtle.prototype.moveForward=function(a){this.__motion(101,a)};
Turtle.prototype.moveBackward=function(a){this.__motion(102,a)};Turtle.prototype.turn=function(a,b){"left"==a?this.__motion(103,b):this.__motion(104,b)};Turtle.prototype.moveForwardUnit=function(a,b,c){0>a?this.__motionUnit(2,this.__UNITS[b],-a,c):this.__motionUnit(1,this.__UNITS[b],a,c)};Turtle.prototype.moveBackwardUnit=function(a,b,c){0>a?this.__motionUnit(1,this.__UNITS[b],-a,c):this.__motionUnit(2,this.__UNITS[b],a,c)};
Turtle.prototype.turnUnit=function(a,b,c,d){"left"==a?0>b?this.__motionUnit(4,this.__UNITS[c],-b,d):this.__motionUnit(3,this.__UNITS[c],b,d):0>b?this.__motionUnit(3,this.__UNITS[c],-b,d):this.__motionUnit(4,this.__UNITS[c],b,d)};
Turtle.prototype.pivotUnit=function(a,b,c,d,e){c=this.__UNITS[c];"left"==a?"head"==d?0>b?this.__motionUnit(6,c,-b,e):this.__motionUnit(5,c,b,e):0>b?this.__motionUnit(5,c,-b,e):this.__motionUnit(6,c,b,e):"head"==d?0>b?this.__motionUnit(8,c,-b,e):this.__motionUnit(7,c,b,e):0>b?this.__motionUnit(7,c,-b,e):this.__motionUnit(8,c,b,e)};
Turtle.prototype.swingUnit=function(a,b,c,d,e,f){c=this.__UNITS[c];"left"==a?"head"==e?0>b?this.__motionUnitRadius(10,c,-b,d,f):this.__motionUnitRadius(9,c,b,d,f):0>b?this.__motionUnitRadius(9,c,-b,d,f):this.__motionUnitRadius(10,c,b,d,f):"head"==e?0>b?this.__motionUnitRadius(12,c,-b,d,f):this.__motionUnitRadius(11,c,b,d,f):0>b?this.__motionUnitRadius(11,c,-b,d,f):this.__motionUnitRadius(12,c,b,d,f)};
Turtle.prototype.setWheels=function(a,b){var c=this.motoring;this.__cancelLineTracer();this.__cancelMotion();a=parseFloat(a);b=parseFloat(b);"number"==typeof a&&(c.leftWheel=a);"number"==typeof b&&(c.rightWheel=b);this.__setPulse(0);this.__setMotion(0,0,0,0,0);this.__setLineTracerMode(0)};
Turtle.prototype.changeWheels=function(a,b){var c=this.motoring;this.__cancelLineTracer();this.__cancelMotion();a=parseFloat(a);b=parseFloat(b);"number"==typeof a&&(c.leftWheel+=a);"number"==typeof b&&(c.rightWheel+=b);this.__setPulse(0);this.__setMotion(0,0,0,0,0);this.__setLineTracerMode(0)};
Turtle.prototype.setWheel=function(a,b){var c=this.motoring;this.__cancelLineTracer();this.__cancelMotion();b=parseFloat(b);"number"==typeof b&&("left"==a?c.leftWheel=b:("right"!=a&&(c.leftWheel=b),c.rightWheel=b));this.__setPulse(0);this.__setMotion(0,0,0,0,0);this.__setLineTracerMode(0)};
Turtle.prototype.changeWheel=function(a,b){var c=this.motoring;this.__cancelLineTracer();this.__cancelMotion();b=parseFloat(b);"number"==typeof b&&("left"==a?c.leftWheel+=b:("right"!=a&&(c.leftWheel+=b),c.rightWheel+=b));this.__setPulse(0);this.__setMotion(0,0,0,0,0);this.__setLineTracerMode(0)};Turtle.prototype.__LINE_COLORS={black:0,red:1,yellow:2,green:3,"sky blue":4,blue:5,purple:6,"any color":7};
Turtle.prototype.followLine=function(a){var b=this.motoring;this.__cancelLineTracer();this.__cancelMotion();a=10+this.__LINE_COLORS[a];b.leftWheel=0;b.rightWheel=0;this.__setPulse(0);this.__setMotion(0,0,0,0,0);this.__setLineTracerMode(a)};Turtle.prototype.followLineUntil=function(a,b){var c=this.motoring;this.__cancelMotion();var d=60+this.__LINE_COLORS[a];c.leftWheel=0;c.rightWheel=0;this.__setPulse(0);this.__setMotion(0,0,0,0,0);this.__setLineTracerMode(d);this.lineTracerCallback=b};
Turtle.prototype.followLineUntilBlack=function(a,b){var c=this.motoring;this.__cancelMotion();var d=70+this.__LINE_COLORS[a];c.leftWheel=0;c.rightWheel=0;this.__setPulse(0);this.__setMotion(0,0,0,0,0);this.__setLineTracerMode(d);this.lineTracerCallback=b};Turtle.prototype.crossIntersection=function(a){var b=this.motoring;this.__cancelMotion();b.leftWheel=0;b.rightWheel=0;this.__setPulse(0);this.__setMotion(0,0,0,0,0);this.__setLineTracerMode(40);this.lineTracerCallback=a};
Turtle.prototype.turnAtIntersection=function(a,b){var c=this.motoring;this.__cancelMotion();var d=20;"right"==a?d=30:"back"==a&&(d=50);c.leftWheel=0;c.rightWheel=0;this.__setPulse(0);this.__setMotion(0,0,0,0,0);this.__setLineTracerMode(d);this.lineTracerCallback=b};Turtle.prototype.setLineTracerSpeed=function(a){a=parseInt(a);"number"==typeof a&&(this.__setLineTracerSpeed(a),this.__setLineTracerGain(a))};
Turtle.prototype.stop=function(){var a=this.motoring;this.__cancelLineTracer();this.__cancelMotion();a.leftWheel=0;a.rightWheel=0;this.__setPulse(0);this.__setMotion(0,0,0,0,0);this.__setLineTracerMode(0)};Turtle.prototype.__RGBS={red:[255,0,0],orange:[255,63,0],yellow:[255,255,0],green:[0,255,0],"sky blue":[0,255,255],blue:[0,0,255],violet:[63,0,255],purple:[255,0,255],white:[255,255,255]};Turtle.prototype.setHeadColor=function(a){(a=this.__RGBS[a])&&this.setHeadRgb(a[0],a[1],a[2])};
Turtle.prototype.setHeadRgbArray=function(a){a&&this.setHeadRgb(a[0],a[1],a[2])};Turtle.prototype.setHeadRgb=function(a,b,c){var d=this.motoring;a=parseInt(a);b=parseInt(b);c=parseInt(c);"number"==typeof a&&(d.ledRed=a);"number"==typeof b&&(d.ledGreen=b);"number"==typeof c&&(d.ledBlue=c)};
Turtle.prototype.changeHeadRgb=function(a,b,c){var d=this.motoring;a=parseInt(a);b=parseInt(b);c=parseInt(c);"number"==typeof a&&(d.ledRed+=a);"number"==typeof b&&(d.ledGreen+=b);"number"==typeof c&&(d.ledBlue+=c)};Turtle.prototype.clearHead=function(){this.setHeadRgb(0,0,0)};Turtle.prototype.__SOUNDS={beep:1,"random beep":2,siren:3,engine:4,robot:5,march:6,birthday:7,dibidibidip:8,"good job":9};
Turtle.prototype.playSound=function(a,b){var c=this.motoring;this.__cancelNote();this.__cancelSound();a=this.__SOUNDS[a];b=parseInt(b);c.buzzer=0;this.__setNote(0);a&&b?this.__runSound(a,b):this.__runSound(0)};Turtle.prototype.playSoundUntil=function(a,b,c){var d=this.motoring;this.__cancelNote();this.__cancelSound();a=this.__SOUNDS[a];b=parseInt(b);d.buzzer=0;this.__setNote(0);a&&b?(this.__runSound(a,b),this.soundCallback=c):(this.__runSound(0),c())};
Turtle.prototype.setBuzzer=function(a){var b=this.motoring;this.__cancelNote();this.__cancelSound();a=parseFloat(a);"number"==typeof a&&(b.buzzer=a);this.__setNote(0);this.__runSound(0)};Turtle.prototype.changeBuzzer=function(a){var b=this.motoring;this.__cancelNote();this.__cancelSound();a=parseFloat(a);"number"==typeof a&&(b.buzzer+=a);this.__setNote(0);this.__runSound(0)};Turtle.prototype.clearSound=function(){this.__cancelNote();this.__cancelSound();this.motoring.buzzer=0;this.__setNote(0);this.__runSound(0)};
Turtle.prototype.__NOTES={C:4,"C\u266f (D\u266d)":5,D:6,"D\u266f (E\u266d)":7,E:8,F:9,"F\u266f (G\u266d)":10,G:11,"G\u266f (A\u266d)":12,A:13,"A\u266f (B\u266d)":14,B:15};Turtle.prototype.playNote=function(a,b){var c=this.motoring;this.__cancelNote();this.__cancelSound();a=this.__NOTES[a];b=parseInt(b);c.buzzer=0;a&&b&&0<b&&8>b?this.__setNote(a+12*(b-1)):this.__setNote(0);this.__runSound(0)};
Turtle.prototype.playNoteBeat=function(a,b,c,d){var e=this,f=e.motoring;e.__cancelNote();e.__cancelSound();a=this.__NOTES[a];b=parseInt(b);c=parseFloat(c);f.buzzer=0;if(a&&b&&0<b&&8>b&&c&&0<c&&0<e.tempo){var g=e.__issueNoteId();e.__setNote(a+12*(b-1));a=6E4*c/e.tempo;b=100<a?100:0;0<b&&(e.noteTimer1=setTimeout(function(){e.noteId==g&&(e.__setNote(0),void 0!==e.noteTimer1&&e.__removeTimeout(e.noteTimer1),e.noteTimer1=void 0)},a-b),e.timeouts.push(e.noteTimer1));e.noteTimer2=setTimeout(function(){e.noteId==
g&&(e.__setNote(0),e.__cancelNote(),d())},a);e.timeouts.push(e.noteTimer2);e.__runSound(0)}else e.__setNote(0),e.__runSound(0),d()};Turtle.prototype.restBeat=function(a,b){var c=this,d=c.motoring;c.__cancelNote();c.__cancelSound();a=parseFloat(a);d.buzzer=0;c.__setNote(0);c.__runSound(0);if(a&&0<a&&0<c.tempo){var e=c.__issueNoteId();c.noteTimer1=setTimeout(function(){c.noteId==e&&(c.__cancelNote(),b())},6E4*a/c.tempo);c.timeouts.push(c.noteTimer1)}else b()};
Turtle.prototype.setTempo=function(a){a=parseFloat(a);"number"==typeof a&&(this.tempo=a,1>this.tempo&&(this.tempo=1))};Turtle.prototype.changeTempo=function(a){a=parseFloat(a);"number"==typeof a&&(this.tempo+=a,1>this.tempo&&(this.tempo=1))};Turtle.prototype.__TOUCHING_COLORS={red:1,orange:2,yellow:3,green:4,"sky blue":5,blue:6,purple:7,black:0,white:8};Turtle.prototype.checkTouchingColor=function(a){a=this.__TOUCHING_COLORS[a];return"number"==typeof a?this.sensory.colorNumber==a:!1};
Turtle.prototype.__PATTERN_COLORS={red:1,yellow:3,green:4,"sky blue":5,blue:6,purple:7};Turtle.prototype.checkColorPattern=function(a,b){a=this.__PATTERN_COLORS[a];b=this.__PATTERN_COLORS[b];return"number"==typeof a&&"number"==typeof b?this.colorPattern==10*a+b:!1};Turtle.prototype.checkButtonEvent=function(a){return"clicked"==a?this.clicked:"double-clicked"==a?this.doubleClicked:"long-pressed"==a?this.longPressed:!1};
Turtle.prototype.checkTilt=function(a){var b=this.sensory;switch(a){case "tilt forward":return 1==b.tilt;case "tilt backward":return-1==b.tilt;case "tilt left":return 2==b.tilt;case "tilt right":return-2==b.tilt;case "tilt flip":return 3==b.tilt;case "not tilt":return-3==b.tilt}return!1};Turtle.prototype.__BATTERY_STATES={normal:2,low:1,empty:0};Turtle.prototype.checkBattery=function(a){return this.sensory.batteryState==this.__BATTERY_STATES[a]};Turtle.prototype.getColorNumber=function(){return this.sensory.colorNumber};
Turtle.prototype.getColorPattern=function(){return this.colorPattern};Turtle.prototype.getFloor=function(){return this.sensory.floor};Turtle.prototype.getButton=function(){return this.sensory.button};Turtle.prototype.getAccelerationX=function(){return this.sensory.accelerationX};Turtle.prototype.getAccelerationY=function(){return this.sensory.accelerationY};Turtle.prototype.getAccelerationZ=function(){return this.sensory.accelerationZ};
function AlbertSchoolController(){this.positionCountFinal=this.positionCount=this.directionCountFinal=this.directionCount=this.prevDirectionFinal=this.prevDirection=0;this.isBackward=!1}AlbertSchoolController.prototype.PI=3.14159265;AlbertSchoolController.prototype.PI2=6.2831853;AlbertSchoolController.prototype.GAIN_ANGLE=30;AlbertSchoolController.prototype.GAIN_ANGLE_FINE=30;AlbertSchoolController.prototype.GAIN_POSITION_FINE=30;AlbertSchoolController.prototype.STRAIGHT_SPEED=30;
AlbertSchoolController.prototype.MAX_BASE_SPEED=30;AlbertSchoolController.prototype.GAIN_BASE_SPEED=1.5;AlbertSchoolController.prototype.GAIN_POSITION=52.5;AlbertSchoolController.prototype.POSITION_TOLERANCE_FINE=3;AlbertSchoolController.prototype.POSITION_TOLERANCE_FINE_LARGE=5;AlbertSchoolController.prototype.POSITION_TOLERANCE_ROUGH=5;AlbertSchoolController.prototype.POSITION_TOLERANCE_ROUGH_LARGE=10;AlbertSchoolController.prototype.ORIENTATION_TOLERANCE_FINAL=.087;
AlbertSchoolController.prototype.ORIENTATION_TOLERANCE_FINAL_LARGE=.122;AlbertSchoolController.prototype.ORIENTATION_TOLERANCE_FINAL_LARGE_LARGE=.262;AlbertSchoolController.prototype.ORIENTATION_TOLERANCE_ROUGH=.122;AlbertSchoolController.prototype.ORIENTATION_TOLERANCE_ROUGH_LARGE=.262;AlbertSchoolController.prototype.ORIENTATION_TOLERANCE_ROUGH_LARGE_LARGE=.524;AlbertSchoolController.prototype.MINIMUM_WHEEL_SPEED=18;AlbertSchoolController.prototype.MINIMUM_WHEEL_SPEED_FINE=15;
AlbertSchoolController.prototype.clear=function(){this.positionCountFinal=this.positionCount=this.directionCountFinal=this.directionCount=this.prevDirectionFinal=this.prevDirection=0};AlbertSchoolController.prototype.setBackward=function(a){this.isBackward=a};
AlbertSchoolController.prototype.controlAngleInitial=function(a,b,c){this.isBackward&&(b+=this.PI);b=this.validateRadian(c-b);c=Math.abs(b);if(c<this.ORIENTATION_TOLERANCE_ROUGH)return!0;var d=0<b?1:-1;if(c<this.ORIENTATION_TOLERANCE_ROUGH_LARGE&&0>d*this.prevDirection)return!0;this.prevDirection=d;0<b?(b=Math.log(1+c)*this.GAIN_ANGLE,b<this.MINIMUM_WHEEL_SPEED&&(b=this.MINIMUM_WHEEL_SPEED)):(b=-Math.log(1+c)*this.GAIN_ANGLE,b>-this.MINIMUM_WHEEL_SPEED&&(b=-this.MINIMUM_WHEEL_SPEED));b=parseInt(b);
a.left=-b;a.right=b;return!1};
AlbertSchoolController.prototype.controlAngleFinal=function(a,b,c){b=this.validateRadian(c-b);c=Math.abs(b);if(c<this.ORIENTATION_TOLERANCE_FINAL)return!0;var d=0<b?1:-1;if(c<this.ORIENTATION_TOLERANCE_FINAL_LARGE&&0>d*this.prevDirectionFinal||c<this.ORIENTATION_TOLERANCE_FINAL_LARGE_LARGE&&0>d*this.prevDirectionFinal&&3<++this.directionCountFinal)return!0;this.prevDirectionFinal=d;0<b?(b=Math.log(1+c)*this.GAIN_ANGLE_FINE,b<this.MINIMUM_WHEEL_SPEED&&(b=this.MINIMUM_WHEEL_SPEED)):(b=-Math.log(1+c)*
this.GAIN_ANGLE_FINE,b>-this.MINIMUM_WHEEL_SPEED&&(b=-this.MINIMUM_WHEEL_SPEED));b=parseInt(b);a.left=-b;a.right=b;return!1};
AlbertSchoolController.prototype.controlPositionFine=function(a,b,c,d,e,g){var f=Math.atan2(g-c,e-b);this.isBackward&&(d+=this.PI);d=this.validateRadian(f-d);f=Math.abs(d);b=e-b;c=g-c;c=Math.sqrt(b*b+c*c);if(c<this.POSITION_TOLERANCE_FINE)return!0;if(c<this.POSITION_TOLERANCE_FINE_LARGE&&5<++this.positionCountFinal)return this.positionCountFinal=0,!0;c=0<d?Math.log(1+f)*this.GAIN_POSITION_FINE:-Math.log(1+f)*this.GAIN_POSITION_FINE;this.isBackward&&(c=-c);c=parseInt(c);a.left=this.MINIMUM_WHEEL_SPEED_FINE-
c;a.right=this.MINIMUM_WHEEL_SPEED_FINE+c;this.isBackward&&(a.left=-a.left,a.right=-a.right);return!1};
AlbertSchoolController.prototype.controlPosition=function(a,b,c,d,e,g){var f=Math.atan2(g-c,e-b);this.isBackward&&(d+=this.PI);d=this.validateRadian(f-d);f=Math.abs(d);b=e-b;c=g-c;c=Math.sqrt(b*b+c*c);if(c<this.POSITION_TOLERANCE_ROUGH)return!0;if(c<this.POSITION_TOLERANCE_ROUGH_LARGE){if(10<++this.positionCount)return this.positionCount=0,!0}else this.positionCount=0;.01>f?(a.left=this.STRAIGHT_SPEED,a.right=this.STRAIGHT_SPEED):(c=(this.MINIMUM_WHEEL_SPEED+.5/f)*this.GAIN_BASE_SPEED,c>this.MAX_BASE_SPEED&&
(c=this.MAX_BASE_SPEED),d=0<d?Math.log(1+f)*this.GAIN_POSITION:-Math.log(1+f)*this.GAIN_POSITION,this.isBackward&&(d=-d),c=parseInt(c),d=parseInt(d),a.left=c-d,a.right=c+d);this.isBackward&&(a.left=-a.left,a.right=-a.right);return!1};AlbertSchoolController.prototype.validateRadian=function(a){return a>this.PI?a-this.PI2:a<-this.PI?a+this.PI2:a};AlbertSchoolController.prototype.toRadian=function(a){return 3.14159265*a/180};
function AlbertSchoolNavigator(){this.controller=new AlbertSchoolController;this.state=this.mode=0;this.initialized=!1;this.boardHeight=this.boardWidth=0;this.currentY=this.currentX=-1;this.currentTheta=-200;this.targetY=this.targetX=-1;this.targetTheta=-200;this.wheels={completed:!1,left:0,right:0}}
AlbertSchoolNavigator.prototype.clear=function(){this.state=this.mode=0;this.initialized=!1;this.currentY=this.currentX=-1;this.currentTheta=-200;this.targetY=this.targetX=-1;this.targetTheta=-200;this.wheels.completed=!1;this.wheels.left=0;this.wheels.right=0;this.controller.clear()};AlbertSchoolNavigator.prototype.getBoardWidth=function(){return this.boardWidth};AlbertSchoolNavigator.prototype.getBoardHeight=function(){return this.boardHeight};
AlbertSchoolNavigator.prototype.setBoardSize=function(a,b){this.boardWidth=a;this.boardHeight=b};AlbertSchoolNavigator.prototype.setBackward=function(a){this.controller.setBackward(a)};AlbertSchoolNavigator.prototype.moveTo=function(a,b){this.clear();this.targetX=a;this.targetY=b;this.mode=this.state=1};AlbertSchoolNavigator.prototype.turnTo=function(a){this.clear();this.targetTheta=a;this.state=1;this.mode=2};
AlbertSchoolNavigator.prototype.handleSensory=function(a){if(1==this.mode){var b=a.positionX,c=a.positionY;0<=b&&(this.currentX=b);0<=c&&(this.currentY=c);this.currentTheta=a.orientation;switch(this.state){case 1:0==this.initialized&&(0>this.currentX||0>this.currentY?(this.wheels.left=20,this.wheels.right=-20):this.initialized=!0);this.initialized&&(a=this.controller.toRadian(this.currentTheta),b=Math.atan2(this.targetY-this.currentY,this.targetX-this.currentX),this.controller.controlAngleInitial(this.wheels,
a,b)&&(this.state=2));break;case 2:a=this.controller.toRadian(this.currentTheta);this.controller.controlPosition(this.wheels,this.currentX,this.currentY,a,this.targetX,this.targetY)&&(this.state=3);break;case 3:a=this.controller.toRadian(this.currentTheta),this.controller.controlPositionFine(this.wheels,this.currentX,this.currentY,a,this.targetX,this.targetY)&&(this.clear(),this.wheels.completed=!0)}}else if(2==this.mode)switch(this.currentTheta=a.orientation,this.state){case 1:a=this.controller.toRadian(this.currentTheta);
b=this.controller.toRadian(this.targetTheta);this.controller.controlAngleInitial(this.wheels,a,b)&&(this.state=2);break;case 2:a=this.controller.toRadian(this.currentTheta),b=this.controller.toRadian(this.targetTheta),this.controller.controlAngleFinal(this.wheels,a,b)&&(this.clear(),this.wheels.completed=!0)}return this.wheels};
function AlbertSchool(a){this.sensory={map:0,signalStrength:0,leftProximity:0,rightProximity:0,accelerationX:0,accelerationY:0,accelerationZ:0,positionX:-1,positionY:-1,orientation:-200,light:0,temperature:0,frontOid:-1,rearOid:-1,batteryState:2,tilt:0,handFound:!1};this.motoring={module:"albertschool",index:a,map:3187671040,leftWheel:0,rightWheel:0,buzzer:0,leftEye:0,rightEye:0,note:0,bodyLed:0,frontLed:0,boardWidth:0,boardHeight:0,motion:0};this.wheelId=this.blockId=0;this.navigator=this.navigationCallback=
this.wheelTimer=void 0;this.noteId=0;this.noteTimer2=this.noteTimer1=void 0;this.tempo=60;this.timeouts=[]}AlbertSchool.prototype.reset=function(){var a=this.motoring;a.map=2398879744;a.leftWheel=0;a.rightWheel=0;a.buzzer=0;a.leftEye=0;a.rightEye=0;a.note=0;a.bodyLed=0;a.frontLed=0;a.boardWidth=0;a.boardHeight=0;this.wheelId=this.blockId=a.motion=0;this.navigator=this.navigationCallback=this.wheelTimer=void 0;this.noteId=0;this.noteTimer2=this.noteTimer1=void 0;this.tempo=60;this.__removeAllTimeouts()};
AlbertSchool.prototype.__removeTimeout=function(a){clearTimeout(a);a=this.timeouts.indexOf(a);0<=a&&this.timeouts.splice(a,1)};AlbertSchool.prototype.__removeAllTimeouts=function(){var a=this.timeouts,b;for(b in a)clearTimeout(a[b]);this.timeouts=[]};AlbertSchool.prototype.clearMotoring=function(){this.motoring.map=3187671040};AlbertSchool.prototype.clearEvent=function(){};AlbertSchool.prototype.__issueWheelId=function(){return this.wheelId=this.blockId=this.blockId%65535+1};
AlbertSchool.prototype.__cancelWheel=function(){this.wheelId=0;void 0!==this.wheelTimer&&this.__removeTimeout(this.wheelTimer);this.wheelTimer=void 0};AlbertSchool.prototype.__getNavigator=function(){void 0==this.navigator&&(this.navigator=new AlbertSchoolNavigator);return this.navigator};AlbertSchool.prototype.__cancelNavigation=function(){this.navigationCallback=void 0;this.navigator&&this.navigator.clear()};
AlbertSchool.prototype.__setLeftEye=function(a){this.motoring.leftEye=a;this.motoring.map|=8388608};AlbertSchool.prototype.__setRightEye=function(a){this.motoring.rightEye=a;this.motoring.map|=4194304};AlbertSchool.prototype.__setNote=function(a){this.motoring.note=a;this.motoring.map|=2097152};AlbertSchool.prototype.__issueNoteId=function(){return this.noteId=this.blockId=this.blockId%65535+1};
AlbertSchool.prototype.__cancelNote=function(){this.noteId=0;void 0!==this.noteTimer1&&this.__removeTimeout(this.noteTimer1);void 0!==this.noteTimer2&&this.__removeTimeout(this.noteTimer2);this.noteTimer2=this.noteTimer1=void 0};AlbertSchool.prototype.__setBodyLed=function(a){this.motoring.bodyLed=a;this.motoring.map|=1048576};AlbertSchool.prototype.__setFrontLed=function(a){this.motoring.frontLed=a;this.motoring.map|=524288};
AlbertSchool.prototype.__setBoardSize=function(a,b){this.motoring.boardWidth=a;this.motoring.boardHeight=b;this.motoring.map|=262144};AlbertSchool.prototype.handleSensory=function(){if(this.navigationCallback&&this.navigator){var a=this.navigator.handleSensory(this.sensory);this.motoring.leftWheel=a.left;this.motoring.rightWheel=a.right;a.completed&&(a=this.navigationCallback,this.__cancelNavigation(),a&&a())}};
AlbertSchool.prototype.__motion=function(a,b,c,d,e){var g=this,f=g.motoring;g.__cancelNavigation();g.__cancelWheel();if((d=parseFloat(d))&&0<d){var h=g.__issueWheelId();f.leftWheel=b;f.rightWheel=c;f.motion=a;g.wheelTimer=setTimeout(function(){g.wheelId==h&&(f.leftWheel=0,f.rightWheel=0,f.motion=0,g.__cancelWheel(),e())},1E3*d);g.timeouts.push(g.wheelTimer)}else f.leftWheel=0,f.rightWheel=0,f.motion=0,e()};AlbertSchool.prototype.moveForward=function(a){this.__motion(1,30,30,1,a)};
AlbertSchool.prototype.moveBackward=function(a){this.__motion(2,-30,-30,1,a)};AlbertSchool.prototype.turn=function(a,b){"left"==a?this.__motion(3,-30,30,1,b):this.__motion(4,30,-30,1,b)};AlbertSchool.prototype.moveForwardSecs=function(a,b){0>a?this.__motion(2,-30,-30,-a,b):this.__motion(1,30,30,a,b)};AlbertSchool.prototype.moveBackwardSecs=function(a,b){0>a?this.__motion(1,30,30,-a,b):this.__motion(2,-30,-30,a,b)};
AlbertSchool.prototype.turnSecs=function(a,b,c){"left"==a?0>b?this.__motion(4,30,-30,-b,c):this.__motion(3,-30,30,b,c):0>b?this.__motion(3,-30,30,-b,c):this.__motion(4,30,-30,b,c)};AlbertSchool.prototype.setWheels=function(a,b){var c=this.motoring;this.__cancelNavigation();this.__cancelWheel();a=parseFloat(a);b=parseFloat(b);"number"==typeof a&&(c.leftWheel=a);"number"==typeof b&&(c.rightWheel=b);c.motion=0};
AlbertSchool.prototype.changeWheels=function(a,b){var c=this.motoring;this.__cancelNavigation();this.__cancelWheel();a=parseFloat(a);b=parseFloat(b);"number"==typeof a&&(c.leftWheel+=a);"number"==typeof b&&(c.rightWheel+=b);c.motion=0};AlbertSchool.prototype.setWheel=function(a,b){var c=this.motoring;this.__cancelNavigation();this.__cancelWheel();b=parseFloat(b);"number"==typeof b&&("left"==a?c.leftWheel=b:("right"!=a&&(c.leftWheel=b),c.rightWheel=b));c.motion=0};
AlbertSchool.prototype.changeWheel=function(a,b){var c=this.motoring;this.__cancelNavigation();this.__cancelWheel();b=parseFloat(b);"number"==typeof b&&("left"==a?c.leftWheel+=b:("right"!=a&&(c.leftWheel+=b),c.rightWheel+=b));c.motion=0};AlbertSchool.prototype.stop=function(){var a=this.motoring;this.__cancelNavigation();this.__cancelWheel();a.leftWheel=0;a.rightWheel=0;a.motion=0};
AlbertSchool.prototype.setBoardSize=function(a,b){a=parseInt(a);b=parseInt(b);a&&b&&0<a&&0<b&&(this.__getNavigator().setBoardSize(a,b),this.__setBoardSize(a,b))};
AlbertSchool.prototype.moveToOnBoard=function(a,b,c,d){var e=this.motoring;this.__cancelNavigation();this.__cancelWheel();b=parseInt(b);c=parseInt(c);var g=this.__getNavigator();"number"==typeof b&&"number"==typeof c&&0<=b&&b<g.getBoardWidth()&&0<=c&&c<g.getBoardHeight()&&(e.motion=0,g.setBackward("backward"==a),g.moveTo(b,c),this.navigationCallback=d)};
AlbertSchool.prototype.setOrientationToOnBoard=function(a,b){var c=this.motoring;this.__cancelNavigation();this.__cancelWheel();a=parseInt(a);if("number"==typeof a){var d=this.__getNavigator();c.motion=0;d.setBackward(!1);d.turnTo(a);this.navigationCallback=b}};AlbertSchool.prototype.__COLORS={red:4,yellow:6,green:2,"sky blue":3,blue:1,purple:5,white:7};AlbertSchool.prototype.setEye=function(a,b){(b=this.__COLORS[b])&&0<b&&("left"==a?this.__setLeftEye(b):("right"!=a&&this.__setLeftEye(b),this.__setRightEye(b)))};
AlbertSchool.prototype.clearEye=function(a){"left"==a?this.__setLeftEye(0):("right"!=a&&this.__setLeftEye(0),this.__setRightEye(0))};AlbertSchool.prototype.turnBodyLed=function(a){this.__setBodyLed("on"==a?1:0)};AlbertSchool.prototype.turnFrontLed=function(a){this.__setFrontLed("on"==a?1:0)};
AlbertSchool.prototype.runBeep=function(a,b,c){if(a){var d=this,e=d.motoring;e.buzzer=440;d.__setNote(0);d.noteTimer1=setTimeout(function(){b&&d.noteId!=b||(e.buzzer=0,void 0!==d.noteTimer1&&d.__removeTimeout(d.noteTimer1),d.noteTimer1=void 0)},100);d.timeouts.push(d.noteTimer1);d.noteTimer2=setTimeout(function(){b&&d.noteId!=b||(e.buzzer=0,void 0!==d.noteTimer2&&d.__removeTimeout(d.noteTimer2),d.noteTimer2=void 0,0>a?d.runBeep(-1,b,c):1==a?(d.__cancelNote(),b&&c&&c()):d.runBeep(a-1,b,c))},200);d.timeouts.push(d.noteTimer2)}};
AlbertSchool.prototype.beep=function(a){this.__cancelNote();var b=this.__issueNoteId();this.runBeep(1,b,a)};AlbertSchool.prototype.setBuzzer=function(a){var b=this.motoring;this.__cancelNote();a=parseFloat(a);"number"==typeof a&&(b.buzzer=a);this.__setNote(0)};AlbertSchool.prototype.changeBuzzer=function(a){var b=this.motoring;this.__cancelNote();a=parseFloat(a);"number"==typeof a&&(b.buzzer+=a);this.__setNote(0)};
AlbertSchool.prototype.clearBuzzer=function(){this.__cancelNote();this.motoring.buzzer=0;this.__setNote(0)};AlbertSchool.prototype.__NOTES={C:4,"C\u266f (D\u266d)":5,D:6,"D\u266f (E\u266d)":7,E:8,F:9,"F\u266f (G\u266d)":10,G:11,"G\u266f (A\u266d)":12,A:13,"A\u266f (B\u266d)":14,B:15};AlbertSchool.prototype.playNote=function(a,b){var c=this.motoring;this.__cancelNote();a=this.__NOTES[a];b=parseInt(b);c.buzzer=0;a&&b&&0<b&&8>b?this.__setNote(a+12*(b-1)):this.__setNote(0)};
AlbertSchool.prototype.playNoteBeat=function(a,b,c,d){var e=this,g=e.motoring;e.__cancelNote();a=e.__NOTES[a];b=parseInt(b);c=parseFloat(c);g.buzzer=0;if(a&&b&&0<b&&8>b&&c&&0<c&&0<e.tempo){var f=e.__issueNoteId();e.__setNote(a+12*(b-1));a=6E4*c/e.tempo;b=100<a?100:0;0<b&&(e.noteTimer1=setTimeout(function(){e.noteId==f&&(e.__setNote(0),void 0!==e.noteTimer1&&e.__removeTimeout(e.noteTimer1),e.noteTimer1=void 0)},a-b),e.timeouts.push(e.noteTimer1));e.noteTimer2=setTimeout(function(){e.noteId==f&&(e.__setNote(0),
e.__cancelNote(),d())},a);e.timeouts.push(e.noteTimer2)}else e.__setNote(0),d()};AlbertSchool.prototype.restBeat=function(a,b){var c=this,d=c.motoring;c.__cancelNote();a=parseFloat(a);d.buzzer=0;c.__setNote(0);if(a&&0<a&&0<c.tempo){var e=c.__issueNoteId();c.noteTimer1=setTimeout(function(){c.noteId==e&&(c.__cancelNote(),b())},6E4*a/c.tempo);c.timeouts.push(c.noteTimer1)}else b()};
AlbertSchool.prototype.setTempo=function(a){a=parseFloat(a);"number"==typeof a&&(this.tempo=a,1>this.tempo&&(this.tempo=1))};AlbertSchool.prototype.changeTempo=function(a){a=parseFloat(a);"number"==typeof a&&(this.tempo+=a,1>this.tempo&&(this.tempo=1))};AlbertSchool.prototype.getLeftProximity=function(){return this.sensory.leftProximity};AlbertSchool.prototype.getRightProximity=function(){return this.sensory.rightProximity};AlbertSchool.prototype.getAccelerationX=function(){return this.sensory.accelerationX};
AlbertSchool.prototype.getAccelerationY=function(){return this.sensory.accelerationY};AlbertSchool.prototype.getAccelerationZ=function(){return this.sensory.accelerationZ};AlbertSchool.prototype.getFrontOid=function(){return this.sensory.frontOid};AlbertSchool.prototype.getRearOid=function(){return this.sensory.rearOid};AlbertSchool.prototype.getPositionX=function(){return this.sensory.positionX};AlbertSchool.prototype.getPositionY=function(){return this.sensory.positionY};
AlbertSchool.prototype.getOrientation=function(){return this.sensory.orientation};AlbertSchool.prototype.getLight=function(){return this.sensory.light};AlbertSchool.prototype.getTemperature=function(){return this.sensory.temperature};AlbertSchool.prototype.getSignalStrength=function(){return this.sensory.signalStrength};AlbertSchool.prototype.checkHandFound=function(){var a=this.sensory;return void 0===a.handFound?40<a.leftProximity||40<a.rightProximity:a.handFound};
AlbertSchool.prototype.checkOid=function(a,b){b=parseInt(b);if("number"==typeof b)switch(a){case "front":return this.sensory.frontOid==b;case "rear":return this.sensory.rearOid==b}return!1};
AlbertSchool.prototype.checkTilt=function(a){switch(a){case "tilt forward":return 1==this.sensory.tilt;case "tilt backward":return-1==this.sensory.tilt;case "tilt left":return 2==this.sensory.tilt;case "tilt right":return-2==this.sensory.tilt;case "tilt flip":return 3==this.sensory.tilt;case "not tilt":return-3==this.sensory.tilt}return!1};AlbertSchool.prototype.__BATTERY_STATES={normal:2,low:1,empty:0};AlbertSchool.prototype.checkBattery=function(a){return this.sensory.batteryState==this.__BATTERY_STATES[a]};
function UoAlbert(a){this.sensory={map:0,map2:0,signalStrength:0,leftProximity:0,rightProximity:0,accelerationX:0,accelerationY:0,accelerationZ:0,positionX:-1,positionY:-1,light:0,temperature:0,touch:0,oid:-1,pulseCount:0,wheelState:0,soundState:0,batteryState:2,tilt:0,handFound:!1};this.motoring={module:"uoalbert",index:a,map:3212836864,leftWheel:0,rightWheel:0,leftRed:0,leftGreen:0,leftBlue:0,rightRed:0,rightGreen:0,rightBlue:0,buzzer:0,pulse:0,note:0,sound:0,boardWidth:0,boardHeight:0,motionType:0,
motionUnit:0,motionSpeed:0,motionValue:0,motionRadius:0};this.blockId=0;this.motionCallback=void 0;this.currentSound=0;this.soundRepeat=1;this.soundCallback=void 0;this.noteId=0;this.noteTimer2=this.noteTimer1=void 0;this.longLongPressed=this.longPressed=this.clicked=!1;this.tempo=60;this.timeouts=[]}
UoAlbert.prototype.reset=function(){var a=this.motoring;a.map=3220701185;a.leftWheel=0;a.rightWheel=0;a.leftRed=0;a.leftGreen=0;a.leftBlue=0;a.rightRed=0;a.rightGreen=0;a.rightBlue=0;a.buzzer=0;a.pulse=0;a.note=0;a.sound=0;a.boardWidth=0;a.boardHeight=0;a.motionType=0;a.motionUnit=0;a.motionSpeed=0;a.motionValue=0;this.blockId=a.motionRadius=0;this.motionCallback=void 0;this.currentSound=0;this.soundRepeat=1;this.soundCallback=void 0;this.noteId=0;this.noteTimer2=this.noteTimer1=void 0;this.longLongPressed=
this.longPressed=this.clicked=!1;this.tempo=60;this.__removeAllTimeouts()};UoAlbert.prototype.__removeTimeout=function(a){clearTimeout(a);a=this.timeouts.indexOf(a);0<=a&&this.timeouts.splice(a,1)};UoAlbert.prototype.__removeAllTimeouts=function(){var a=this.timeouts,b;for(b in a)clearTimeout(a[b]);this.timeouts=[]};UoAlbert.prototype.clearMotoring=function(){this.motoring.map=3212836864};UoAlbert.prototype.clearEvent=function(){this.longLongPressed=this.longPressed=this.clicked=!1};
UoAlbert.prototype.__setPulse=function(a){this.motoring.pulse=a;this.motoring.map|=4194304};UoAlbert.prototype.__setNote=function(a){this.motoring.note=a;this.motoring.map|=2097152};UoAlbert.prototype.__issueNoteId=function(){return this.noteId=this.blockId=this.blockId%65535+1};UoAlbert.prototype.__cancelNote=function(){this.noteId=0;void 0!==this.noteTimer1&&this.__removeTimeout(this.noteTimer1);void 0!==this.noteTimer2&&this.__removeTimeout(this.noteTimer2);this.noteTimer2=this.noteTimer1=void 0};
UoAlbert.prototype.__setSound=function(a){this.motoring.sound=a;this.motoring.map|=1048576};UoAlbert.prototype.__runSound=function(a,b){"number"!=typeof b&&(b=1);0>b&&(b=-1);b&&(this.currentSound=a,this.soundRepeat=b,this.__setSound(a))};UoAlbert.prototype.__cancelSound=function(){this.soundCallback=void 0};UoAlbert.prototype.__setBoardSize=function(a,b){this.motoring.boardWidth=a;this.motoring.boardHeight=b;this.motoring.map|=524288};
UoAlbert.prototype.__setMotion=function(a,b,c,e,d){var f=this.motoring;f.motionType=a;f.motionUnit=b;f.motionSpeed=c;f.motionValue=e;f.motionRadius=d;f.map|=1};UoAlbert.prototype.__cancelMotion=function(){this.motionCallback=void 0};
UoAlbert.prototype.handleSensory=function(){var a=this.sensory;a.map2&2147483648&&(this.clicked=!0);a.map2&1073741824&&(this.longPressed=!0);a.map2&536870912&&(this.longLongPressed=!0);if(this.motionCallback&&0!=(a.map&16)&&0==a.wheelState){this.motoring.leftWheel=0;this.motoring.rightWheel=0;var b=this.motionCallback;this.__cancelMotion();b&&b()}0!=(a.map&8)&&0==a.soundState&&(0<this.currentSound?0>this.soundRepeat?this.__runSound(this.currentSound,-1):1<this.soundRepeat?(this.soundRepeat--,this.__runSound(this.currentSound,
this.soundRepeat)):(this.currentSound=0,this.soundRepeat=1,b=this.soundCallback,this.__cancelSound(),b&&b()):(this.currentSound=0,this.soundRepeat=1,b=this.soundCallback,this.__cancelSound(),b&&b()))};UoAlbert.prototype.__UNITS={cm:1,degrees:1,seconds:2,pulses:3};UoAlbert.prototype.__motion=function(a,b){var c=this.motoring;c.leftWheel=0;c.rightWheel=0;this.__setPulse(0);this.__setMotion(a,1,0,0,0);this.motionCallback=b};
UoAlbert.prototype.__motionUnit=function(a,b,c,e){var d=this.motoring;this.__cancelMotion();d.leftWheel=0;d.rightWheel=0;this.__setPulse(0);(c=parseFloat(c))&&0<c?(this.__setMotion(a,b,0,c,0),this.motionCallback=e):(this.__setMotion(0,0,0,0,0),e())};UoAlbert.prototype.moveForward=function(a){this.__motion(101,a)};UoAlbert.prototype.moveBackward=function(a){this.__motion(102,a)};UoAlbert.prototype.turn=function(a,b){"left"==a?this.__motion(103,b):this.__motion(104,b)};
UoAlbert.prototype.moveForwardUnit=function(a,b,c){0>a?this.__motionUnit(2,this.__UNITS[b],-a,c):this.__motionUnit(1,this.__UNITS[b],a,c)};UoAlbert.prototype.moveBackwardUnit=function(a,b,c){0>a?this.__motionUnit(1,this.__UNITS[b],-a,c):this.__motionUnit(2,this.__UNITS[b],a,c)};
UoAlbert.prototype.turnUnit=function(a,b,c,e){"left"==a?0>b?this.__motionUnit(4,this.__UNITS[c],-b,e):this.__motionUnit(3,this.__UNITS[c],b,e):0>b?this.__motionUnit(3,this.__UNITS[c],-b,e):this.__motionUnit(4,this.__UNITS[c],b,e)};
UoAlbert.prototype.pivotUnit=function(a,b,c,e,d){c=this.__UNITS[c];"left"==a?"forward"==e?0>b?this.__motionUnit(6,c,-b,d):this.__motionUnit(5,c,b,d):0>b?this.__motionUnit(5,c,-b,d):this.__motionUnit(6,c,b,d):"forward"==e?0>b?this.__motionUnit(8,c,-b,d):this.__motionUnit(7,c,b,d):0>b?this.__motionUnit(7,c,-b,d):this.__motionUnit(8,c,b,d)};
UoAlbert.prototype.setWheels=function(a,b){var c=this.motoring;this.__cancelMotion();a=parseFloat(a);b=parseFloat(b);"number"==typeof a&&(c.leftWheel=a);"number"==typeof b&&(c.rightWheel=b);this.__setPulse(0);this.__setMotion(0,0,0,0,0)};UoAlbert.prototype.changeWheels=function(a,b){var c=this.motoring;this.__cancelMotion();a=parseFloat(a);b=parseFloat(b);"number"==typeof a&&(c.leftWheel+=a);"number"==typeof b&&(c.rightWheel+=b);this.__setPulse(0);this.__setMotion(0,0,0,0,0)};
UoAlbert.prototype.setWheel=function(a,b){var c=this.motoring;this.__cancelMotion();b=parseFloat(b);"number"==typeof b&&("left"==a?c.leftWheel=b:("right"!=a&&(c.leftWheel=b),c.rightWheel=b));this.__setPulse(0);this.__setMotion(0,0,0,0,0)};UoAlbert.prototype.changeWheel=function(a,b){var c=this.motoring;this.__cancelMotion();b=parseFloat(b);"number"==typeof b&&("left"==a?c.leftWheel+=b:("right"!=a&&(c.leftWheel+=b),c.rightWheel+=b));this.__setPulse(0);this.__setMotion(0,0,0,0,0)};
UoAlbert.prototype.stop=function(){var a=this.motoring;this.__cancelMotion();a.leftWheel=0;a.rightWheel=0;this.__setPulse(0);this.__setMotion(0,0,0,0,0)};UoAlbert.prototype.setBoardSize=function(a,b){a=parseInt(a);b=parseInt(b);a&&b&&0<a&&0<b&&this.__setBoardSize(a,b)};UoAlbert.prototype.__RGBS={red:[255,0,0],orange:[255,63,0],yellow:[255,255,0],green:[0,255,0],"sky blue":[0,255,255],blue:[0,0,255],violet:[63,0,255],purple:[255,0,255],white:[255,255,255]};
UoAlbert.prototype.setEyeColor=function(a,b){var c=this.__RGBS[b];c&&this.setRgb(a,c[0],c[1],c[2])};UoAlbert.prototype.clearEye=function(a){this.setRgb(a,0,0,0)};UoAlbert.prototype.setRgbArray=function(a,b){b&&this.setRgb(a,b[0],b[1],b[2])};
UoAlbert.prototype.setRgb=function(a,b,c,e){var d=this.motoring;b=parseInt(b);c=parseInt(c);e=parseInt(e);"left"==a?("number"==typeof b&&(d.leftRed=b),"number"==typeof c&&(d.leftGreen=c),"number"==typeof e&&(d.leftBlue=e)):"right"==a?("number"==typeof b&&(d.rightRed=b),"number"==typeof c&&(d.rightGreen=c),"number"==typeof e&&(d.rightBlue=e)):("number"==typeof b&&(d.leftRed=b,d.rightRed=b),"number"==typeof c&&(d.leftGreen=c,d.rightGreen=c),"number"==typeof e&&(d.leftBlue=e,d.rightBlue=e))};
UoAlbert.prototype.changeRgb=function(a,b,c,e){var d=this.motoring;b=parseInt(b);c=parseInt(c);e=parseInt(e);"left"==a?("number"==typeof b&&(d.leftRed+=b),"number"==typeof c&&(d.leftGreen+=c),"number"==typeof e&&(d.leftBlue+=e)):"right"==a?("number"==typeof b&&(d.rightRed+=b),"number"==typeof c&&(d.rightGreen+=c),"number"==typeof e&&(d.rightBlue+=e)):("number"==typeof b&&(d.leftRed+=b,d.rightRed+=b),"number"==typeof c&&(d.leftGreen+=c,d.rightGreen+=c),"number"==typeof e&&(d.leftBlue+=e,d.rightBlue+=
e))};UoAlbert.prototype.__SOUNDS={beep:1,siren:2,engine:3,robot:4,march:5,birthday:6,dibidibidip:7};UoAlbert.prototype.playSound=function(a,b){var c=this.motoring;this.__cancelNote();this.__cancelSound();a=this.__SOUNDS[a];b=parseInt(b);c.buzzer=0;this.__setNote(0);a&&b?this.__runSound(a,b):this.__runSound(0)};
UoAlbert.prototype.playSoundUntil=function(a,b,c){var e=this.motoring;this.__cancelNote();this.__cancelSound();a=this.__SOUNDS[a];b=parseInt(b);e.buzzer=0;this.__setNote(0);a&&b?(this.__runSound(a,b),this.soundCallback=c):(this.__runSound(0),c())};UoAlbert.prototype.setBuzzer=function(a){var b=this.motoring;this.__cancelNote();this.__cancelSound();a=parseFloat(a);"number"==typeof a&&(b.buzzer=a);this.__setNote(0);this.__runSound(0)};
UoAlbert.prototype.changeBuzzer=function(a){var b=this.motoring;this.__cancelNote();this.__cancelSound();a=parseFloat(a);"number"==typeof a&&(b.buzzer+=a);this.__setNote(0);this.__runSound(0)};UoAlbert.prototype.clearSound=function(){this.__cancelNote();this.__cancelSound();this.motoring.buzzer=0;this.__setNote(0);this.__runSound(0)};
UoAlbert.prototype.__NOTES={C:4,"C\u266f (D\u266d)":5,D:6,"D\u266f (E\u266d)":7,E:8,F:9,"F\u266f (G\u266d)":10,G:11,"G\u266f (A\u266d)":12,A:13,"A\u266f (B\u266d)":14,B:15};UoAlbert.prototype.playNote=function(a,b){var c=this.motoring;this.__cancelNote();this.__cancelSound();a=this.__NOTES[a];b=parseInt(b);c.buzzer=0;a&&b&&0<b&&8>b?this.__setNote(a+12*(b-1)):this.__setNote(0);this.__runSound(0)};
UoAlbert.prototype.playNoteBeat=function(a,b,c,e){var d=this,f=d.motoring;d.__cancelNote();d.__cancelSound();a=this.__NOTES[a];b=parseInt(b);c=parseFloat(c);f.buzzer=0;if(a&&b&&0<b&&8>b&&c&&0<c&&0<d.tempo){var g=d.__issueNoteId();d.__setNote(a+12*(b-1));a=6E4*c/d.tempo;b=100<a?100:0;0<b&&(d.noteTimer1=setTimeout(function(){d.noteId==g&&(d.__setNote(0),void 0!==d.noteTimer1&&d.__removeTimeout(d.noteTimer1),d.noteTimer1=void 0)},a-b),d.timeouts.push(d.noteTimer1));d.noteTimer2=setTimeout(function(){d.noteId==
g&&(d.__setNote(0),d.__cancelNote(),e())},a);d.timeouts.push(d.noteTimer2);d.__runSound(0)}else d.__setNote(0),d.__runSound(0),e()};UoAlbert.prototype.restBeat=function(a,b){var c=this,e=c.motoring;c.__cancelNote();c.__cancelSound();a=parseFloat(a);e.buzzer=0;c.__setNote(0);c.__runSound(0);if(a&&0<a&&0<c.tempo){var d=c.__issueNoteId();c.noteTimer1=setTimeout(function(){c.noteId==d&&(c.__cancelNote(),b())},6E4*a/c.tempo);c.timeouts.push(c.noteTimer1)}else b()};
UoAlbert.prototype.setTempo=function(a){a=parseFloat(a);"number"==typeof a&&(this.tempo=a,1>this.tempo&&(this.tempo=1))};UoAlbert.prototype.changeTempo=function(a){a=parseFloat(a);"number"==typeof a&&(this.tempo+=a,1>this.tempo&&(this.tempo=1))};UoAlbert.prototype.getLeftProximity=function(){return this.sensory.leftProximity};UoAlbert.prototype.getRightProximity=function(){return this.sensory.rightProximity};UoAlbert.prototype.getAccelerationX=function(){return this.sensory.accelerationX};
UoAlbert.prototype.getAccelerationY=function(){return this.sensory.accelerationY};UoAlbert.prototype.getAccelerationZ=function(){return this.sensory.accelerationZ};UoAlbert.prototype.getTouch=function(){return this.sensory.touch};UoAlbert.prototype.getOid=function(){return this.sensory.oid};UoAlbert.prototype.getPositionX=function(){return this.sensory.positionX};UoAlbert.prototype.getPositionY=function(){return this.sensory.positionY};UoAlbert.prototype.getLight=function(){return this.sensory.light};
UoAlbert.prototype.getTemperature=function(){return this.sensory.temperature};UoAlbert.prototype.getSignalStrength=function(){return this.sensory.signalStrength};UoAlbert.prototype.checkHandFound=function(){var a=this.sensory;return void 0===a.handFound?40<a.leftProximity||40<a.rightProximity:a.handFound};UoAlbert.prototype.checkTouchEvent=function(a){return"clicked"==a?this.clicked:"long-pressed (1.5 secs)"==a?this.longPressed:"long-long-pressed (3 secs)"==a?this.longLongPressed:!1};
UoAlbert.prototype.checkOid=function(a){return this.sensory.oid==parseInt(a)};UoAlbert.prototype.checkTilt=function(a){var b=this.sensory;switch(a){case "tilt forward":return 1==b.tilt;case "tilt backward":return-1==b.tilt;case "tilt left":return 2==b.tilt;case "tilt right":return-2==b.tilt;case "tilt flip":return 3==b.tilt;case "not tilt":return-3==b.tilt}return!1};UoAlbert.prototype.__BATTERY_STATES={normal:2,low:1,empty:0};
UoAlbert.prototype.checkBattery=function(a){return this.sensory.batteryState==this.__BATTERY_STATES[a]};
function AlbertAiController(){this.positionCountFinal=this.positionCount=this.directionCountFinal=this.directionCount=this.prevDirectionFinal=this.prevDirection=0;this.isBackward=!1}AlbertAiController.prototype.PI=3.14159265;AlbertAiController.prototype.PI2=6.2831853;AlbertAiController.prototype.GAIN_ANGLE=30;AlbertAiController.prototype.GAIN_ANGLE_FINE=30;AlbertAiController.prototype.GAIN_POSITION_FINE=30;AlbertAiController.prototype.STRAIGHT_SPEED=50;
AlbertAiController.prototype.MAX_BASE_SPEED=50;AlbertAiController.prototype.GAIN_BASE_SPEED=2;AlbertAiController.prototype.GAIN_POSITION=70;AlbertAiController.prototype.POSITION_TOLERANCE_FINE=3;AlbertAiController.prototype.POSITION_TOLERANCE_FINE_LARGE=5;AlbertAiController.prototype.POSITION_TOLERANCE_ROUGH=5;AlbertAiController.prototype.POSITION_TOLERANCE_ROUGH_LARGE=10;AlbertAiController.prototype.ORIENTATION_TOLERANCE_FINAL=.087;AlbertAiController.prototype.ORIENTATION_TOLERANCE_FINAL_LARGE=.122;
AlbertAiController.prototype.ORIENTATION_TOLERANCE_FINAL_LARGE_LARGE=.262;AlbertAiController.prototype.ORIENTATION_TOLERANCE_ROUGH=.122;AlbertAiController.prototype.ORIENTATION_TOLERANCE_ROUGH_LARGE=.262;AlbertAiController.prototype.ORIENTATION_TOLERANCE_ROUGH_LARGE_LARGE=.524;AlbertAiController.prototype.MINIMUM_WHEEL_SPEED=18;AlbertAiController.prototype.MINIMUM_WHEEL_SPEED_FINE=15;
AlbertAiController.prototype.clear=function(){this.positionCountFinal=this.positionCount=this.directionCountFinal=this.directionCount=this.prevDirectionFinal=this.prevDirection=0};AlbertAiController.prototype.setBackward=function(a){this.isBackward=a};
AlbertAiController.prototype.controlAngleInitial=function(a,b,c){this.isBackward&&(b+=this.PI);b=this.validateRadian(c-b);c=Math.abs(b);if(c<this.ORIENTATION_TOLERANCE_ROUGH)return!0;var e=0<b?1:-1;if(c<this.ORIENTATION_TOLERANCE_ROUGH_LARGE&&0>e*this.prevDirection)return!0;this.prevDirection=e;0<b?(b=Math.log(1+c)*this.GAIN_ANGLE,b<this.MINIMUM_WHEEL_SPEED&&(b=this.MINIMUM_WHEEL_SPEED)):(b=-Math.log(1+c)*this.GAIN_ANGLE,b>-this.MINIMUM_WHEEL_SPEED&&(b=-this.MINIMUM_WHEEL_SPEED));b=parseInt(b);a.left=
-b;a.right=b;return!1};
AlbertAiController.prototype.controlAngleFinal=function(a,b,c){b=this.validateRadian(c-b);c=Math.abs(b);if(c<this.ORIENTATION_TOLERANCE_FINAL)return!0;var e=0<b?1:-1;if(c<this.ORIENTATION_TOLERANCE_FINAL_LARGE&&0>e*this.prevDirectionFinal||c<this.ORIENTATION_TOLERANCE_FINAL_LARGE_LARGE&&0>e*this.prevDirectionFinal&&3<++this.directionCountFinal)return!0;this.prevDirectionFinal=e;0<b?(b=Math.log(1+c)*this.GAIN_ANGLE_FINE,b<this.MINIMUM_WHEEL_SPEED&&(b=this.MINIMUM_WHEEL_SPEED)):(b=-Math.log(1+c)*this.GAIN_ANGLE_FINE,
b>-this.MINIMUM_WHEEL_SPEED&&(b=-this.MINIMUM_WHEEL_SPEED));b=parseInt(b);a.left=-b;a.right=b;return!1};
AlbertAiController.prototype.controlPositionFine=function(a,b,c,e,d,f){var g=-Math.atan2(f-c,d-b);this.isBackward&&(e+=this.PI);e=this.validateRadian(g-e);g=Math.abs(e);b=d-b;c=f-c;c=Math.sqrt(b*b+c*c);if(c<this.POSITION_TOLERANCE_FINE)return!0;if(c<this.POSITION_TOLERANCE_FINE_LARGE&&5<++this.positionCountFinal)return this.positionCountFinal=0,!0;c=0<e?Math.log(1+g)*this.GAIN_POSITION_FINE:-Math.log(1+g)*this.GAIN_POSITION_FINE;this.isBackward&&(c=-c);c=parseInt(c);a.left=this.MINIMUM_WHEEL_SPEED_FINE-
c;a.right=this.MINIMUM_WHEEL_SPEED_FINE+c;this.isBackward&&(a.left=-a.left,a.right=-a.right);return!1};
AlbertAiController.prototype.controlPosition=function(a,b,c,e,d,f){var g=-Math.atan2(f-c,d-b);this.isBackward&&(e+=this.PI);e=this.validateRadian(g-e);g=Math.abs(e);b=d-b;c=f-c;c=Math.sqrt(b*b+c*c);if(c<this.POSITION_TOLERANCE_ROUGH)return!0;if(c<this.POSITION_TOLERANCE_ROUGH_LARGE){if(10<++this.positionCount)return this.positionCount=0,!0}else this.positionCount=0;.01>g?(a.left=this.STRAIGHT_SPEED,a.right=this.STRAIGHT_SPEED):(c=(this.MINIMUM_WHEEL_SPEED+.5/g)*this.GAIN_BASE_SPEED,c>this.MAX_BASE_SPEED&&
(c=this.MAX_BASE_SPEED),e=0<e?Math.log(1+g)*this.GAIN_POSITION:-Math.log(1+g)*this.GAIN_POSITION,this.isBackward&&(e=-e),c=parseInt(c),e=parseInt(e),a.left=c-e,a.right=c+e);this.isBackward&&(a.left=-a.left,a.right=-a.right);return!1};AlbertAiController.prototype.validateRadian=function(a){return a>this.PI?a-this.PI2:a<-this.PI?a+this.PI2:a};AlbertAiController.prototype.toRadian=function(a){return 3.14159265*a/180};
function AlbertAiNavigator(){this.controller=new AlbertAiController;this.state=this.mode=0;this.initialized=!1;this.currentY=this.currentX=-1;this.currentTheta=-200;this.targetY=this.targetX=-1;this.targetTheta=-200;this.wheels={completed:!1,left:0,right:0}}
AlbertAiNavigator.prototype.clear=function(){this.state=this.mode=0;this.initialized=!1;this.currentY=this.currentX=-1;this.currentTheta=-200;this.targetY=this.targetX=-1;this.targetTheta=-200;this.wheels.completed=!1;this.wheels.left=0;this.wheels.right=0;this.controller.clear()};AlbertAiNavigator.prototype.setBackward=function(a){this.controller.setBackward(a)};AlbertAiNavigator.prototype.moveTo=function(a,b){this.clear();this.targetX=a;this.targetY=b;this.mode=this.state=1};
AlbertAiNavigator.prototype.turnTo=function(a){this.clear();this.targetTheta=a;this.state=1;this.mode=2};
AlbertAiNavigator.prototype.handleSensory=function(a){if(1==this.mode){var b=a.positionX,c=a.positionY;0<=b&&(this.currentX=b);0<=c&&(this.currentY=c);this.currentTheta=a.orientation;switch(this.state){case 1:0==this.initialized&&(0>this.currentX||0>this.currentY?(this.wheels.left=20,this.wheels.right=-20):this.initialized=!0);this.initialized&&(a=this.controller.toRadian(this.currentTheta),b=-Math.atan2(this.targetY-this.currentY,this.targetX-this.currentX),this.controller.controlAngleInitial(this.wheels,
a,b)&&(this.state=2));break;case 2:a=this.controller.toRadian(this.currentTheta);this.controller.controlPosition(this.wheels,this.currentX,this.currentY,a,this.targetX,this.targetY)&&(this.state=3);break;case 3:a=this.controller.toRadian(this.currentTheta),this.controller.controlPositionFine(this.wheels,this.currentX,this.currentY,a,this.targetX,this.targetY)&&(this.clear(),this.wheels.completed=!0)}}else if(2==this.mode)switch(this.currentTheta=a.orientation,this.state){case 1:a=this.controller.toRadian(this.currentTheta);
b=this.controller.toRadian(this.targetTheta);this.controller.controlAngleInitial(this.wheels,a,b)&&(this.state=2);break;case 2:a=this.controller.toRadian(this.currentTheta),b=this.controller.toRadian(this.targetTheta),this.controller.controlAngleFinal(this.wheels,a,b)&&(this.clear(),this.wheels.completed=!0)}return this.wheels};
function AlbertAi(a){this.sensory={map1:0,map2:0,signalStrength:0,leftProximity:0,rightProximity:0,accelerationX:0,accelerationY:0,accelerationZ:0,positionX:-1,positionY:-1,orientation:-200,light:0,micTouch:0,volumeUpTouch:0,volumeDownTouch:0,playTouch:0,backTouch:0,oidMode:0,oid:-1,lift:0,pulseCount:0,wheelState:0,soundState:0,batteryState:2,tilt:0,handFound:!1};this.motoring={module:"albertai",index:a,map:3217031168,leftWheel:0,rightWheel:0,leftRed:0,leftGreen:0,leftBlue:0,rightRed:0,rightGreen:0,
rightBlue:0,micRed:0,micGreen:0,micBlue:0,buzzer:0,pulse:0,note:0,sound:0,boardWidth:0,boardHeight:0,motionType:0,motionUnit:0,motionSpeed:0,motionValue:0,motionRadius:0};this.blockId=0;this.motionCallback=this.navigator=this.navigationCallback=void 0;this.currentSound=0;this.soundRepeat=1;this.soundCallback=void 0;this.noteId=0;this.noteTimer2=this.noteTimer1=void 0;this.tap=this.backLongLongPressed=this.playLongLongPressed=this.volumeDownLongLongPressed=this.volumeUpLongLongPressed=this.micLongLongPressed=
this.backLongPressed=this.playLongPressed=this.volumeDownLongPressed=this.volumeUpLongPressed=this.micLongPressed=this.backClicked=this.playClicked=this.volumeDownClicked=this.volumeUpClicked=this.micClicked=!1;this.tempo=60;this.timeouts=[]}
AlbertAi.prototype.reset=function(){var a=this.motoring;a.map=3221094400;a.leftWheel=0;a.rightWheel=0;a.leftRed=0;a.leftGreen=0;a.leftBlue=0;a.rightRed=0;a.rightGreen=0;a.rightBlue=0;a.micRed=0;a.micGreen=0;a.micBlue=0;a.buzzer=0;a.pulse=0;a.note=0;a.sound=0;a.boardWidth=0;a.boardHeight=0;a.motionType=0;a.motionUnit=0;a.motionSpeed=0;a.motionValue=0;this.blockId=a.motionRadius=0;this.motionCallback=this.navigator=this.navigationCallback=void 0;this.currentSound=0;this.soundRepeat=1;this.soundCallback=
void 0;this.noteId=0;this.noteTimer2=this.noteTimer1=void 0;this.tap=this.backLongLongPressed=this.playLongLongPressed=this.volumeDownLongLongPressed=this.volumeUpLongLongPressed=this.micLongLongPressed=this.backLongPressed=this.playLongPressed=this.volumeDownLongPressed=this.volumeUpLongPressed=this.micLongPressed=this.backClicked=this.playClicked=this.volumeDownClicked=this.volumeUpClicked=this.micClicked=!1;this.tempo=60;this.__removeAllTimeouts()};
AlbertAi.prototype.__removeTimeout=function(a){clearTimeout(a);a=this.timeouts.indexOf(a);0<=a&&this.timeouts.splice(a,1)};AlbertAi.prototype.__removeAllTimeouts=function(){var a=this.timeouts,b;for(b in a)clearTimeout(a[b]);this.timeouts=[]};AlbertAi.prototype.clearMotoring=function(){this.motoring.map=3217031168};
AlbertAi.prototype.clearEvent=function(){this.tap=this.backLongLongPressed=this.playLongLongPressed=this.volumeDownLongLongPressed=this.volumeUpLongLongPressed=this.micLongLongPressed=this.backLongPressed=this.playLongPressed=this.volumeDownLongPressed=this.volumeUpLongPressed=this.micLongPressed=this.backClicked=this.playClicked=this.volumeDownClicked=this.volumeUpClicked=this.micClicked=!1};AlbertAi.prototype.__setPulse=function(a){this.motoring.pulse=a;this.motoring.map|=2097152};
AlbertAi.prototype.__setNote=function(a){this.motoring.note=a;this.motoring.map|=1048576};AlbertAi.prototype.__issueNoteId=function(){return this.noteId=this.blockId=this.blockId%65535+1};AlbertAi.prototype.__cancelNote=function(){this.noteId=0;void 0!==this.noteTimer1&&this.__removeTimeout(this.noteTimer1);void 0!==this.noteTimer2&&this.__removeTimeout(this.noteTimer2);this.noteTimer2=this.noteTimer1=void 0};AlbertAi.prototype.__setSound=function(a){this.motoring.sound=a;this.motoring.map|=524288};
AlbertAi.prototype.__runSound=function(a,b){"number"!=typeof b&&(b=1);0>b&&(b=-1);b&&(this.currentSound=a,this.soundRepeat=b,this.__setSound(a))};AlbertAi.prototype.__cancelSound=function(){this.soundCallback=void 0};AlbertAi.prototype.__setBoardSize=function(a,b){this.motoring.boardWidth=a;this.motoring.boardHeight=b;this.motoring.map|=262144};
AlbertAi.prototype.__setMotion=function(a,b,c,e,d){var f=this.motoring;f.motionType=a;f.motionUnit=b;f.motionSpeed=c;f.motionValue=e;f.motionRadius=d;f.map|=131072};AlbertAi.prototype.__cancelMotion=function(){this.motionCallback=void 0};AlbertAi.prototype.__getNavigator=function(){void 0==this.navigator&&(this.navigator=new AlbertAiNavigator);return this.navigator};AlbertAi.prototype.__cancelNavigation=function(){this.navigationCallback=void 0;this.navigator&&this.navigator.clear()};
AlbertAi.prototype.handleSensory=function(){var a=this.sensory;a.map1&8&&(this.micClicked=!0);a.map1&4&&(this.volumeUpClicked=!0);a.map1&2&&(this.volumeDownClicked=!0);a.map1&1&&(this.playClicked=!0);a.map2&2147483648&&(this.backClicked=!0);a.map2&1073741824&&(this.micLongPressed=!0);a.map2&536870912&&(this.volumeUpLongPressed=!0);a.map2&268435456&&(this.volumeDownLongPressed=!0);a.map2&134217728&&(this.playLongPressed=!0);a.map2&67108864&&(this.backLongPressed=!0);a.map2&33554432&&(this.micLongLongPressed=
!0);a.map2&16777216&&(this.volumeUpLongLongPressed=!0);a.map2&8388608&&(this.volumeDownLongLongPressed=!0);a.map2&4194304&&(this.playLongLongPressed=!0);a.map2&2097152&&(this.backLongLongPressed=!0);a.map2&1048576&&(this.tap=!0);if(this.motionCallback&&0!=(a.map2&32768)&&2==a.wheelState){this.motoring.leftWheel=0;this.motoring.rightWheel=0;var b=this.motionCallback;this.__cancelMotion();b&&b()}this.navigationCallback&&this.navigator&&(b=this.navigator.handleSensory(this.sensory),this.motoring.leftWheel=
b.left,this.motoring.rightWheel=b.right,b.completed&&(b=this.navigationCallback,this.__cancelNavigation(),b&&b()));0!=(a.map2&16384)&&0==a.soundState&&(0<this.currentSound?0>this.soundRepeat?this.__runSound(this.currentSound,-1):1<this.soundRepeat?(this.soundRepeat--,this.__runSound(this.currentSound,this.soundRepeat)):(this.currentSound=0,this.soundRepeat=1,b=this.soundCallback,this.__cancelSound(),b&&b()):(this.currentSound=0,this.soundRepeat=1,b=this.soundCallback,this.__cancelSound(),b&&b()))};
AlbertAi.prototype.__UNITS={cm:1,degrees:1,seconds:2,pulses:3};AlbertAi.prototype.__motion=function(a,b){var c=this.motoring;this.__cancelNavigation();c.leftWheel=0;c.rightWheel=0;this.__setPulse(0);this.__setMotion(a,1,0,0,0);this.motionCallback=b};
AlbertAi.prototype.__motionUnit=function(a,b,c,e){var d=this.motoring;this.__cancelNavigation();this.__cancelMotion();d.leftWheel=0;d.rightWheel=0;this.__setPulse(0);(c=parseFloat(c))&&0<c?(this.__setMotion(a,b,0,c,0),this.motionCallback=e):(this.__setMotion(0,0,0,0,0),e())};AlbertAi.prototype.moveForward=function(a){this.__motion(101,a)};AlbertAi.prototype.moveBackward=function(a){this.__motion(102,a)};AlbertAi.prototype.turn=function(a,b){"left"==a?this.__motion(103,b):this.__motion(104,b)};
AlbertAi.prototype.moveForwardUnit=function(a,b,c){0>a?this.__motionUnit(2,this.__UNITS[b],-a,c):this.__motionUnit(1,this.__UNITS[b],a,c)};AlbertAi.prototype.moveBackwardUnit=function(a,b,c){0>a?this.__motionUnit(1,this.__UNITS[b],-a,c):this.__motionUnit(2,this.__UNITS[b],a,c)};
AlbertAi.prototype.turnUnit=function(a,b,c,e){"left"==a?0>b?this.__motionUnit(4,this.__UNITS[c],-b,e):this.__motionUnit(3,this.__UNITS[c],b,e):0>b?this.__motionUnit(3,this.__UNITS[c],-b,e):this.__motionUnit(4,this.__UNITS[c],b,e)};
AlbertAi.prototype.pivotUnit=function(a,b,c,e,d){c=this.__UNITS[c];"left"==a?"forward"==e?0>b?this.__motionUnit(6,c,-b,d):this.__motionUnit(5,c,b,d):0>b?this.__motionUnit(5,c,-b,d):this.__motionUnit(6,c,b,d):"forward"==e?0>b?this.__motionUnit(8,c,-b,d):this.__motionUnit(7,c,b,d):0>b?this.__motionUnit(7,c,-b,d):this.__motionUnit(8,c,b,d)};
AlbertAi.prototype.setWheels=function(a,b){var c=this.motoring;this.__cancelNavigation();this.__cancelMotion();a=parseFloat(a);b=parseFloat(b);"number"==typeof a&&(c.leftWheel=a);"number"==typeof b&&(c.rightWheel=b);this.__setPulse(0);this.__setMotion(0,0,0,0,0)};
AlbertAi.prototype.changeWheels=function(a,b){var c=this.motoring;this.__cancelNavigation();this.__cancelMotion();a=parseFloat(a);b=parseFloat(b);"number"==typeof a&&(c.leftWheel+=a);"number"==typeof b&&(c.rightWheel+=b);this.__setPulse(0);this.__setMotion(0,0,0,0,0)};
AlbertAi.prototype.setWheel=function(a,b){var c=this.motoring;this.__cancelNavigation();this.__cancelMotion();b=parseFloat(b);"number"==typeof b&&("left"==a?c.leftWheel=b:("right"!=a&&(c.leftWheel=b),c.rightWheel=b));this.__setPulse(0);this.__setMotion(0,0,0,0,0)};
AlbertAi.prototype.changeWheel=function(a,b){var c=this.motoring;this.__cancelNavigation();this.__cancelMotion();b=parseFloat(b);"number"==typeof b&&("left"==a?c.leftWheel+=b:("right"!=a&&(c.leftWheel+=b),c.rightWheel+=b));this.__setPulse(0);this.__setMotion(0,0,0,0,0)};AlbertAi.prototype.stop=function(){var a=this.motoring;this.__cancelNavigation();this.__cancelMotion();a.leftWheel=0;a.rightWheel=0;this.__setPulse(0);this.__setMotion(0,0,0,0,0)};
AlbertAi.prototype.moveToOnBoard=function(a,b,c,e){var d=this.motoring;this.__cancelNavigation();this.__cancelMotion();b=parseInt(b);c=parseInt(c);var f=this.__getNavigator();"number"==typeof b&&"number"==typeof c&&0<=b&&0<=c&&(d.leftWheel=0,d.rightWheel=0,this.__setPulse(0),this.__setMotion(0,0,0,0,0),f.setBackward("backward"==a),f.moveTo(b,c),this.navigationCallback=e)};
AlbertAi.prototype.setOrientationToOnBoard=function(a,b){var c=this.motoring;this.__cancelNavigation();this.__cancelMotion();a=parseInt(a);if("number"==typeof a){var e=this.__getNavigator();c.leftWheel=0;c.rightWheel=0;this.__setPulse(0);this.__setMotion(0,0,0,0,0);e.setBackward(!1);e.turnTo(a);this.navigationCallback=b}};
AlbertAi.prototype.__RGBS={red:[255,0,0],orange:[255,63,0],yellow:[255,255,0],green:[0,255,0],"sky blue":[0,255,255],blue:[0,0,255],violet:[63,0,255],purple:[255,0,255],white:[255,255,255]};AlbertAi.prototype.setEyeColor=function(a,b){var c=this.__RGBS[b];c&&this.setRgb(a,c[0],c[1],c[2])};AlbertAi.prototype.clearEye=function(a){this.setRgb(a,0,0,0)};AlbertAi.prototype.setRgbArray=function(a,b){b&&this.setRgb(a,b[0],b[1],b[2])};
AlbertAi.prototype.setRgb=function(a,b,c,e){var d=this.motoring;b=parseInt(b);c=parseInt(c);e=parseInt(e);"left"==a?("number"==typeof b&&(d.leftRed=b),"number"==typeof c&&(d.leftGreen=c),"number"==typeof e&&(d.leftBlue=e)):"right"==a?("number"==typeof b&&(d.rightRed=b),"number"==typeof c&&(d.rightGreen=c),"number"==typeof e&&(d.rightBlue=e)):("number"==typeof b&&(d.leftRed=b,d.rightRed=b),"number"==typeof c&&(d.leftGreen=c,d.rightGreen=c),"number"==typeof e&&(d.leftBlue=e,d.rightBlue=e))};
AlbertAi.prototype.changeRgb=function(a,b,c,e){var d=this.motoring;b=parseInt(b);c=parseInt(c);e=parseInt(e);"left"==a?("number"==typeof b&&(d.leftRed+=b),"number"==typeof c&&(d.leftGreen+=c),"number"==typeof e&&(d.leftBlue+=e)):"right"==a?("number"==typeof b&&(d.rightRed+=b),"number"==typeof c&&(d.rightGreen+=c),"number"==typeof e&&(d.rightBlue+=e)):("number"==typeof b&&(d.leftRed+=b,d.rightRed+=b),"number"==typeof c&&(d.leftGreen+=c,d.rightGreen+=c),"number"==typeof e&&(d.leftBlue+=e,d.rightBlue+=
e))};AlbertAi.prototype.__SOUNDS={beep:1,"random beep":2,noise:10,siren:3,engine:4,robot:5,march:6,birthday:7,dibidibidip:8,"good job":9};AlbertAi.prototype.playSound=function(a,b){var c=this.motoring;this.__cancelNote();this.__cancelSound();a=this.__SOUNDS[a];b=parseInt(b);c.buzzer=0;this.__setNote(0);a&&b?this.__runSound(a,b):this.__runSound(0)};
AlbertAi.prototype.playSoundUntil=function(a,b,c){var e=this.motoring;this.__cancelNote();this.__cancelSound();a=this.__SOUNDS[a];b=parseInt(b);e.buzzer=0;this.__setNote(0);a&&b?(this.__runSound(a,b),this.soundCallback=c):(this.__runSound(0),c())};AlbertAi.prototype.setBuzzer=function(a){var b=this.motoring;this.__cancelNote();this.__cancelSound();a=parseFloat(a);"number"==typeof a&&(b.buzzer=a);this.__setNote(0);this.__runSound(0)};
AlbertAi.prototype.changeBuzzer=function(a){var b=this.motoring;this.__cancelNote();this.__cancelSound();a=parseFloat(a);"number"==typeof a&&(b.buzzer+=a);this.__setNote(0);this.__runSound(0)};AlbertAi.prototype.clearSound=function(){this.__cancelNote();this.__cancelSound();this.motoring.buzzer=0;this.__setNote(0);this.__runSound(0)};
AlbertAi.prototype.__NOTES={C:4,"C\u266f (D\u266d)":5,D:6,"D\u266f (E\u266d)":7,E:8,F:9,"F\u266f (G\u266d)":10,G:11,"G\u266f (A\u266d)":12,A:13,"A\u266f (B\u266d)":14,B:15};AlbertAi.prototype.playNote=function(a,b){var c=this.motoring;this.__cancelNote();this.__cancelSound();a=this.__NOTES[a];b=parseInt(b);c.buzzer=0;a&&b&&0<b&&8>b?this.__setNote(a+12*(b-1)):this.__setNote(0);this.__runSound(0)};
AlbertAi.prototype.playNoteBeat=function(a,b,c,e){var d=this,f=d.motoring;d.__cancelNote();d.__cancelSound();a=this.__NOTES[a];b=parseInt(b);c=parseFloat(c);f.buzzer=0;if(a&&b&&0<b&&8>b&&c&&0<c&&0<d.tempo){var g=d.__issueNoteId();d.__setNote(a+12*(b-1));a=6E4*c/d.tempo;b=100<a?100:0;0<b&&(d.noteTimer1=setTimeout(function(){d.noteId==g&&(d.__setNote(0),void 0!==d.noteTimer1&&d.__removeTimeout(d.noteTimer1),d.noteTimer1=void 0)},a-b),d.timeouts.push(d.noteTimer1));d.noteTimer2=setTimeout(function(){d.noteId==
g&&(d.__setNote(0),d.__cancelNote(),e())},a);d.timeouts.push(d.noteTimer2);d.__runSound(0)}else d.__setNote(0),d.__runSound(0),e()};AlbertAi.prototype.restBeat=function(a,b){var c=this,e=c.motoring;c.__cancelNote();c.__cancelSound();a=parseFloat(a);e.buzzer=0;c.__setNote(0);c.__runSound(0);if(a&&0<a&&0<c.tempo){var d=c.__issueNoteId();c.noteTimer1=setTimeout(function(){c.noteId==d&&(c.__cancelNote(),b())},6E4*a/c.tempo);c.timeouts.push(c.noteTimer1)}else b()};
AlbertAi.prototype.setTempo=function(a){a=parseFloat(a);"number"==typeof a&&(this.tempo=a,1>this.tempo&&(this.tempo=1))};AlbertAi.prototype.changeTempo=function(a){a=parseFloat(a);"number"==typeof a&&(this.tempo+=a,1>this.tempo&&(this.tempo=1))};AlbertAi.prototype.getLeftProximity=function(){return this.sensory.leftProximity};AlbertAi.prototype.getRightProximity=function(){return this.sensory.rightProximity};AlbertAi.prototype.getAccelerationX=function(){return this.sensory.accelerationX};
AlbertAi.prototype.getAccelerationY=function(){return this.sensory.accelerationY};AlbertAi.prototype.getAccelerationZ=function(){return this.sensory.accelerationZ};AlbertAi.prototype.getMicTouch=function(){return this.sensory.micTouch};AlbertAi.prototype.getVolumeUpTouch=function(){return this.sensory.volumeUpTouch};AlbertAi.prototype.getVolumeDownTouch=function(){return this.sensory.volumeDownTouch};AlbertAi.prototype.getPlayTouch=function(){return this.sensory.playTouch};
AlbertAi.prototype.getBackTouch=function(){return this.sensory.backTouch};AlbertAi.prototype.getOidMode=function(){return this.sensory.oidMode};AlbertAi.prototype.getOid=function(){return this.sensory.oid};AlbertAi.prototype.getLift=function(){return this.sensory.lift};AlbertAi.prototype.getPositionX=function(){return this.sensory.positionX};AlbertAi.prototype.getPositionY=function(){return this.sensory.positionY};AlbertAi.prototype.getOrientation=function(){return this.sensory.orientation};
AlbertAi.prototype.getLight=function(){return this.sensory.light};AlbertAi.prototype.getSignalStrength=function(){return this.sensory.signalStrength};AlbertAi.prototype.checkHandFound=function(){var a=this.sensory;return void 0===a.handFound?40<a.leftProximity||40<a.rightProximity:a.handFound};
AlbertAi.prototype.checkTouchState=function(a,b){switch(a){case "mic":switch(b){case "clicked":return this.micClicked;case "long-pressed (1.5 secs)":return this.micLongPressed;case "long-long-pressed (3 secs)":return this.micLongLongPressed}break;case "volume up":switch(b){case "clicked":return this.volumeUpClicked;case "long-pressed (1.5 secs)":return this.volumeUpLongPressed;case "long-long-pressed (3 secs)":return this.volumeUpLongLongPressed}break;case "volume down":switch(b){case "clicked":return this.volumeDownClicked;
case "long-pressed (1.5 secs)":return this.volumeDownLongPressed;case "long-long-pressed (3 secs)":return this.volumeDownLongLongPressed}break;case "play":switch(b){case "clicked":return this.playClicked;case "long-pressed (1.5 secs)":return this.playLongPressed;case "long-long-pressed (3 secs)":return this.playLongLongPressed}break;case "back":switch(b){case "clicked":return this.backClicked;case "long-pressed (1.5 secs)":return this.backLongPressed;case "long-long-pressed (3 secs)":return this.backLongLongPressed}}return!1};
AlbertAi.prototype.checkOid=function(a){return this.sensory.oid==parseInt(a)};AlbertAi.prototype.checkTilt=function(a){var b=this.sensory;switch(a){case "tilt forward":return 1==b.tilt;case "tilt backward":return-1==b.tilt;case "tilt left":return 2==b.tilt;case "tilt right":return-2==b.tilt;case "tilt flip":return 3==b.tilt;case "not tilt":return-3==b.tilt;case "tap":return this.tap;case "lift":return 1==b.lift}return!1};AlbertAi.prototype.__BATTERY_STATES={normal:2,low:1,empty:0};
AlbertAi.prototype.checkBattery=function(a){return this.sensory.batteryState==this.__BATTERY_STATES[a]};
function LineRobot(a,b){this.sensory={map:0,signalStrength:0,colorRed:0,colorGreen:0,colorBlue:0,colorClear:0,floor:0,accelerationX:0,accelerationY:0,accelerationZ:0,temperature:0,button:0,colorNumber:-1,colorPattern:-1,pulseCount:0,tilt:0,batteryState:2};this.motoring={module:b,index:a,map:4160749568,leftWheel:0,rightWheel:0,ledRed:0,ledGreen:0,ledBlue:0,buzzer:0,pulse:0,note:0,sound:0,lineTracerMode:0,lineTracerSpeed:4,motionType:0,motionUnit:0,motionSpeed:0,motionValue:0,motionRadius:0};this.blockId=
0;this.lineTracerCallback=this.motionCallback=void 0;this.currentSound=0;this.soundRepeat=1;this.soundCallback=void 0;this.noteId=0;this.noteTimer2=this.noteTimer1=void 0;this.longPressed=this.doubleClicked=this.clicked=!1;this.colorPattern=-1;this.tap=this.freeFall=!1;this.tempo=60;this.timeouts=[]}
LineRobot.prototype.reset=function(){var a=this.motoring;a.map=4292870144;a.leftWheel=0;a.rightWheel=0;a.ledRed=0;a.ledGreen=0;a.ledBlue=0;a.buzzer=0;a.pulse=0;a.note=0;a.sound=0;a.lineTracerMode=0;a.lineTracerSpeed=4;a.motionType=0;a.motionUnit=0;a.motionSpeed=0;a.motionValue=0;this.blockId=a.motionRadius=0;this.lineTracerCallback=this.motionCallback=void 0;this.currentSound=0;this.soundRepeat=1;this.soundCallback=void 0;this.noteId=0;this.noteTimer2=this.noteTimer1=void 0;this.longPressed=this.doubleClicked=
this.clicked=!1;this.colorPattern=-1;this.tap=this.freeFall=!1;this.tempo=60;this.__removeAllTimeouts()};LineRobot.prototype.__removeTimeout=function(a){clearTimeout(a);a=this.timeouts.indexOf(a);0<=a&&this.timeouts.splice(a,1)};LineRobot.prototype.__removeAllTimeouts=function(){var a=this.timeouts,b;for(b in a)clearTimeout(a[b]);this.timeouts=[]};LineRobot.prototype.clearMotoring=function(){this.motoring.map=4160749568};
LineRobot.prototype.clearEvent=function(){this.longPressed=this.doubleClicked=this.clicked=!1;this.colorPattern=-1;this.tap=this.freeFall=!1};LineRobot.prototype.__setPulse=function(a){this.motoring.pulse=a;this.motoring.map|=67108864};LineRobot.prototype.__setLineTracerMode=function(a){this.motoring.lineTracerMode=a;this.motoring.map|=8388608};LineRobot.prototype.__setLineTracerSpeed=function(a){this.motoring.lineTracerSpeed=a;this.motoring.map|=4194304};
LineRobot.prototype.__cancelLineTracer=function(){this.lineTracerCallback=void 0};LineRobot.prototype.__setMotion=function(a,b,c,d,e){var f=this.motoring;f.motionType=a;f.motionUnit=b;f.motionSpeed=c;f.motionValue=d;f.motionRadius=e;f.map|=2097152};LineRobot.prototype.__cancelMotion=function(){this.motionCallback=void 0};LineRobot.prototype.__setNote=function(a){this.motoring.note=a;this.motoring.map|=33554432};
LineRobot.prototype.__issueNoteId=function(){return this.noteId=this.blockId=this.blockId%65535+1};LineRobot.prototype.__cancelNote=function(){this.noteId=0;void 0!==this.noteTimer1&&this.__removeTimeout(this.noteTimer1);void 0!==this.noteTimer2&&this.__removeTimeout(this.noteTimer2);this.noteTimer2=this.noteTimer1=void 0};LineRobot.prototype.__setSound=function(a){this.motoring.sound=a;this.motoring.map|=16777216};
LineRobot.prototype.__runSound=function(a,b){"number"!=typeof b&&(b=1);0>b&&(b=-1);b&&(this.currentSound=a,this.soundRepeat=b,this.__setSound(a))};LineRobot.prototype.__cancelSound=function(){this.soundCallback=void 0};
LineRobot.prototype.handleSensory=function(){var a=this.sensory;a.map&16384&&(this.clicked=!0);a.map&8192&&(this.doubleClicked=!0);a.map&4096&&(this.longPressed=!0);a.map&1024&&(this.colorPattern=a.colorPattern);a.map&8&&(this.freeFall=!0);a.map&4&&(this.tap=!0);if(this.lineTracerCallback&&0!=(a.map&64)){this.__setLineTracerMode(0);var b=this.lineTracerCallback;this.__cancelLineTracer();b&&b()}this.motionCallback&&0!=(a.map&256)&&(this.motoring.leftWheel=0,this.motoring.rightWheel=0,b=this.motionCallback,
this.__cancelMotion(),b&&b());0!=(a.map&128)&&(0<this.currentSound?0>this.soundRepeat?this.__runSound(this.currentSound,-1):1<this.soundRepeat?(this.soundRepeat--,this.__runSound(this.currentSound,this.soundRepeat)):(this.currentSound=0,this.soundRepeat=1,a=this.soundCallback,this.__cancelSound(),a&&a()):(this.currentSound=0,this.soundRepeat=1,a=this.soundCallback,this.__cancelSound(),a&&a()))};LineRobot.prototype.__UNITS={cm:1,degrees:1,seconds:2,pulses:3};
LineRobot.prototype.__motion=function(a,b){var c=this.motoring;this.__cancelLineTracer();c.leftWheel=0;c.rightWheel=0;this.__setPulse(0);this.__setMotion(a,1,0,0,0);this.motionCallback=b;this.__setLineTracerMode(0)};
LineRobot.prototype.__motionUnit=function(a,b,c,d){var e=this.motoring;this.__cancelLineTracer();this.__cancelMotion();e.leftWheel=0;e.rightWheel=0;this.__setPulse(0);(c=parseFloat(c))&&0<c?(this.__setMotion(a,b,0,c,0),this.motionCallback=d,this.__setLineTracerMode(0)):(this.__setMotion(0,0,0,0,0),this.__setLineTracerMode(0),d())};
LineRobot.prototype.__motionUnitRadius=function(a,b,c,d,e){var f=this.motoring;this.__cancelLineTracer();this.__cancelMotion();f.leftWheel=0;f.rightWheel=0;this.__setPulse(0);c=parseFloat(c);d=parseFloat(d);c&&0<c&&"number"==typeof d&&0<=d?(this.__setMotion(a,b,0,c,d),this.motionCallback=e,this.__setLineTracerMode(0)):(this.__setMotion(0,0,0,0,0),this.__setLineTracerMode(0),e())};LineRobot.prototype.moveForward=function(a){this.__motion(101,a)};
LineRobot.prototype.moveBackward=function(a){this.__motion(102,a)};LineRobot.prototype.turn=function(a,b){"left"==a?this.__motion(103,b):this.__motion(104,b)};LineRobot.prototype.moveForwardUnit=function(a,b,c){0>a?this.__motionUnit(2,this.__UNITS[b],-a,c):this.__motionUnit(1,this.__UNITS[b],a,c)};LineRobot.prototype.moveBackwardUnit=function(a,b,c){0>a?this.__motionUnit(1,this.__UNITS[b],-a,c):this.__motionUnit(2,this.__UNITS[b],a,c)};
LineRobot.prototype.turnUnit=function(a,b,c,d){"left"==a?0>b?this.__motionUnit(4,this.__UNITS[c],-b,d):this.__motionUnit(3,this.__UNITS[c],b,d):0>b?this.__motionUnit(3,this.__UNITS[c],-b,d):this.__motionUnit(4,this.__UNITS[c],b,d)};
LineRobot.prototype.pivotUnit=function(a,b,c,d,e){c=this.__UNITS[c];"left"==a?"forward"==d?0>b?this.__motionUnit(6,c,-b,e):this.__motionUnit(5,c,b,e):0>b?this.__motionUnit(5,c,-b,e):this.__motionUnit(6,c,b,e):"forward"==d?0>b?this.__motionUnit(8,c,-b,e):this.__motionUnit(7,c,b,e):0>b?this.__motionUnit(7,c,-b,e):this.__motionUnit(8,c,b,e)};
LineRobot.prototype.circleUnit=function(a,b,c,d,e,f){c=this.__UNITS[c];"left"==a?"forward"==e?0>b?this.__motionUnitRadius(10,c,-b,d,f):this.__motionUnitRadius(9,c,b,d,f):0>b?this.__motionUnitRadius(9,c,-b,d,f):this.__motionUnitRadius(10,c,b,d,f):"forward"==e?0>b?this.__motionUnitRadius(12,c,-b,d,f):this.__motionUnitRadius(11,c,b,d,f):0>b?this.__motionUnitRadius(11,c,-b,d,f):this.__motionUnitRadius(12,c,b,d,f)};
LineRobot.prototype.setWheels=function(a,b){var c=this.motoring;this.__cancelLineTracer();this.__cancelMotion();a=parseFloat(a);b=parseFloat(b);"number"==typeof a&&(c.leftWheel=a);"number"==typeof b&&(c.rightWheel=b);this.__setPulse(0);this.__setMotion(0,0,0,0,0);this.__setLineTracerMode(0)};
LineRobot.prototype.changeWheels=function(a,b){var c=this.motoring;this.__cancelLineTracer();this.__cancelMotion();a=parseFloat(a);b=parseFloat(b);"number"==typeof a&&(c.leftWheel+=a);"number"==typeof b&&(c.rightWheel+=b);this.__setPulse(0);this.__setMotion(0,0,0,0,0);this.__setLineTracerMode(0)};
LineRobot.prototype.setWheel=function(a,b){var c=this.motoring;this.__cancelLineTracer();this.__cancelMotion();b=parseFloat(b);"number"==typeof b&&("left"==a?c.leftWheel=b:("right"!=a&&(c.leftWheel=b),c.rightWheel=b));this.__setPulse(0);this.__setMotion(0,0,0,0,0);this.__setLineTracerMode(0)};
LineRobot.prototype.changeWheel=function(a,b){var c=this.motoring;this.__cancelLineTracer();this.__cancelMotion();b=parseFloat(b);"number"==typeof b&&("left"==a?c.leftWheel+=b:("right"!=a&&(c.leftWheel+=b),c.rightWheel+=b));this.__setPulse(0);this.__setMotion(0,0,0,0,0);this.__setLineTracerMode(0)};LineRobot.prototype.followLine=function(){var a=this.motoring;this.__cancelLineTracer();this.__cancelMotion();a.leftWheel=0;a.rightWheel=0;this.__setPulse(0);this.__setMotion(0,0,0,0,0);this.__setLineTracerMode(1)};
LineRobot.prototype.followLineUntil=function(a,b){var c=this.motoring;this.__cancelMotion();var d=2;switch(a){case "red":d=10;break;case "yellow":d=11;break;case "green":d=12;break;case "sky blue":d=13;break;case "blue":d=14;break;case "purple":d=15}c.leftWheel=0;c.rightWheel=0;this.__setPulse(0);this.__setMotion(0,0,0,0,0);this.__setLineTracerMode(d);this.lineTracerCallback=b};
LineRobot.prototype.followLineUntilIntersection=function(a){var b=this.motoring;this.__cancelMotion();b.leftWheel=0;b.rightWheel=0;this.__setPulse(0);this.__setMotion(0,0,0,0,0);this.__setLineTracerMode(9);this.lineTracerCallback=a};LineRobot.prototype.crossIntersection=function(a){var b=this.motoring;this.__cancelMotion();b.leftWheel=0;b.rightWheel=0;this.__setPulse(0);this.__setMotion(0,0,0,0,0);this.__setLineTracerMode(3);this.lineTracerCallback=a};
LineRobot.prototype.turnAtIntersection=function(a,b){var c=this.motoring;this.__cancelMotion();var d=4;"right"==a?d=5:"back"==a&&(d=6);c.leftWheel=0;c.rightWheel=0;this.__setPulse(0);this.__setMotion(0,0,0,0,0);this.__setLineTracerMode(d);this.lineTracerCallback=b};
LineRobot.prototype.jumpLine=function(a,b){var c=this.motoring;this.__cancelMotion();var d=7;"right"==a&&(d=8);c.leftWheel=0;c.rightWheel=0;this.__setPulse(0);this.__setMotion(0,0,0,0,0);this.__setLineTracerMode(d);this.lineTracerCallback=b};LineRobot.prototype.setLineTracerSpeed=function(a){a=parseInt(a);"number"==typeof a&&this.__setLineTracerSpeed(a)};
LineRobot.prototype.stop=function(){var a=this.motoring;this.__cancelLineTracer();this.__cancelMotion();a.leftWheel=0;a.rightWheel=0;this.__setPulse(0);this.__setMotion(0,0,0,0,0);this.__setLineTracerMode(0)};LineRobot.prototype.__RGBS={red:[255,0,0],orange:[255,63,0],yellow:[255,255,0],green:[0,255,0],"sky blue":[0,255,255],blue:[0,0,255],violet:[63,0,255],purple:[255,0,255],white:[255,255,255]};LineRobot.prototype.setLedColor=function(a){(a=this.__RGBS[a])&&this.setLedRgb(a[0],a[1],a[2])};
LineRobot.prototype.setLedRgbArray=function(a){a&&this.setLedRgb(a[0],a[1],a[2])};LineRobot.prototype.setLedRgb=function(a,b,c){var d=this.motoring;a=parseInt(a);b=parseInt(b);c=parseInt(c);"number"==typeof a&&(d.ledRed=a);"number"==typeof b&&(d.ledGreen=b);"number"==typeof c&&(d.ledBlue=c)};
LineRobot.prototype.changeLedRgb=function(a,b,c){var d=this.motoring;a=parseInt(a);b=parseInt(b);c=parseInt(c);"number"==typeof a&&(d.ledRed+=a);"number"==typeof b&&(d.ledGreen+=b);"number"==typeof c&&(d.ledBlue+=c)};LineRobot.prototype.clearLed=function(){this.setLedRgb(0,0,0)};LineRobot.prototype.__SOUNDS={beep:1,"random beep":2,noise:10,siren:3,engine:4,chop:11,robot:5,dibidibidip:8,"good job":9,happy:12,angry:13,sad:14,sleep:15,march:6,birthday:7};
LineRobot.prototype.playSound=function(a,b){var c=this.motoring;this.__cancelNote();this.__cancelSound();a=this.__SOUNDS[a];b=parseInt(b);c.buzzer=0;this.__setNote(0);a&&b?this.__runSound(a,b):this.__runSound(0)};LineRobot.prototype.playSoundUntil=function(a,b,c){var d=this.motoring;this.__cancelNote();this.__cancelSound();a=this.__SOUNDS[a];b=parseInt(b);d.buzzer=0;this.__setNote(0);a&&b?(this.__runSound(a,b),this.soundCallback=c):(this.__runSound(0),c())};
LineRobot.prototype.setBuzzer=function(a){var b=this.motoring;this.__cancelNote();this.__cancelSound();a=parseFloat(a);"number"==typeof a&&(b.buzzer=a);this.__setNote(0);this.__runSound(0)};LineRobot.prototype.changeBuzzer=function(a){var b=this.motoring;this.__cancelNote();this.__cancelSound();a=parseFloat(a);"number"==typeof a&&(b.buzzer+=a);this.__setNote(0);this.__runSound(0)};
LineRobot.prototype.clearSound=function(){this.__cancelNote();this.__cancelSound();this.motoring.buzzer=0;this.__setNote(0);this.__runSound(0)};LineRobot.prototype.__NOTES={C:4,"C\u266f (D\u266d)":5,D:6,"D\u266f (E\u266d)":7,E:8,F:9,"F\u266f (G\u266d)":10,G:11,"G\u266f (A\u266d)":12,A:13,"A\u266f (B\u266d)":14,B:15};
LineRobot.prototype.playNote=function(a,b){var c=this.motoring;this.__cancelNote();this.__cancelSound();a=this.__NOTES[a];b=parseInt(b);c.buzzer=0;a&&b&&0<b&&8>b?this.__setNote(a+12*(b-1)):this.__setNote(0);this.__runSound(0)};
LineRobot.prototype.playNoteBeat=function(a,b,c,d){var e=this,f=e.motoring;e.__cancelNote();e.__cancelSound();a=this.__NOTES[a];b=parseInt(b);c=parseFloat(c);f.buzzer=0;if(a&&b&&0<b&&8>b&&c&&0<c&&0<e.tempo){var g=e.__issueNoteId();e.__setNote(a+12*(b-1));a=6E4*c/e.tempo;b=100<a?100:0;0<b&&(e.noteTimer1=setTimeout(function(){e.noteId==g&&(e.__setNote(0),void 0!==e.noteTimer1&&e.__removeTimeout(e.noteTimer1),e.noteTimer1=void 0)},a-b),e.timeouts.push(e.noteTimer1));e.noteTimer2=setTimeout(function(){e.noteId==
g&&(e.__setNote(0),e.__cancelNote(),d())},a);e.timeouts.push(e.noteTimer2);e.__runSound(0)}else e.__setNote(0),e.__runSound(0),d()};LineRobot.prototype.restBeat=function(a,b){var c=this,d=c.motoring;c.__cancelNote();c.__cancelSound();a=parseFloat(a);d.buzzer=0;c.__setNote(0);c.__runSound(0);if(a&&0<a&&0<c.tempo){var e=c.__issueNoteId();c.noteTimer1=setTimeout(function(){c.noteId==e&&(c.__cancelNote(),b())},6E4*a/c.tempo);c.timeouts.push(c.noteTimer1)}else b()};
LineRobot.prototype.setTempo=function(a){a=parseFloat(a);"number"==typeof a&&(this.tempo=a,1>this.tempo&&(this.tempo=1))};LineRobot.prototype.changeTempo=function(a){a=parseFloat(a);"number"==typeof a&&(this.tempo+=a,1>this.tempo&&(this.tempo=1))};LineRobot.prototype.__TOUCHING_COLORS={red:1,orange:7,yellow:2,green:3,"sky blue":4,blue:5,purple:6,black:0,white:8};LineRobot.prototype.checkTouchingColor=function(a){a=this.__TOUCHING_COLORS[a];return"number"==typeof a?this.sensory.colorNumber==a:!1};
LineRobot.prototype.__PATTERN_COLORS={black:0,red:1,yellow:2,green:3,"sky blue":4,blue:5,purple:6};LineRobot.prototype.checkColorPattern=function(a,b){a=this.__PATTERN_COLORS[a];b=this.__PATTERN_COLORS[b];return"number"==typeof a&&"number"==typeof b?this.colorPattern==10*a+b:!1};LineRobot.prototype.checkButtonEvent=function(a){return"clicked"==a?this.clicked:"double-clicked"==a?this.doubleClicked:"long-pressed"==a?this.longPressed:!1};
LineRobot.prototype.checkTilt=function(a){var b=this.sensory;switch(a){case "tilt forward":return 1==b.tilt;case "tilt backward":return-1==b.tilt;case "tilt left":return 2==b.tilt;case "tilt right":return-2==b.tilt;case "tilt flip":return 3==b.tilt;case "not tilt":return-3==b.tilt;case "tap":return this.tap;case "free fall":return this.freeFall}return!1};LineRobot.prototype.__BATTERY_STATES={normal:2,low:1,empty:0};LineRobot.prototype.checkBattery=function(a){return this.sensory.batteryState==this.__BATTERY_STATES[a]};
LineRobot.prototype.getSignalStrength=function(){return this.sensory.signalStrength};LineRobot.prototype.getColorRed=function(){return this.sensory.colorRed};LineRobot.prototype.getColorGreen=function(){return this.sensory.colorGreen};LineRobot.prototype.getColorBlue=function(){return this.sensory.colorBlue};LineRobot.prototype.getFloor=function(){return this.sensory.floor};LineRobot.prototype.getAccelerationX=function(){return this.sensory.accelerationX};LineRobot.prototype.getAccelerationY=function(){return this.sensory.accelerationY};
LineRobot.prototype.getAccelerationZ=function(){return this.sensory.accelerationZ};LineRobot.prototype.getTemperature=function(){return this.sensory.temperature};LineRobot.prototype.getButton=function(){return this.sensory.button};LineRobot.prototype.getColorNumber=function(){return this.sensory.colorNumber};LineRobot.prototype.getColorPattern=function(){return this.colorPattern};
function ZeroneRobot(a){this.sensory={map:0,signalStrength:0,leftProximity:0,rightProximity:0,frontProximity:0,rearProximity:0,colorRed:0,colorGreen:0,colorBlue:0,gesture:-1,colorNumber:-1,pulseCount:0,batteryState:2};this.motoring={module:"zerone",index:a,map:4278190080,leftWheel:0,rightWheel:0,leftHeadRed:0,leftHeadGreen:0,leftHeadBlue:0,rightHeadRed:0,rightHeadGreen:0,rightHeadBlue:0,leftTailRed:0,leftTailGreen:0,leftTailBlue:0,rightTailRed:0,rightTailGreen:0,rightTailBlue:0,buzzer:0,pulse:0,note:0,
sound:0,motionType:0,motionUnit:0,motionSpeed:0,motionValue:0,motionRadius:0,sensorMode:0};this.blockId=0;this.motionCallback=void 0;this.currentSound=0;this.soundRepeat=1;this.soundCallback=void 0;this.noteId=0;this.noteTimer2=this.noteTimer1=void 0;this.gesture=-1;this.tempo=60;this.timeouts=[]}
ZeroneRobot.prototype.reset=function(){var a=this.motoring;a.map=4294443008;a.leftWheel=0;a.rightWheel=0;a.leftHeadRed=0;a.leftHeadGreen=0;a.leftHeadBlue=0;a.rightHeadRed=0;a.rightHeadGreen=0;a.rightHeadBlue=0;a.leftTailRed=0;a.leftTailGreen=0;a.leftTailBlue=0;a.rightTailRed=0;a.rightTailGreen=0;a.rightTailBlue=0;a.buzzer=0;a.pulse=0;a.note=0;a.sound=0;a.motionType=0;a.motionUnit=0;a.motionSpeed=0;a.motionValue=0;a.motionRadius=0;this.blockId=a.sensorMode=0;this.motionCallback=void 0;this.currentSound=
0;this.soundRepeat=1;this.soundCallback=void 0;this.noteId=0;this.noteTimer2=this.noteTimer1=void 0;this.gesture=-1;this.tempo=60;this.__removeAllTimeouts()};ZeroneRobot.prototype.__removeTimeout=function(a){clearTimeout(a);a=this.timeouts.indexOf(a);0<=a&&this.timeouts.splice(a,1)};ZeroneRobot.prototype.__removeAllTimeouts=function(){var a=this.timeouts,b;for(b in a)clearTimeout(a[b]);this.timeouts=[]};ZeroneRobot.prototype.clearMotoring=function(){this.motoring.map=4278190080};
ZeroneRobot.prototype.clearEvent=function(){this.gesture=-1};ZeroneRobot.prototype.__setPulse=function(a){this.motoring.pulse=a;this.motoring.map|=8388608};ZeroneRobot.prototype.__setMotion=function(a,b,c,e,d){var f=this.motoring;f.motionType=a;f.motionUnit=b;f.motionSpeed=c;f.motionValue=e;f.motionRadius=d;f.map|=1048576};ZeroneRobot.prototype.__cancelMotion=function(){this.motionCallback=void 0};ZeroneRobot.prototype.__setNote=function(a){this.motoring.note=a;this.motoring.map|=4194304};
ZeroneRobot.prototype.__issueNoteId=function(){return this.noteId=this.blockId=this.blockId%65535+1};ZeroneRobot.prototype.__cancelNote=function(){this.noteId=0;void 0!==this.noteTimer1&&this.__removeTimeout(this.noteTimer1);void 0!==this.noteTimer2&&this.__removeTimeout(this.noteTimer2);this.noteTimer2=this.noteTimer1=void 0};ZeroneRobot.prototype.__setSound=function(a){this.motoring.sound=a;this.motoring.map|=2097152};
ZeroneRobot.prototype.__runSound=function(a,b){"number"!=typeof b&&(b=1);0>b&&(b=-1);b&&(this.currentSound=a,this.soundRepeat=b,this.__setSound(a))};ZeroneRobot.prototype.__cancelSound=function(){this.soundCallback=void 0};ZeroneRobot.prototype.__setSensorMode=function(a){this.motoring.sensorMode=a;this.motoring.map|=524288};
ZeroneRobot.prototype.handleSensory=function(){var a=this.sensory;a.map&4096&&(this.gesture=a.gesture);if(this.motionCallback&&0!=(a.map&512)){this.motoring.leftWheel=0;this.motoring.rightWheel=0;var b=this.motionCallback;this.__cancelMotion();b&&b()}0!=(a.map&256)&&(0<this.currentSound?0>this.soundRepeat?this.__runSound(this.currentSound,-1):1<this.soundRepeat?(this.soundRepeat--,this.__runSound(this.currentSound,this.soundRepeat)):(this.currentSound=0,this.soundRepeat=1,a=this.soundCallback,this.__cancelSound(),
a&&a()):(this.currentSound=0,this.soundRepeat=1,a=this.soundCallback,this.__cancelSound(),a&&a()))};ZeroneRobot.prototype.__UNITS={cm:1,degrees:1,seconds:2,pulses:3};ZeroneRobot.prototype.__motion=function(a,b){var c=this.motoring;c.leftWheel=0;c.rightWheel=0;this.__setPulse(0);this.__setMotion(a,1,0,0,0);this.motionCallback=b};
ZeroneRobot.prototype.__motionUnit=function(a,b,c,e){var d=this.motoring;this.__cancelMotion();d.leftWheel=0;d.rightWheel=0;this.__setPulse(0);(c=parseFloat(c))&&0<c?(this.__setMotion(a,b,0,c,0),this.motionCallback=e):(this.__setMotion(0,0,0,0,0),e())};ZeroneRobot.prototype.moveForward=function(a){this.__motion(101,a)};ZeroneRobot.prototype.moveBackward=function(a){this.__motion(102,a)};ZeroneRobot.prototype.turn=function(a,b){"left"==a?this.__motion(103,b):this.__motion(104,b)};
ZeroneRobot.prototype.moveForwardUnit=function(a,b,c){0>a?this.__motionUnit(2,this.__UNITS[b],-a,c):this.__motionUnit(1,this.__UNITS[b],a,c)};ZeroneRobot.prototype.moveBackwardUnit=function(a,b,c){0>a?this.__motionUnit(1,this.__UNITS[b],-a,c):this.__motionUnit(2,this.__UNITS[b],a,c)};
ZeroneRobot.prototype.turnUnit=function(a,b,c,e){"left"==a?0>b?this.__motionUnit(4,this.__UNITS[c],-b,e):this.__motionUnit(3,this.__UNITS[c],b,e):0>b?this.__motionUnit(3,this.__UNITS[c],-b,e):this.__motionUnit(4,this.__UNITS[c],b,e)};
ZeroneRobot.prototype.pivotUnit=function(a,b,c,e,d){c=this.__UNITS[c];"left"==a?"forward"==e?0>b?this.__motionUnit(6,c,-b,d):this.__motionUnit(5,c,b,d):0>b?this.__motionUnit(5,c,-b,d):this.__motionUnit(6,c,b,d):"forward"==e?0>b?this.__motionUnit(8,c,-b,d):this.__motionUnit(7,c,b,d):0>b?this.__motionUnit(7,c,-b,d):this.__motionUnit(8,c,b,d)};
ZeroneRobot.prototype.setWheels=function(a,b){var c=this.motoring;this.__cancelMotion();a=parseFloat(a);b=parseFloat(b);"number"==typeof a&&(c.leftWheel=a);"number"==typeof b&&(c.rightWheel=b);this.__setPulse(0);this.__setMotion(0,0,0,0,0)};ZeroneRobot.prototype.changeWheels=function(a,b){var c=this.motoring;this.__cancelMotion();a=parseFloat(a);b=parseFloat(b);"number"==typeof a&&(c.leftWheel+=a);"number"==typeof b&&(c.rightWheel+=b);this.__setPulse(0);this.__setMotion(0,0,0,0,0)};
ZeroneRobot.prototype.setWheel=function(a,b){var c=this.motoring;this.__cancelMotion();b=parseFloat(b);"number"==typeof b&&("left"==a?c.leftWheel=b:("right"!=a&&(c.leftWheel=b),c.rightWheel=b));this.__setPulse(0);this.__setMotion(0,0,0,0,0)};ZeroneRobot.prototype.changeWheel=function(a,b){var c=this.motoring;this.__cancelMotion();b=parseFloat(b);"number"==typeof b&&("left"==a?c.leftWheel+=b:("right"!=a&&(c.leftWheel+=b),c.rightWheel+=b));this.__setPulse(0);this.__setMotion(0,0,0,0,0)};
ZeroneRobot.prototype.stop=function(){var a=this.motoring;this.__cancelMotion();a.leftWheel=0;a.rightWheel=0;this.__setPulse(0);this.__setMotion(0,0,0,0,0)};ZeroneRobot.prototype.__RGBS={red:[255,0,0],orange:[255,63,0],yellow:[255,255,0],green:[0,255,0],"sky blue":[0,255,255],blue:[0,0,255],violet:[63,0,255],purple:[255,0,255],white:[255,255,255]};ZeroneRobot.prototype.setLed=function(a,b){var c=this.__RGBS[b];c&&this.setRgb(a,c[0],c[1],c[2])};
ZeroneRobot.prototype.clearLed=function(a){this.setRgb(a,0,0,0)};ZeroneRobot.prototype.setRgbArray=function(a,b){b&&this.setRgb(a,b[0],b[1],b[2])};
ZeroneRobot.prototype.setRgb=function(a,b,c,e){var d=this.motoring;b=parseInt(b);c=parseInt(c);e=parseInt(e);if("left head"==a||"left"==a||"head"==a||"all"==a)"number"==typeof b&&(d.leftHeadRed=b),"number"==typeof c&&(d.leftHeadGreen=c),"number"==typeof e&&(d.leftHeadBlue=e);if("right head"==a||"right"==a||"head"==a||"all"==a)"number"==typeof b&&(d.rightHeadRed=b),"number"==typeof c&&(d.rightHeadGreen=c),"number"==typeof e&&(d.rightHeadBlue=e);if("left tail"==a||"left"==a||"tail"==a||"all"==a)"number"==
typeof b&&(d.leftTailRed=b),"number"==typeof c&&(d.leftTailGreen=c),"number"==typeof e&&(d.leftTailBlue=e);if("right tail"==a||"right"==a||"tail"==a||"all"==a)"number"==typeof b&&(d.rightTailRed=b),"number"==typeof c&&(d.rightTailGreen=c),"number"==typeof e&&(d.rightTailBlue=e)};
ZeroneRobot.prototype.changeRgb=function(a,b,c,e){var d=this.motoring;b=parseInt(b);c=parseInt(c);e=parseInt(e);if("left head"==a||"left"==a||"head"==a||"all"==a)"number"==typeof b&&(d.leftHeadRed+=b),"number"==typeof c&&(d.leftHeadGreen+=c),"number"==typeof e&&(d.leftHeadBlue+=e);if("right head"==a||"right"==a||"head"==a||"all"==a)"number"==typeof b&&(d.rightHeadRed+=b),"number"==typeof c&&(d.rightHeadGreen+=c),"number"==typeof e&&(d.rightHeadBlue+=e);if("left tail"==a||"left"==a||"tail"==a||"all"==
a)"number"==typeof b&&(d.leftTailRed+=b),"number"==typeof c&&(d.leftTailGreen+=c),"number"==typeof e&&(d.leftTailBlue+=e);if("right tail"==a||"right"==a||"tail"==a||"all"==a)"number"==typeof b&&(d.rightTailRed+=b),"number"==typeof c&&(d.rightTailGreen+=c),"number"==typeof e&&(d.rightTailBlue+=e)};ZeroneRobot.prototype.__SOUNDS={beep:1,"random beep":2,noise:10,siren:3,engine:4,chop:11,robot:5,dibidibidip:8,"good job":9,happy:12,angry:13,sad:14,sleep:15,march:6,birthday:7};
ZeroneRobot.prototype.playSound=function(a,b){var c=this.motoring;this.__cancelNote();this.__cancelSound();a=this.__SOUNDS[a];b=parseInt(b);c.buzzer=0;this.__setNote(0);a&&b?this.__runSound(a,b):this.__runSound(0)};ZeroneRobot.prototype.playSoundUntil=function(a,b,c){var e=this.motoring;this.__cancelNote();this.__cancelSound();a=this.__SOUNDS[a];b=parseInt(b);e.buzzer=0;this.__setNote(0);a&&b?(this.__runSound(a,b),this.soundCallback=c):(this.__runSound(0),c())};
ZeroneRobot.prototype.setBuzzer=function(a){var b=this.motoring;this.__cancelNote();this.__cancelSound();a=parseFloat(a);"number"==typeof a&&(b.buzzer=a);this.__setNote(0);this.__runSound(0)};ZeroneRobot.prototype.changeBuzzer=function(a){var b=this.motoring;this.__cancelNote();this.__cancelSound();a=parseFloat(a);"number"==typeof a&&(b.buzzer+=a);this.__setNote(0);this.__runSound(0)};
ZeroneRobot.prototype.clearSound=function(){this.__cancelNote();this.__cancelSound();this.motoring.buzzer=0;this.__setNote(0);this.__runSound(0)};ZeroneRobot.prototype.__NOTES={C:4,"C\u266f (D\u266d)":5,D:6,"D\u266f (E\u266d)":7,E:8,F:9,"F\u266f (G\u266d)":10,G:11,"G\u266f (A\u266d)":12,A:13,"A\u266f (B\u266d)":14,B:15};
ZeroneRobot.prototype.playNote=function(a,b){var c=this.motoring;this.__cancelNote();this.__cancelSound();a=this.__NOTES[a];b=parseInt(b);c.buzzer=0;a&&b&&0<b&&8>b?this.__setNote(a+12*(b-1)):this.__setNote(0);this.__runSound(0)};
ZeroneRobot.prototype.playNoteBeat=function(a,b,c,e){var d=this,f=d.motoring;d.__cancelNote();d.__cancelSound();a=this.__NOTES[a];b=parseInt(b);c=parseFloat(c);f.buzzer=0;if(a&&b&&0<b&&8>b&&c&&0<c&&0<d.tempo){var g=d.__issueNoteId();d.__setNote(a+12*(b-1));a=6E4*c/d.tempo;b=100<a?100:0;0<b&&(d.noteTimer1=setTimeout(function(){d.noteId==g&&(d.__setNote(0),void 0!==d.noteTimer1&&d.__removeTimeout(d.noteTimer1),d.noteTimer1=void 0)},a-b),d.timeouts.push(d.noteTimer1));d.noteTimer2=setTimeout(function(){d.noteId==
g&&(d.__setNote(0),d.__cancelNote(),e())},a);d.timeouts.push(d.noteTimer2);d.__runSound(0)}else d.__setNote(0),d.__runSound(0),e()};ZeroneRobot.prototype.restBeat=function(a,b){var c=this,e=c.motoring;c.__cancelNote();c.__cancelSound();a=parseFloat(a);e.buzzer=0;c.__setNote(0);c.__runSound(0);if(a&&0<a&&0<c.tempo){var d=c.__issueNoteId();c.noteTimer1=setTimeout(function(){c.noteId==d&&(c.__cancelNote(),b())},6E4*a/c.tempo);c.timeouts.push(c.noteTimer1)}else b()};
ZeroneRobot.prototype.setTempo=function(a){a=parseFloat(a);"number"==typeof a&&(this.tempo=a,1>this.tempo&&(this.tempo=1))};ZeroneRobot.prototype.changeTempo=function(a){a=parseFloat(a);"number"==typeof a&&(this.tempo+=a,1>this.tempo&&(this.tempo=1))};ZeroneRobot.prototype.startSensor=function(a){"gesture"==a?this.__setSensorMode(0):"color"==a&&this.__setSensorMode(1)};ZeroneRobot.prototype.getSignalStrength=function(){return this.sensory.signalStrength};ZeroneRobot.prototype.getLeftProximity=function(){return this.sensory.leftProximity};
ZeroneRobot.prototype.getRightProximity=function(){return this.sensory.rightProximity};ZeroneRobot.prototype.getFrontProximity=function(){return this.sensory.frontProximity};ZeroneRobot.prototype.getRearProximity=function(){return this.sensory.rearProximity};ZeroneRobot.prototype.getColorRed=function(){return this.sensory.colorRed};ZeroneRobot.prototype.getColorGreen=function(){return this.sensory.colorGreen};ZeroneRobot.prototype.getColorBlue=function(){return this.sensory.colorBlue};
ZeroneRobot.prototype.getGesture=function(){return this.gesture};ZeroneRobot.prototype.getColorNumber=function(){return this.sensory.colorNumber};ZeroneRobot.prototype.checkGesture=function(a){switch(a){case "forward":return 0==this.gesture;case "backward":return 1==this.gesture;case "leftward":return 2==this.gesture;case "rightward":return 3==this.gesture;case "near":return 4==this.gesture;case "far":return 5==this.gesture;case "click":return 6==this.gesture;case "long touch":return 7==this.gesture}return!1};
ZeroneRobot.prototype.__TOUCHING_COLORS={red:1,yellow:2,green:3,"sky blue":4,blue:5,purple:6};ZeroneRobot.prototype.checkTouchingColor=function(a){a=this.__TOUCHING_COLORS[a];return"number"==typeof a?this.sensory.colorNumber==a:!1};ZeroneRobot.prototype.__BATTERY_STATES={normal:2,low:1,empty:0};ZeroneRobot.prototype.checkBattery=function(a){return this.sensory.batteryState==this.__BATTERY_STATES[a]};
var CHEESE_HAT_SHAPES={square:[248,136,136,136,248],triangle:[0,32,80,248,0],diamond:[32,80,136,80,32],circle:[112,136,136,136,112],X:[136,80,32,80,136],like:[80,80,0,136,112],dislike:[80,80,0,112,136],angry:[136,80,0,248,136],"open mouth":[80,0,112,136,112],"close mouth":[80,0,0,248,0],"walk 1":[32,48,96,32,80],"walk 2":[32,96,48,32,32],heart:[80,248,248,112,32],star:[32,248,112,112,136],airplane:[32,176,200,176,32],puppy:[48,56,240,112,80],butterfly:[136,216,168,216,136],"quarter note":[16,16,16,
112,112],"eighth note":[32,48,40,224,224],"left arrow":[32,64,248,64,32],"right arrow":[32,16,248,16,32],"up arrow":[32,112,168,32,32],"down arrow":[32,32,168,112,32]},CHEESE_HAT_ALPHABETS={a:{width:5,data:[0,112,144,144,112]},b:{width:5,data:[128,224,144,144,224]},c:{width:5,data:[0,112,128,128,112]},d:{width:5,data:[16,112,144,144,112]},e:{width:5,data:[0,112,240,128,112]},f:{width:5,data:[48,64,240,64,64]},g:{width:5,data:[112,144,112,16,224]},h:{width:5,data:[128,128,224,144,144]},i:{width:2,
data:[128,0,128,128,128]},j:{width:4,data:[32,0,32,160,64]},k:{width:4,data:[128,128,160,192,160]},l:{width:3,data:[128,128,128,128,64]},m:{width:6,data:[0,240,168,168,168]},n:{width:5,data:[0,224,144,144,144]},o:{width:5,data:[0,96,144,144,96]},p:{width:5,data:[0,224,144,224,128]},q:{width:5,data:[0,112,144,112,16]},r:{width:4,data:[0,96,128,128,128]},s:{width:5,data:[0,112,192,48,224]},t:{width:5,data:[64,240,64,64,48]},u:{width:5,data:[0,144,144,144,112]},v:{width:6,data:[0,136,80,80,32]},w:{width:6,
data:[0,136,168,168,80]},x:{width:4,data:[0,160,64,64,160]},y:{width:5,data:[0,144,112,16,96]},z:{width:5,data:[0,240,32,64,240]},A:{width:5,data:[96,144,240,144,144]},B:{width:5,data:[224,144,224,144,224]},C:{width:5,data:[96,144,128,144,96]},D:{width:5,data:[224,144,144,144,224]},E:{width:5,data:[240,128,240,128,240]},F:{width:5,data:[240,128,240,128,128]},G:{width:5,data:[112,128,176,144,96]},H:{width:5,data:[144,144,240,144,144]},I:{width:4,data:[224,64,64,64,224]},J:{width:5,data:[240,32,32,
160,64]},K:{width:5,data:[144,160,192,160,144]},L:{width:5,data:[128,128,128,128,240]},M:{width:6,data:[136,216,168,136,136]},N:{width:6,data:[136,200,168,152,136]},O:{width:5,data:[96,144,144,144,96]},P:{width:5,data:[224,144,224,128,128]},Q:{width:5,data:[96,144,144,160,80]},R:{width:5,data:[224,144,224,144,144]},S:{width:5,data:[112,128,96,16,224]},T:{width:6,data:[248,32,32,32,32]},U:{width:5,data:[144,144,144,144,96]},V:{width:6,data:[136,136,80,80,32]},W:{width:6,data:[136,168,168,168,80]},
X:{width:5,data:[144,144,96,144,144]},Y:{width:6,data:[136,80,32,32,32]},Z:{width:5,data:[240,16,96,128,240]},1:{width:4,data:[64,192,64,64,224]},2:{width:5,data:[96,144,32,64,240]},3:{width:5,data:[96,144,32,144,96]},4:{width:5,data:[32,96,160,240,32]},5:{width:5,data:[240,128,224,16,224]},6:{width:5,data:[96,128,224,144,96]},7:{width:5,data:[240,16,32,64,128]},8:{width:5,data:[96,144,96,144,96]},9:{width:5,data:[96,144,112,16,96]},0:{width:5,data:[96,144,144,144,96]},"`":{width:3,data:[128,64]},
"~":{width:6,data:[0,64,168,16]},"!":{width:2,data:[128,128,128,0,128]},"@":{width:5,data:[0,96,144,176,176]},"#":{width:6,data:[80,248,80,248,80]},$:{width:6,data:[112,160,112,40,112]},"%":{width:5,data:[0,144,32,64,144]},"^":{width:4,data:[64,160]},"&":{width:5,data:[96,144,96,176,80]},"*":{width:4,data:[0,160,64,160]},"(":{width:3,data:[64,128,128,128,64]},")":{width:3,data:[128,64,64,64,128]},_:{width:5,data:[0,0,0,0,240]},"-":{width:4,data:[0,0,224]},"+":{width:4,data:[0,64,224,64]},"|":{width:2,
data:[128,128,128,128,128]},"=":{width:4,data:[0,224,0,224]},"\\":{width:5,data:[0,128,64,32,16]},"{":{width:4,data:[96,64,192,64,96]},"}":{width:4,data:[192,64,96,64,192]},"[":{width:3,data:[192,128,128,128,192]},"]":{width:3,data:[192,64,64,64,192]},":":{width:2,data:[0,128,0,128]},";":{width:3,data:[0,64,0,64,128]},'"':{width:4,data:[160,160]},"'":{width:2,data:[128,128]},"<":{width:4,data:[32,64,128,64,32]},">":{width:4,data:[128,64,32,64,128]},"?":{width:5,data:[96,144,32,0,32]},",":{width:3,
data:[0,0,0,64,128]},".":{width:2,data:[0,0,0,0,128]},"/":{width:5,data:[0,16,32,64,128]}},CHEESE_HAT_KO_CHO_JONG=[{width:5,data:[240,16,16,16,16]},{width:5,data:[240,80,80,80,80]},{width:5,data:[128,128,128,128,240]},{width:5,data:[240,128,128,128,240]},{width:5,data:[240,160,160,160,240]},{width:5,data:[240,16,240,128,240]},{width:5,data:[240,144,144,144,240]},{width:5,data:[144,144,240,144,240]},{width:6,data:[168,168,248,168,248]},{width:5,data:[64,64,160,144,144]},{width:6,data:[80,80,168,168,
168]},{width:5,data:[96,144,144,144,96]},{width:5,data:[240,64,64,160,144]},{width:6,data:[248,80,80,168,168]},{width:5,data:[64,240,64,160,144]},{width:5,data:[240,16,240,16,16]},{width:5,data:[240,128,240,128,240]},{width:5,data:[240,96,96,96,240]},{width:5,data:[96,240,96,144,96]},{width:6,data:[208,80,104,104,104]},{width:6,data:[184,144,144,168,232]},{width:6,data:[144,184,144,168,208]},{width:5,data:[240,80,208,144,208]},{width:6,data:[248,104,232,168,248]},{width:6,data:[232,104,248,168,248]},
{width:6,data:[208,80,232,168,232]},{width:5,data:[240,96,240,160,240]},{width:6,data:[248,80,248,144,248]},{width:6,data:[208,120,208,168,208]},{width:7,data:[168,168,244,180,244]}],CHEESE_HAT_KO_JUNG=[{width:4,data:[128,128,224,128,128]},{width:4,data:[160,160,224,160,160]},{width:4,data:[128,224,128,224,128]},{width:4,data:[160,224,160,224,160]},{width:4,data:[32,32,224,32,32]},{width:4,data:[96,96,224,96,96]},{width:4,data:[32,224,32,224,32]},{width:4,data:[96,224,96,224,96]},{width:6,data:[0,
32,32,248,0]},{width:6,data:[16,80,88,240,16]},{width:6,data:[24,88,88,248,24]},{width:5,data:[16,80,80,240,16]},{width:6,data:[0,80,80,248,0]},{width:6,data:[0,248,32,32,0]},{width:6,data:[8,248,72,88,8]},{width:6,data:[24,248,88,120,24]},{width:5,data:[16,16,240,80,80]},{width:6,data:[0,248,80,80,0]},{width:5,data:[0,0,0,240,0]},{width:5,data:[16,16,16,240,16]},{width:2,data:[128,128,128,128,128]}];
function CheeseHatColorLedBackground(a){this.display=Array(a);this.pos={x:0,y:0};this.reset()}CheeseHatColorLedBackground.prototype.clearDisplay=function(){for(var a=this.display,b=0;b<a.length;++b)a[b]=0};CheeseHatColorLedBackground.prototype.clear=function(){this.data={};this.clearDisplay();this.pos.x=0;this.pos.y=0};CheeseHatColorLedBackground.prototype.reset=function(){this.clear()};
function CheeseHatColorLedSprite(a){this.size=a;this.display=Array(a);this.pos={x:0,y:0};this.roi={};this.rot=Array(4);this.rotTmp=Array(4);this.reset()}CheeseHatColorLedSprite.prototype.clearDisplay=function(){for(var a=this.display,b=0;b<a.length;++b)a[b]=0};CheeseHatColorLedSprite.prototype.clear=function(){this.data={};this.clearDisplay();this.height=this.width=0;var a=this.roi;a.left=this.size;a.right=0;a.top=this.size;a.bottom=0};
CheeseHatColorLedSprite.prototype.reset=function(){this.clear();this.pos.x=0;this.pos.y=0;var a=this.rot;a[0]=0;a[1]=1;a[2]=2;a[3]=3;this.visible=!0};function CheeseHatColorLedTouchCalculator(a){this.size=a}CheeseHatColorLedTouchCalculator.prototype.__checkTouch=function(a,b){for(var c=this.size,d=0;d<c;++d)if(a[d]&b[d])return!0;return!1};CheeseHatColorLedTouchCalculator.prototype.checkSprites=function(a,b){return a&&b?this.__checkTouch(a.display,b.display):!1};
CheeseHatColorLedTouchCalculator.prototype.checkOtherSprite=function(a,b){if(a){var c=a[b];if(c){var d,e;for(e in a)if(b!=e&&(d=a[e])&&this.__checkTouch(c.display,d.display))return!0}}return!1};CheeseHatColorLedTouchCalculator.prototype.checkBackground=function(a,b){return a&&b?this.__checkTouch(a.display,b.display):!1};CheeseHatColorLedTouchCalculator.prototype.checkLeftWall=function(a){return a?0>a.roi.left:!1};
CheeseHatColorLedTouchCalculator.prototype.checkRightWall=function(a){return a?a.roi.right>=this.size:!1};CheeseHatColorLedTouchCalculator.prototype.checkTopWall=function(a){return a?0>a.roi.top:!1};CheeseHatColorLedTouchCalculator.prototype.checkBottomWall=function(a){return a?a.roi.bottom>=this.size:!1};CheeseHatColorLedTouchCalculator.prototype.checkAnyWall=function(a){if(a){a=a.roi;var b=this.size;return 0>a.left||a.right>=b||0>a.top||a.bottom>=b}return!1};
function CheeseHatColorLedMatrix(a,b){this.size=b;this.packet=Array(20);this.packet[0]=a&15|32;this.packet[1]=a>>4&255;this.background=new CheeseHatColorLedBackground(b);this.touchCalculator=new CheeseHatColorLedTouchCalculator(b);this.reset()}CheeseHatColorLedMatrix.prototype.reset=function(){for(var a=this.packet,b=2;20>b;++b)a[b]=0;a[19]=20;this.background.reset();this.sprites={};this.orderedKey=[];this.brightness=20};CheeseHatColorLedMatrix.prototype.getPacket=function(){return this.packet};
CheeseHatColorLedMatrix.prototype.__updateBackground=function(a,b){var c=a.data,d=a.display,e=a.pos;a.clearDisplay();var h=this.size,g;for(g in c)if(0<c[g]){var k=parseInt(g);var m=k>>16&65535;32767<m&&(m-=65536);m+=e.x;if(0<=m&&m<h){var f=k&65535;32767<f&&(f-=65536);f+=e.y;0<=f&&f<h&&(k=16>>f,d[m]|=k,k=5*f+m,m=parseInt(k/2)+2,b[m]=1==k%2?b[m]&240|c[g]&15:b[m]&15|c[g]<<4&240)}}};
CheeseHatColorLedMatrix.prototype.__updateSprite=function(a,b){var c=a.data,d=a.display,e=a.pos,h=a.rot,g=a.rotTmp,k=a.width,m=a.height,f;a.clearDisplay();if(0<k&&0<m){var l=this.size,p=a.roi,r=(h[0]+1)%4!=h[1];r?(g[0]=h[1],g[1]=h[0],g[2]=h[3],g[3]=h[2]):(g[0]=h[0],g[1]=h[1],g[2]=h[2],g[3]=h[3]);for(f=h=0;4>f;++f)if(0==g[f]){h=f;break}r&&(1==h?h=3:3==h&&(h=1));for(var n in c)if(0<c[n]){f=parseInt(n);g=f>>16&65535;32767<g&&(g-=65536);f&=65535;32767<f&&(f-=65536);r&&(g=k-1-g);switch(h){case 1:var q=
g;g=k-1-f;f=q;break;case 2:g=k-1-g;f=m-1-f;break;case 3:q=g,g=f,f=m-1-q}g+=e.x;if(0<=g&&g<l&&(f+=e.y,0<=f&&f<l)){q=16>>f;d[g]|=q;q=5*f+g;var t=parseInt(q/2)+2;b[t]=1==q%2?b[t]&240|c[n]&15:b[t]&15|c[n]<<4&240}g<p.left&&(p.left=g);g>p.right&&(p.right=g);f<p.top&&(p.top=f);f>p.bottom&&(p.bottom=f)}}};
CheeseHatColorLedMatrix.prototype.update=function(){for(var a=this.packet,b=2;20>b;++b)a[b]=0;this.__updateBackground(this.background,a);b=this.sprites;var c=this.orderedKey,d,e=this.size,h;for(h in c)if(d=b[c[h]]){var g=d.roi;g.left=e;g.right=0;g.top=e;g.bottom=0;d.visible&&this.__updateSprite(d,a)}a[19]=this.brightness;return a};CheeseHatColorLedMatrix.prototype.__drawPixel=function(a,b,c,d){a[(b&65535)<<16|c&65535]=d};
CheeseHatColorLedMatrix.prototype.__drawShape=function(a,b,c,d,e,h){for(var g,k,m=0;m<d.length;++m){g=d[m];k=128;for(var f=0;f<e;++f)g&k&&(a[(b+f&65535)<<16|c&65535]=h),k>>=1;++c}};CheeseHatColorLedMatrix.prototype.__KO_JAMO=[[0],[0,0],[0,9],[2],[2,12],[2,18],[3],[3,3],[5],[5,0],[5,6],[5,7],[5,9],[5,16],[5,17],[5,18],[6],[7],[7,7],[7,9],[9],[9,9],[11],[12],[12,12],[14],[15],[16],[17],[18]];
CheeseHatColorLedMatrix.prototype.__KO_CHO=[[0],[0,0],[2],[3],[3,3],[5],[6],[7],[7,7],[9],[9,9],[11],[12],[12,12],[14],[15],[16],[17],[18]];CheeseHatColorLedMatrix.prototype.__KO_JUNG=[[0],[1],[2],[3],[4],[5],[6],[7],[8],[8,0],[8,1],[8,20],[12],[13],[13,4],[13,5],[13,20],[17],[18],[18,20],[20]];CheeseHatColorLedMatrix.prototype.__KO_JONG=[[],[0],[0,0],[0,9],[2],[2,12],[2,18],[3],[5],[5,0],[5,6],[5,7],[5,9],[5,16],[5,17],[5,18],[6],[7],[7,9],[9],[9,9],[11],[12],[14],[15],[16],[17],[18]];
CheeseHatColorLedMatrix.prototype.__drawString=function(a,b,c,d,e,h){for(var g,k=0,m,f,l,p=0;p<e;++p)if(g=d.charCodeAt(p),32==g)m=!0,b+=5,k+=5;else if(m=!1,12593<=g&&12622>=g){if(f=g-12593,0<=f&&30>f){f=this.__KO_JAMO[f];for(var r in f)l=CHEESE_HAT_KO_CHO_JONG[f[r]],this.__drawShape(a,b,c,l.data,l.width-1,h),b+=l.width,k+=l.width,1<f.length&&0==r&&(b--,k--)}}else if(12623<=g&&12643>=g){if(f=g-12623,0<=f&&21>f){f=this.__KO_JUNG[f];for(var n in f)l=CHEESE_HAT_KO_JUNG[f[n]],this.__drawShape(a,b,c,l.data,
l.width-1,h),b+=l.width,k+=l.width,1<f.length&&0==n&&(b--,k--)}}else if(44032<=g&&55203>=g){g-=44032;f=Math.floor(g/28/21);if(0<=f&&19>f){f=this.__KO_CHO[f];for(var q in f)l=CHEESE_HAT_KO_CHO_JONG[f[q]],this.__drawShape(a,b,c,l.data,l.width-1,h),b+=l.width,k+=l.width,1<f.length&&0==q&&(b--,k--)}f=Math.floor(g/28%21);if(0<=f&&21>f){f=this.__KO_JUNG[f];for(var t in f)l=CHEESE_HAT_KO_JUNG[f[t]],this.__drawShape(a,b,c,l.data,l.width-1,h),b+=l.width,k+=l.width,1<f.length&&0==t&&(b--,k--)}f=g%28;if(0<f&&
28>f){f=this.__KO_JONG[f];for(var u in f)l=CHEESE_HAT_KO_CHO_JONG[f[u]],this.__drawShape(a,b,c,l.data,l.width-1,h),b+=l.width,k+=l.width,1<f.length&&0==u&&(b--,k--)}b+=2;k+=2}else if(l=CHEESE_HAT_ALPHABETS[d.charAt(p)])this.__drawShape(a,b,c,l.data,l.width-1,h),b+=l.width,k+=l.width;m&&(k-=5);return k-1};CheeseHatColorLedMatrix.prototype.__drawPattern=function(a,b,c,d,e,h,g){for(var k,m,f=0;f<h;++f)k=d.charAt(e+f),m=(b+f&65535)<<16|c&65535,"1"===k?a[m]=g:"0"===k?a[m]=0:"~"===k&&(a[m]=0<a[m]?0:g)};
CheeseHatColorLedMatrix.prototype.setBackgroundPixel=function(a,b,c){var d=this.background,e=d.pos;this.__drawPixel(d.data,a-e.x,b-e.y,c)};CheeseHatColorLedMatrix.prototype.drawBackgroundShape=function(a,b,c,d){if(c=CHEESE_HAT_SHAPES[c]){var e=this.background,h=e.pos;this.__drawShape(e.data,a-h.x,b-h.y,c,5,d);return!0}return!1};CheeseHatColorLedMatrix.prototype.drawBackgroundString=function(a,b,c,d){var e=c.length;if(0<e){var h=this.background,g=h.pos;this.__drawString(h.data,a-g.x,b-g.y,c,e,d);return!0}return!1};
CheeseHatColorLedMatrix.prototype.drawBackgroundPattern=function(a,b,c,d){c=c.trim();var e=c.length;if(0<e){var h=this.background,g=h.data;h=h.pos;a-=h.x;e=b-h.y;var k=c.split("/");b={};var m=!1,f=e;for(n in k){c=k[n].trim();e=c.length;if(0<e){var l=0;var p=!1;"$"==c?(l=1,p=!0,e=0,m=!0):("$"==c[e-1]&&(p=!0,--e,m=!0),"$"==c[0]&&(l=1,--e,m=!0));b[f]=[l,p,e,c]}else b[f]=void 0;++f}if(m)for(var r in g){var n=parseInt(r);c=n&65535;32767<c&&(c-=65536);c+=h.y;if(c=b[c])n=n>>16&65535,32767<n&&(n-=65536),
n+=h.x,(0<c[0]&&n<a||c[1]&&n>=a+c[2])&&delete g[r]}for(var q in b)(c=b[q])&&this.__drawPattern(g,a,q,c[3],c[0],c[2],d);return!0}return!1};CheeseHatColorLedMatrix.prototype.clearBackground=function(){this.background.clear()};CheeseHatColorLedMatrix.prototype.clearAll=function(){this.background.clear();var a=this.sprites,b,c;for(c in a)(b=a[c])&&b.clear()};CheeseHatColorLedMatrix.prototype.scrollBackgroundBy=function(a,b){var c=this.background.pos;c.x+=a;c.y+=b};
CheeseHatColorLedMatrix.prototype.scrollAllBy=function(a,b){this.scrollBackgroundBy(a,b);var c=this.sprites,d,e;for(e in c)if(d=c[e])d.pos.x+=a,d.pos.y+=b};CheeseHatColorLedMatrix.prototype.__getOrCreateSprite=function(a){var b=this.sprites[a];b||(b=this.sprites[a]=new CheeseHatColorLedSprite(this.size),this.orderedKey.push(a),this.orderedKey.sort(function(c,d){return c-d}));return b};
CheeseHatColorLedMatrix.prototype.__getOrCreateEmptySprite=function(a){var b=this.sprites[a];b?b.data={}:(b=this.sprites[a]=new CheeseHatColorLedSprite(this.size),this.orderedKey.push(a),this.orderedKey.sort(function(c,d){return c-d}));return b};CheeseHatColorLedMatrix.prototype.__setSpriteShape=function(a,b,c){return a&&(b=CHEESE_HAT_SHAPES[b])?(a.width=5,a.height=5,this.__drawShape(a.data,0,0,b,5,c),!0):!1};
CheeseHatColorLedMatrix.prototype.setSpriteShape=function(a,b,c){if(0>a){a=this.sprites;var d=!1;for(e in a)this.__setSpriteShape(a[e],b,c)&&(d=!0);return d}var e=this.__getOrCreateEmptySprite(a);return this.__setSpriteShape(e,b,c)};CheeseHatColorLedMatrix.prototype.__setSpriteString=function(a,b,c){if(a){var d=b.length;if(0<d)return a.width=this.__drawString(a.data,0,0,b,d,c),a.height=5,!0}return!1};
CheeseHatColorLedMatrix.prototype.setSpriteString=function(a,b,c){if(0>a){a=this.sprites;var d=!1;for(e in a)this.__setSpriteString(a[e],b,c)&&(d=!0);return d}var e=this.__getOrCreateEmptySprite(a);return this.__setSpriteString(e,b,c)};CheeseHatColorLedMatrix.prototype.__setSpritePattern=function(a,b,c){if(a&&(b=b.trim(),0<b.length)){var d=a.data,e=0,h=0,g=b.split("/"),k;for(k in g)b=g[k].trim(),this.__drawPattern(d,0,e,b,0,b.length,c),h=Math.max(h,b.length),++e;a.width=h;a.height=e;return!0}return!1};
CheeseHatColorLedMatrix.prototype.setSpritePattern=function(a,b,c){if(0>a){a=this.sprites;var d=!1;for(e in a)this.__setSpritePattern(a[e],b,c)&&(d=!0);return d}var e=this.__getOrCreateEmptySprite(a);return this.__setSpritePattern(e,b,c)};CheeseHatColorLedMatrix.prototype.clearSprite=function(a){if(0>a){a=this.sprites;var b,c;for(c in a)(b=a[c])&&b.clear()}else this.__getOrCreateSprite(a).clear()};
CheeseHatColorLedMatrix.prototype.showSprite=function(a){if(0>a){a=this.sprites;var b,c;for(c in a)if(b=a[c])b.visible=!0}else this.__getOrCreateSprite(a).visible=!0};CheeseHatColorLedMatrix.prototype.hideSprite=function(a){if(0>a){a=this.sprites;var b,c;for(c in a)if(b=a[c])b.visible=!1}else this.__getOrCreateSprite(a).visible=!1};
CheeseHatColorLedMatrix.prototype.changeSpritePositionsBy=function(a,b,c){if(0>a){a=this.sprites;var d;for(e in a)if(d=a[e])d.pos.x+=b,d.pos.y+=c}else{var e=this.__getOrCreateSprite(a);e.pos.x+=b;e.pos.y+=c}};CheeseHatColorLedMatrix.prototype.setSpritePositionsTo=function(a,b,c){if(0>a){a=this.sprites;var d;for(e in a)if(d=a[e])d.pos.x=b,d.pos.y=c}else{var e=this.__getOrCreateSprite(a);e.pos.x=b;e.pos.y=c}};
CheeseHatColorLedMatrix.prototype.changeSpritePositionBy=function(a,b,c){if(0>a){a=this.sprites;var d;for(e in a)if(d=a[e])b?d.pos.x+=c:d.pos.y+=c}else{var e=this.__getOrCreateSprite(a);b?e.pos.x+=c:e.pos.y+=c}};CheeseHatColorLedMatrix.prototype.setSpritePositionTo=function(a,b,c){if(0>a){a=this.sprites;var d;for(e in a)if(d=a[e])b?d.pos.x=c:d.pos.y=c}else{var e=this.__getOrCreateSprite(a);b?e.pos.x=c:e.pos.y=c}};
CheeseHatColorLedMatrix.prototype.__rotateSprite=function(a,b){if(a){var c=a.rot,d=c[0],e=c[1],h=c[2],g=c[3];b?(c[0]=g,c[1]=d,c[2]=e,c[3]=h):(c[0]=e,c[1]=h,c[2]=g,c[3]=d);c=a.width;d=a.height;e=parseInt((c-d)/2);a.pos.x+=e;a.pos.y-=e;a.width=d;a.height=c}};CheeseHatColorLedMatrix.prototype.rotateSprite=function(a,b){if(0>a){var c=this.sprites,d;for(d in c)this.__rotateSprite(c[d],b)}else c=this.__getOrCreateSprite(a),this.__rotateSprite(c,b)};
CheeseHatColorLedMatrix.prototype.__flipSprite=function(a,b){if(a){var c=a.rot,d=c[0],e=c[1],h=c[2],g=c[3];b?(c[0]=e,c[1]=d,c[2]=g,c[3]=h):(c[0]=g,c[1]=h,c[2]=e,c[3]=d)}};CheeseHatColorLedMatrix.prototype.flipSprite=function(a,b){if(0>a){var c=this.sprites,d;for(d in c)this.__flipSprite(c[d],b)}else c=this.__getOrCreateSprite(a),this.__flipSprite(c,b)};
CheeseHatColorLedMatrix.prototype.__stampSprite=function(a){if(a){var b=this.background,c=a.data,d=b.data;a=a.pos;b=b.pos;var e;for(e in c){var h=parseInt(e);var g=h>>16&65535;32767<g&&(g-=65536);g+=a.x-b.x;h&=65535;32767<h&&(h-=65536);h+=a.y-b.y;d[(g&65535)<<16|h&65535]=c[e]}}};CheeseHatColorLedMatrix.prototype.stampSprite=function(a){if(0>a){a=this.sprites;for(var b in a)this.__stampSprite(a[b])}else this.__stampSprite(this.sprites[a])};
CheeseHatColorLedMatrix.prototype.changeBrightnessBy=function(a){a+=this.brightness;0>a?a=0:100<a&&(a=100);this.brightness=a};CheeseHatColorLedMatrix.prototype.setBrightnessTo=function(a){0>a?a=0:100<a&&(a=100);this.brightness=a};CheeseHatColorLedMatrix.prototype.getSpritePosition=function(a,b){var c=this.sprites[a];return c?b?c.pos.x:c.pos.y:0};CheeseHatColorLedMatrix.prototype.checkSpritesTouched=function(a,b){return this.touchCalculator.checkSprites(this.sprites[a],this.sprites[b])};
CheeseHatColorLedMatrix.prototype.checkOtherSpriteTouched=function(a){return this.touchCalculator.checkOtherSprite(this.sprites,a)};CheeseHatColorLedMatrix.prototype.checkBackgroundTouched=function(a){return this.touchCalculator.checkBackground(this.sprites[a],this.background)};
CheeseHatColorLedMatrix.prototype.checkWallTouched=function(a,b){switch(b){case -1:return this.touchCalculator.checkAnyWall(this.sprites[a]);case 0:return this.touchCalculator.checkLeftWall(this.sprites[a]);case 1:return this.touchCalculator.checkRightWall(this.sprites[a]);case 2:return this.touchCalculator.checkTopWall(this.sprites[a]);case 3:return this.touchCalculator.checkBottomWall(this.sprites[a])}return!1};
function CheeseRange(){this.__ranges={}}CheeseRange.prototype.__getOrCreate=function(a){var c=this.__ranges[a];c||(c=this.__ranges[a]={},this.__reset(c));return c};CheeseRange.prototype.__reset=function(a){a.active=!1;a.has_middle=!1;a.has_decimal=!0;a.in_lower=0;a.in_middle=127;a.in_upper=255;a.out_lower=-100;a.out_middle=0;a.out_upper=100;a.out_min=-100;a.out_max=100};CheeseRange.prototype.reset=function(){var a=this.__ranges,c;for(c in a)this.__reset(a[c])};
CheeseRange.prototype.setLowHigh=function(a,c,b,e,d,f){a=this.__getOrCreate(a);a.has_middle=!1;a.has_decimal=f;a.in_lower=c;a.in_upper=b;a.out_lower=e;a.out_upper=d;a.out_min=Math.min(e,d);a.out_max=Math.max(e,d);a.active=!0};CheeseRange.prototype.setLowMidHigh=function(a,c,b,e,d,f,g,h){a=this.__getOrCreate(a);a.has_middle=b==c||b==e?!1:!0;a.has_decimal=h;a.in_lower=c;a.in_middle=b;a.in_upper=e;a.out_lower=d;a.out_middle=f;a.out_upper=g;a.out_min=Math.min(d,g);a.out_max=Math.max(d,g);a.active=!0};
CheeseRange.prototype.calc=function(a,c){var b=this.__getOrCreate(a);b.active&&(b.has_middle?b.in_middle==b.in_upper||b.in_middle==b.in_lower?b.in_lower!=b.in_upper&&(c=(b.out_upper-b.out_lower)*(c-b.in_lower)/(b.in_upper-b.in_lower)+b.out_lower):c=c>b.in_middle?(b.out_upper-b.out_middle)*(c-b.in_middle)/(b.in_upper-b.in_middle)+b.out_middle:(b.out_middle-b.out_lower)*(c-b.in_lower)/(b.in_middle-b.in_lower)+b.out_lower:b.in_lower!=b.in_upper&&(c=(b.out_upper-b.out_lower)*(c-b.in_lower)/(b.in_upper-
b.in_lower)+b.out_lower),c<b.out_min?c=b.out_min:c>b.out_max&&(c=b.out_max));return b.has_decimal?c:Math.round(c)};function CheeseButtonCounter(){this.__counters={}}CheeseButtonCounter.prototype.reset=function(){var a=this.__counters,c;for(c in a)a[c]=0};CheeseButtonCounter.prototype.tick=function(){var a=this.__counters,c;for(c in a)0<a[c]&&--a[c]};CheeseButtonCounter.prototype.setCount=function(a,c){this.__counters[a]=c};
CheeseButtonCounter.prototype.isCounting=function(a){a=this.__counters[a];return void 0===a?!1:0<a};function CheeseLed(a){this.__port=a;this.__PORT_A=a+"a";this.__PORT_B=a+"b";this.__PORT_C=a+"c";this.reset()}CheeseLed.prototype.reset=function(){this.__b=this.__g=this.__r=0;this.__anode=!1;this.__portR=this.__PORT_A;this.__portG=this.__PORT_B;this.__portB=this.__PORT_C};
CheeseLed.prototype.setType=function(a){switch(a){case "default":case "-rgb":this.__anode=!1;this.__portR=this.__PORT_A;this.__portG=this.__PORT_B;this.__portB=this.__PORT_C;break;case "-rbg":this.__anode=!1;this.__portR=this.__PORT_A;this.__portB=this.__PORT_B;this.__portG=this.__PORT_C;break;case "-grb":this.__anode=!1;this.__portG=this.__PORT_A;this.__portR=this.__PORT_B;this.__portB=this.__PORT_C;break;case "-gbr":this.__anode=!1;this.__portG=this.__PORT_A;this.__portB=this.__PORT_B;this.__portR=
this.__PORT_C;break;case "-brg":this.__anode=!1;this.__portB=this.__PORT_A;this.__portR=this.__PORT_B;this.__portG=this.__PORT_C;break;case "-bgr":this.__anode=!1;this.__portB=this.__PORT_A;this.__portG=this.__PORT_B;this.__portR=this.__PORT_C;break;case "+rgb":this.__anode=!0;this.__portR=this.__PORT_A;this.__portG=this.__PORT_B;this.__portB=this.__PORT_C;break;case "+rbg":this.__anode=!0;this.__portR=this.__PORT_A;this.__portB=this.__PORT_B;this.__portG=this.__PORT_C;break;case "+grb":this.__anode=
!0;this.__portG=this.__PORT_A;this.__portR=this.__PORT_B;this.__portB=this.__PORT_C;break;case "+gbr":this.__anode=!0;this.__portG=this.__PORT_A;this.__portB=this.__PORT_B;this.__portR=this.__PORT_C;break;case "+brg":this.__anode=!0;this.__portB=this.__PORT_A;this.__portR=this.__PORT_B;this.__portG=this.__PORT_C;break;case "+bgr":this.__anode=!0,this.__portB=this.__PORT_A,this.__portG=this.__PORT_B,this.__portR=this.__PORT_C}};CheeseLed.prototype.getR=function(){return this.__r};
CheeseLed.prototype.getG=function(){return this.__g};CheeseLed.prototype.getB=function(){return this.__b};CheeseLed.prototype.setRgb=function(a,c,b){this.__r=a;this.__g=c;this.__b=b};CheeseLed.prototype.isAnode=function(){return this.__anode};CheeseLed.prototype.getPortR=function(){return this.__portR};CheeseLed.prototype.getPortG=function(){return this.__portG};CheeseLed.prototype.getPortB=function(){return this.__portB};function CheeseButtonChecker(){this.reset()}
CheeseButtonChecker.prototype.reset=function(){this.__pressTime=this.__state=0;this.__longPressedEvent=this.__clickedEvent=this.__longPressed=this.__clicked=!1};CheeseButtonChecker.prototype.clearEvent=function(){this.__longPressedEvent=this.__clickedEvent=!1};
CheeseButtonChecker.prototype.check=function(a){this.__longPressed=this.__clicked=!1;switch(this.__state){case 0:a&&(this.__pressTime=Date.now(),this.__state=1);break;case 1:a?1500<Date.now()-this.__pressTime&&(this.__longPressed=!0,this.__state=2):(750>Date.now()-this.__pressTime&&(this.__clicked=!0),this.__state=0);break;case 2:a||(this.__state=0)}this.__clicked&&(this.__clickedEvent=!0);this.__longPressed&&(this.__longPressedEvent=!0)};CheeseButtonChecker.prototype.isClicked=function(){return this.__clickedEvent};
CheeseButtonChecker.prototype.isLongPressed=function(){return this.__longPressedEvent};
function CheeseNeopixel(){for(var a=this.__packet=Array(20),b=0;20>b;++b)a[b]=0;this.__reset()}CheeseNeopixel.prototype.__reset=function(){this.__cmdId=0;this.__hasWhite=!1;this.__numLeds=0;this.__brightness=128;this.__brightnessPerc=50;this.__auto=!0};CheeseNeopixel.prototype.getPacket=function(){return this.__packet};CheeseNeopixel.prototype.end=function(){var a=this.__packet;a[0]=this.__hasWhite?77:69;a[1]=80;a[19]=1;this.__reset();return a};
CheeseNeopixel.prototype.setType=function(a){switch(a){case 0:this.__hasWhite=!1;break;case 1:this.__hasWhite=!0}};CheeseNeopixel.prototype.setNumLeds=function(a){0>a?a=0:144<a&&(a=144);this.__numLeds=a};CheeseNeopixel.prototype.__preparePacket=function(a){this.__cmdId=this.__cmdId%15+1;var b=this.__packet;b[0]=this.__hasWhite?77:69;b[1]=a<<4&240|this.__cmdId&15;for(a=2;20>a;++a)b[a]=0;b[19]=this.__auto?1:0;return b};
CheeseNeopixel.prototype.__setRgb=function(a,b,c,d,g,f){var e=this.__preparePacket(0);a>b?(e[2]=0==c?a:(a-b)%c+b,e[3]=a):(e[2]=a,e[3]=b);e[4]=c;e[5]=0;e[6]=d;e[7]=g;e[8]=f;e[9]=this.__brightness};CheeseNeopixel.prototype.__changeRgb=function(a,b,c,d,g,f){var e=this.__preparePacket(1);a>b?(e[2]=0==c?a:(a-b)%c+b,e[3]=a):(e[2]=a,e[3]=b);e[4]=c;e[10]=0;0>d&&(d=-d,e[10]|=4);0>g&&(g=-g,e[10]|=2);0>f&&(f=-f,e[10]|=1);e[5]=0;e[6]=d;e[7]=g;e[8]=f;e[9]=this.__brightness};
CheeseNeopixel.prototype.__clear=function(a,b,c){var d=this.__preparePacket(3);a>b?(d[2]=0==c?a:(a-b)%c+b,d[3]=a):(d[2]=a,d[3]=b);d[4]=0;d[5]=this.__brightness;d[6]=1;d[7]=0<c?c-1:c};CheeseNeopixel.prototype.__setPattern=function(a,b,c){var d=this.__preparePacket(3);a>b?(d[2]=b,d[3]=a):(d[2]=a,d[3]=b);d[4]=c;d[5]=this.__brightness;d[6]=d[3]-d[2]+1;d[7]=0};
CheeseNeopixel.prototype.__shift=function(a,b,c,d,g){var f=this.__preparePacket(4);a>b?(f[2]=b,f[3]=a):(f[2]=a,f[3]=b);f[4]=c;f[5]=d?0:1;f[6]=g?1:0;f[7]=this.__brightness};CheeseNeopixel.prototype.__setBrightness=function(a,b,c,d){this.__brightnessPerc=d;this.__brightness=parseInt(2.55*d);d=this.__preparePacket(2);a>b?(d[2]=0==c?a:(a-b)%c+b,d[3]=a):(d[2]=a,d[3]=b);d[4]=c;d[5]=this.__brightness;d[6]=255;d[7]=255;d[8]=255;d[9]=255};
CheeseNeopixel.prototype.setAllRgb=function(a,b,c){this.__setRgb(0,this.__numLeds-1,1,a,b,c)};CheeseNeopixel.prototype.changeAllRgb=function(a,b,c){this.__changeRgb(0,this.__numLeds-1,1,a,b,c)};CheeseNeopixel.prototype.setAllPattern=function(a){this.__setPattern(0,this.__numLeds-1,a)};CheeseNeopixel.prototype.setRgbAt=function(a,b,c,d){if(0>a||a>=this.__numLeds)return!1;this.__setRgb(a,a,0,b,c,d);return!0};
CheeseNeopixel.prototype.changeRgbAt=function(a,b,c,d){if(0>a||a>=this.__numLeds)return!1;this.__changeRgb(a,a,0,b,c,d);return!0};CheeseNeopixel.prototype.setPatternAt=function(a,b){if(0>a||a>=this.__numLeds)return!1;this.__setPattern(a,a,b);return!0};CheeseNeopixel.prototype.setRgbFromTo=function(a,b,c,d,g,f){if(0>a||a>=this.__numLeds||0>b||b>=this.__numLeds)return!1;0>c&&(c=-c);if(c>=this.__numLeds)return!1;0==c&&(b=a);this.__setRgb(a,b,c,d,g,f);return!0};
CheeseNeopixel.prototype.changeRgbFromTo=function(a,b,c,d,g,f){if(0>a||a>=this.__numLeds||0>b||b>=this.__numLeds)return!1;0>c&&(c=-c);if(c>=this.__numLeds)return!1;0==c&&(b=a);this.__changeRgb(a,b,c,d,g,f);return!0};CheeseNeopixel.prototype.setPatternFromTo=function(a,b,c){if(0>a||a>=this.__numLeds||0>b||b>=this.__numLeds)return!1;this.__setPattern(a,b,c);return!0};CheeseNeopixel.prototype.clearAll=function(){this.__preparePacket(5)};
CheeseNeopixel.prototype.clearAt=function(a){if(0>a||a>=this.__numLeds)return!1;this.__clear(a,a,0);return!0};CheeseNeopixel.prototype.clearFromTo=function(a,b,c){if(0>a||a>=this.__numLeds||0>b||b>=this.__numLeds)return!1;0>c&&(c=-c);if(c>=this.__numLeds||127<=c)return!1;0==c&&(b=a);this.__clear(a,b,c);return!0};
CheeseNeopixel.prototype.shiftAll=function(a){if(0==a)return!1;if(0>a){if(-143>a)return!1;this.__shift(0,this.__numLeds-1,-a,!0,!0)}else{if(143<a)return!1;this.__shift(0,this.__numLeds-1,a,!0,!1)}return!0};CheeseNeopixel.prototype.rotateAll=function(a){if(0==a)return!1;if(0>a){if(-143>a)return!1;this.__shift(0,this.__numLeds-1,-a,!1,!0)}else{if(143<a)return!1;this.__shift(0,this.__numLeds-1,a,!1,!1)}return!0};
CheeseNeopixel.prototype.changeBrightnessBy=function(a){a+=this.__brightnessPerc;0>a?a=0:100<a&&(a=100);this.__setBrightness(0,this.__numLeds-1,1,a)};CheeseNeopixel.prototype.setBrightnessTo=function(a){0>a?a=0:100<a&&(a=100);this.__setBrightness(0,this.__numLeds-1,1,a)};
function CheesePid(){this.__buttonChecker1=new CheeseButtonChecker;this.__buttonChecker2=new CheeseButtonChecker;this.reset()}CheesePid.prototype.reset=function(){this.__button2=this.__button1=this.__y2=this.__x2=this.__y1=this.__x1=this.__humidity=this.__temperature=this.__time=this.__distance=0;this.__buttonChecker1.reset();this.__buttonChecker2.reset();this.__encoder=0};CheesePid.prototype.clearEvent=function(){this.__buttonChecker1.clearEvent();this.__buttonChecker2.clearEvent()};
CheesePid.prototype.handleSensory=function(c,a){switch(c){case 10:this.__distance=((a[1]&255)<<8|a[2]&255)/10;this.__time=(a[3]&255)<<8|a[4]&255;break;case 11:this.__humidity=((a[1]&255)<<8|a[2]&255)/10;this.__temperature=((a[4]&255)<<8|a[5]&255)/10;0<a[3]&&(this.__temperature=-this.__temperature);break;case 12:this.__temperature=((a[2]&255)<<8|a[3]&255)/100;0<a[1]&&(this.__temperature=-this.__temperature);break;case 13:this.__x1=a[1];this.__y1=a[2];this.__button1=a[4];this.__button2=a[3];this.__buttonChecker1.check(1==
this.__button1);this.__buttonChecker2.check(1==this.__button2);break;case 14:this.__x1=a[4];this.__y1=a[5];this.__button1=a[3];this.__x2=a[1];this.__y2=a[2];this.__button2=a[6];this.__buttonChecker1.check(1==this.__button1);this.__buttonChecker2.check(1==this.__button2);break;case 16:this.__button1=1-a[1];var b=((a[2]&255)<<8|a[3]&255)&2047;1023<b&&(b-=2048);this.__encoder=b;this.__buttonChecker1.check(1==this.__button1)}};CheesePid.prototype.getDistance=function(){return this.__distance};
CheesePid.prototype.getTime=function(){return this.__time};CheesePid.prototype.getTemperature=function(){return this.__temperature};CheesePid.prototype.getHumidity=function(){return this.__humidity};CheesePid.prototype.getX1=function(){return this.__x1};CheesePid.prototype.getY1=function(){return this.__y1};CheesePid.prototype.getX2=function(){return this.__x2};CheesePid.prototype.getY2=function(){return this.__y2};CheesePid.prototype.getButton1=function(){return this.__button1};
CheesePid.prototype.getButton2=function(){return this.__button2};CheesePid.prototype.isButton1Clicked=function(){return this.__buttonChecker1.isClicked()};CheesePid.prototype.isButton2Clicked=function(){return this.__buttonChecker2.isClicked()};CheesePid.prototype.isButton1LongPressed=function(){return this.__buttonChecker1.isLongPressed()};CheesePid.prototype.isButton2LongPressed=function(){return this.__buttonChecker2.isLongPressed()};CheesePid.prototype.getEncoder=function(){return this.__encoder};
function CheeseHat010(a){this.__sendPacket=a;this.__ledMatrix=new CheeseHatColorLedMatrix(10,5);this.__buttonCheckerA=new CheeseButtonChecker;this.__buttonCheckerB=new CheeseButtonChecker;this.reset()}CheeseHat010.prototype.reset=function(){this.__waiting=!1;this.__buttonB=this.__buttonA=this.__requestPrevId=this.__requestId=0;this.__ledMatrix.reset();this.__buttonCheckerA.reset();this.__buttonCheckerB.reset()};CheeseHat010.prototype.clearEvent=function(){this.__buttonCheckerA.clearEvent();this.__buttonCheckerB.clearEvent()};
CheeseHat010.prototype.getPacket=function(){return this.__ledMatrix.getPacket()};CheeseHat010.prototype.getLedMatrix=function(){return this.__ledMatrix};CheeseHat010.prototype.getButtonA=function(){return this.__buttonA};CheeseHat010.prototype.getButtonB=function(){return this.__buttonB};CheeseHat010.prototype.isButtonAClicked=function(){return this.__buttonCheckerA.isClicked()};CheeseHat010.prototype.isButtonBClicked=function(){return this.__buttonCheckerB.isClicked()};
CheeseHat010.prototype.isButtonALongPressed=function(){return this.__buttonCheckerA.isLongPressed()};CheeseHat010.prototype.isButtonBLongPressed=function(){return this.__buttonCheckerB.isLongPressed()};CheeseHat010.prototype.issueMatrixUpdate=function(){this.__ledMatrix.update();this.__requestId=this.__requestId%255+1};CheeseHat010.prototype.handleSensory=function(a){this.__buttonA=1-a[2];this.__buttonB=1-a[3];this.__buttonCheckerA.check(1==this.__buttonA);this.__buttonCheckerB.check(1==this.__buttonB)};
CheeseHat010.prototype.handleRequest=function(a){this.__waiting&&a&&(this.__waiting=!1);this.__waiting||this.__requestId==this.__requestPrevId||(this.__requestPrevId=this.__requestId,(a=this.__ledMatrix.getPacket())&&this.__sendPacket(a))};function CheeseHat(a){this.__sendPacket=a;this.__id=-1;this.__hat=void 0}CheeseHat.prototype.__createHat=function(a){this.__hat=void 0;switch(a){case 10:this.__hat=new CheeseHat010(this.__sendPacket)}this.__hat&&(this.__id=a);return this.__hat};
CheeseHat.prototype.getHat=function(a){if(a==this.__id)return this.__hat};CheeseHat.prototype.reset=function(){this.__hat&&this.__hat.reset();this.__id=-1;this.__hat=void 0};CheeseHat.prototype.start=function(a){var b=this.getHat(a);b||(b=this.__createHat(a))&&this.__sendPacket(b.getPacket())};CheeseHat.prototype.end=function(){var a=this.__hat;this.reset();a&&this.__sendPacket(a.getPacket())};CheeseHat.prototype.clearEvent=function(){this.__hat&&this.__hat.clearEvent()};
CheeseHat.prototype.handleSensory=function(a){a&&32==(a[0]&240)&&((a[1]&255)<<4|a[0]&15)==this.__id&&this.__hat&&this.__hat.handleSensory(a)};CheeseHat.prototype.handleRequest=function(a){this.__hat&&this.__hat.handleRequest&&this.__hat.handleRequest(a)};
function Cheese(a){var b=this;b.sensory={map:0,signalStrength:0,accelerationX:0,accelerationY:0,accelerationZ:0,internalTemperature:0,inputSa:0,inputSb:0,inputSc:0,inputLa:0,inputLb:0,inputLc:0,tilt:0,stepCount:0,batteryState:2,hat:void 0,pid:void 0};b.motoring={module:"cheese",index:a,map:4292870144,outputSa:0,outputSb:0,outputSc:0,outputLa:0,outputLb:0,outputLc:0,outputMab:0,outputMcd:0,buzzer:0,velocity:0,step:0,note:0,sound:0,modeSa:0,modeSb:0,modeSc:0,modeLa:0,modeLb:0,modeLc:0,modeMab:0,modeMcd:0,
modePid:0,modeExt:0,hat:void 0,pid:void 0,neopixel:void 0};b.blockId=0;b.stepMode=144;b.stepCallback=void 0;b.currentSound=0;b.soundRepeat=1;b.soundCallback=void 0;b.noteId=0;b.noteTimer1=void 0;b.noteTimer2=void 0;b.writeSerialCallbacks=[];b.readSerialCallbacks=[];b.serialMode=0;b.serialHusky=void 0;b.serialInput="";b.serialDelimiter=0;b.serialPin=2;b.serialRate=0;b.serialSendId=0;b.serialRecvId=-1;b.neopixelCallback=void 0;b.neopixelIdleCallbacks=[];b.pulseSc=!1;b.pulseLc=!1;b.freeFall=!1;b.tap=
!1;b.modeMab=0;b.resetEncoderFlag=0;b.tempo=60;b.range=new CheeseRange;b.buttonCounter=new CheeseButtonCounter;b.buttonChecker={};b.leds={S:new CheeseLed("S"),L:new CheeseLed("L")};b.pid=new CheesePid;b.hat=new CheeseHat(function(a){a&&(b.motoring.hat=a,b.__issueHat())});b.neopixel=new CheeseNeopixel;b.writeQueue=new RoboidWriteQueue(64);b.readQueue=new RoboidReadQueue(64);b.timeouts=[]}
Cheese.prototype.reset=function(){var a=this.motoring;a.map=4294967040;a.outputSa=0;a.outputSb=0;a.outputSc=0;a.outputLa=0;a.outputLb=0;a.outputLc=0;a.outputMab=0;a.outputMcd=0;a.buzzer=0;a.velocity=0;a.step=0;a.note=0;a.sound=0;a.modeSa=0;a.modeSb=0;a.modeSc=0;a.modeLa=0;a.modeLb=0;a.modeLc=0;a.modeMab=0;a.modeMcd=0;a.modePid=0;a.modeExt=0;a.hat=void 0;a.pid=void 0;a.neopixel=void 0;this.blockId=0;this.stepMode=144;this.stepCallback=void 0;this.currentSound=0;this.soundRepeat=1;this.soundCallback=
void 0;this.noteId=0;this.noteTimer2=this.noteTimer1=void 0;this.writeSerialCallbacks=[];this.readSerialCallbacks=[];this.serialMode=0;this.serialHusky=void 0;this.serialInput="";this.serialDelimiter=0;this.serialPin=2;this.serialRate=0;this.serialRecvId=-1;this.neopixelCallback=void 0;this.neopixelIdleCallbacks=[];this.tap=this.freeFall=this.pulseLc=this.pulseSc=!1;this.modeMab=0;this.tempo=60;this.range.reset();this.buttonCounter.reset();this.buttonChecker={};for(var b in this.leds)this.leds[b].reset();
this.pid.reset();this.hat.end();this.__cancelNeopixel();this.__setNeopixel(this.neopixel.end());this.__removeAllTimeouts();this.writeQueue.reset();this.readQueue.reset()};Cheese.prototype.__removeTimeout=function(a){clearTimeout(a);a=this.timeouts.indexOf(a);0<=a&&this.timeouts.splice(a,1)};Cheese.prototype.__removeAllTimeouts=function(){var a=this.timeouts,b;for(b in a)clearTimeout(a[b]);this.timeouts=[]};
Cheese.prototype.__fireWriteSerialCallbacks=function(){var a=this.writeSerialCallbacks,b;for(b in a)a[b]();this.writeSerialCallbacks=[]};Cheese.prototype.__fireReadSerialCallbacks=function(){var a=this.readSerialCallbacks,b;for(b in a)a[b]();this.readSerialCallbacks=[]};Cheese.prototype.clearMotoring=function(){this.motoring.map=4292870144};
Cheese.prototype.clearEvent=function(){this.tap=this.freeFall=this.pulseLc=this.pulseSc=!1;var a,b;for(b in this.buttonChecker)(a=this.buttonChecker[b])&&a.clearEvent();this.pid.clearEvent();this.hat.clearEvent()};Cheese.prototype.__setStep=function(a){this.motoring.step=a;this.motoring.map|=1048576};Cheese.prototype.__cancelStep=function(){this.stepCallback=void 0};Cheese.prototype.__setNote=function(a){this.motoring.note=a;this.motoring.map|=524288};
Cheese.prototype.__issueNoteId=function(){return this.noteId=this.blockId=this.blockId%65535+1};Cheese.prototype.__cancelNote=function(){this.noteId=0;void 0!==this.noteTimer1&&this.__removeTimeout(this.noteTimer1);void 0!==this.noteTimer2&&this.__removeTimeout(this.noteTimer2);this.noteTimer2=this.noteTimer1=void 0};Cheese.prototype.__setSound=function(a){this.motoring.sound=a;this.motoring.map|=262144};
Cheese.prototype.__runSound=function(a,b){"number"!=typeof b&&(b=1);0>b&&(b=-1);b&&(this.currentSound=a,this.soundRepeat=b,this.__setSound(a))};Cheese.prototype.__cancelSound=function(){this.soundCallback=void 0};Cheese.prototype.__setModeSa=function(a){this.motoring.modeSa=a;this.motoring.map|=131072};Cheese.prototype.__setModeSb=function(a){this.motoring.modeSb=a;this.motoring.map|=65536};Cheese.prototype.__setModeSc=function(a){this.motoring.modeSc=a;this.motoring.map|=32768};
Cheese.prototype.__setModeLa=function(a){this.motoring.modeLa=a;this.motoring.map|=16384};Cheese.prototype.__setModeLb=function(a){this.motoring.modeLb=a;this.motoring.map|=8192};Cheese.prototype.__setModeLc=function(a){this.motoring.modeLc=a;this.motoring.map|=4096};Cheese.prototype.__setModeMab=function(a){this.modeMab=a;this.motoring.modeMab=a;this.motoring.map|=2048};Cheese.prototype.__setModeMcd=function(a){this.motoring.modeMcd=a;this.motoring.map|=1024};
Cheese.prototype.__setModePid=function(a){this.motoring.modePid=a;this.motoring.map|=512};Cheese.prototype.__setSerialModePid=function(){this.motoring.outputLa=(this.serialPin&3)<<4|this.serialRate&7;this.__setModeLa(255);this.__setModePid(3)};Cheese.prototype.__setModeExt=function(a){this.motoring.modeExt=a;this.motoring.map|=256};Cheese.prototype.__issueHat=function(){this.motoring.map|=8};
Cheese.prototype.__getOrCreatePidArray=function(a){if(void 0==a.pid){a.pid=Array(20);for(var b=0;20>b;++b)a.pid[b]=0}return a.pid};Cheese.prototype.__issuePid=function(){this.motoring.map|=4};Cheese.prototype.__setSerial=function(a){var b=this.__getOrCreatePidArray(this.motoring);this.serialSendId=this.serialSendId%15+1;b[0]=48|this.serialSendId&15;for(var c=1,d=0;20>c;++c,++d)b[c]=a[d];this.__issuePid()};Cheese.prototype.__setNeopixel=function(a){this.__setModeSa(8);this.motoring.neopixel=a;this.__issueNeopixel()};
Cheese.prototype.__issueNeopixel=function(){this.motoring.map|=2};Cheese.prototype.__cancelNeopixel=function(){this.neopixelCallback=void 0};Cheese.prototype.__isNeopixelIdle=function(){return void 0===this.neopixelCallback};
Cheese.prototype.handleSensory=function(){var a=this.sensory;a.map&2097152&&(this.pulseSc=!0);a.map&1048576&&(this.pulseLc=!0);a.map&524288&&(this.freeFall=!0);a.map&262144&&(this.tap=!0);if(this.stepCallback&&0!=(a.map&32768)){this.motoring.velocity=0;var b=this.stepCallback;this.__cancelStep();b&&b()}0!=(a.map&16384)&&(0<this.currentSound?0>this.soundRepeat?this.__runSound(this.currentSound,-1):1<this.soundRepeat?(this.soundRepeat--,this.__runSound(this.currentSound,this.soundRepeat)):(this.currentSound=
0,this.soundRepeat=1,b=this.soundCallback,this.__cancelSound(),b&&b()):(this.currentSound=0,this.soundRepeat=1,b=this.soundCallback,this.__cancelSound(),b&&b()));this.buttonCounter.tick();for(var c in this.buttonChecker)(b=this.buttonChecker[c])&&(this.buttonCounter.isCounting(c)?b.check(!1):b.check(1==a["input"+c]));if(a.map&256&&(c=a.pid)&&48==(c[0]&240))if(b=c[0]&15,3==this.motoring.modePid){var d=this.serialRecvId;this.serialRecvId=b;b!=d&&-1!=d&&(0==this.serialMode?this.readQueue.push(c,1):1==
this.serialMode&&this.serialHusky&&this.serialHusky.push(c))}else 0<b&&this.pid.handleSensory(this.motoring.modePid,c);a.map&512&&this.hat.handleSensory(a.hat);c=!1;a.map&4096&&(c=!0);this.hat.handleRequest(c);a.map&2048&&(c=this.writeQueue.pop(),3==this.motoring.modePid&&(c?this.__setSerial(c):this.__fireWriteSerialCallbacks()));a.map&1024&&(a=this.neopixelCallback,this.__cancelNeopixel(),a&&a());0<this.readSerialCallbacks.length&&(a=this.readQueue.pop(this.serialDelimiter))&&3==this.motoring.modePid&&
(this.serialInput=a,this.__fireReadSerialCallbacks());0<this.neopixelIdleCallbacks.length&&this.__isNeopixelIdle()&&(a=this.neopixelIdleCallbacks.shift())&&a()};Cheese.prototype.getSensorValue=function(a){switch(a){case "x acceleration":return this.sensory.accelerationX;case "y acceleration":return this.sensory.accelerationY;case "z acceleration":return this.sensory.accelerationZ;case "signal strength (dBm)":return this.sensory.signalStrength}return 0};
Cheese.prototype.checkTilt=function(a){switch(a){case "port S in sky direction":return 1==this.sensory.tilt;case "port S in earth direction":return-1==this.sensory.tilt;case "power switch in sky direction":return 2==this.sensory.tilt;case "power switch in earth direction":return-2==this.sensory.tilt;case "logo in earth direction":return 3==this.sensory.tilt;case "logo in sky direction":return-3==this.sensory.tilt;case "tap":return this.tap;case "free fall":return this.freeFall}return!1};
Cheese.prototype.__BATTERY_STATES={normal:2,low:1,empty:0};Cheese.prototype.checkBattery=function(a){return this.sensory.batteryState===this.__BATTERY_STATES[a]};Cheese.prototype.__SOUNDS={beep:1,"random beep":2,noise:10,siren:3,engine:4,chop:11,robot:5,dibidibidip:8,"good job":9,happy:12,angry:13,sad:14,sleep:15,march:6,birthday:7};
Cheese.prototype.playSound=function(a,b){this.__cancelNote();this.__cancelSound();a=this.__SOUNDS[a];b=parseInt(b);this.motoring.buzzer=0;this.__setNote(0);a&&b?this.__runSound(a,b):this.__runSound(0)};Cheese.prototype.playSoundUntil=function(a,b,c){this.__cancelNote();this.__cancelSound();a=this.__SOUNDS[a];b=parseInt(b);this.motoring.buzzer=0;this.__setNote(0);a&&b?(this.__runSound(a,b),this.soundCallback=c):(this.__runSound(0),c())};
Cheese.prototype.changeBuzzer=function(a){this.__cancelNote();this.__cancelSound();a=parseFloat(a);"number"==typeof a&&(this.motoring.buzzer+=a);this.__setNote(0);this.__runSound(0)};Cheese.prototype.setBuzzer=function(a){this.__cancelNote();this.__cancelSound();a=parseFloat(a);"number"==typeof a&&(this.motoring.buzzer=a);this.__setNote(0);this.__runSound(0)};Cheese.prototype.clearSound=function(){this.__cancelNote();this.__cancelSound();this.motoring.buzzer=0;this.__setNote(0);this.__runSound(0)};
Cheese.prototype.__NOTES={C:4,"C\u266f (D\u266d)":5,D:6,"D\u266f (E\u266d)":7,E:8,F:9,"F\u266f (G\u266d)":10,G:11,"G\u266f (A\u266d)":12,A:13,"A\u266f (B\u266d)":14,B:15};Cheese.prototype.playNote=function(a,b){this.__cancelNote();this.__cancelSound();a=this.__NOTES[a];b=parseInt(b);this.motoring.buzzer=0;a&&b&&0<b&&8>b?this.__setNote(a+12*(b-1)):this.__setNote(0);this.__runSound(0)};
Cheese.prototype.playNoteBeat=function(a,b,c,d){var e=this;e.__cancelNote();e.__cancelSound();a=this.__NOTES[a];b=parseInt(b);c=parseFloat(c);e.motoring.buzzer=0;if(a&&b&&0<b&&8>b&&c&&0<c&&0<e.tempo){var f=e.__issueNoteId();e.__setNote(a+12*(b-1));a=6E4*c/e.tempo;b=100<a?100:0;0<b&&(e.noteTimer1=setTimeout(function(){e.noteId==f&&(e.__setNote(0),void 0!==e.noteTimer1&&e.__removeTimeout(e.noteTimer1),e.noteTimer1=void 0)},a-b),e.timeouts.push(e.noteTimer1));e.noteTimer2=setTimeout(function(){e.noteId==
f&&(e.__setNote(0),e.__cancelNote(),d())},a);e.timeouts.push(e.noteTimer2);e.__runSound(0)}else e.__setNote(0),e.__runSound(0),d()};Cheese.prototype.restBeat=function(a,b){var c=this;c.__cancelNote();c.__cancelSound();a=parseFloat(a);c.motoring.buzzer=0;c.__setNote(0);c.__runSound(0);if(a&&0<a&&0<c.tempo){var d=c.__issueNoteId();c.noteTimer1=setTimeout(function(){c.noteId==d&&(c.__cancelNote(),b())},6E4*a/c.tempo);c.timeouts.push(c.noteTimer1)}else b()};
Cheese.prototype.changeTempo=function(a){a=parseFloat(a);"number"==typeof a&&(this.tempo+=a,1>this.tempo&&(this.tempo=1))};Cheese.prototype.setTempo=function(a){a=parseFloat(a);"number"==typeof a&&(this.tempo=a,1>this.tempo&&(this.tempo=1))};Cheese.prototype.setSoundPort=function(a){this.motoring.modeMab="internal speaker"==a?this.modeMab:3;this.motoring.map|=2048};
Cheese.prototype.__INPUT_SL_MODES={makey:0,button:144,"digital (pull up)":16,"digital (pull down)":32,pulse:4,"pulse (pull up)":20,"pulse (pull down)":36,analog:1,voltage:193};
Cheese.prototype.setInputMode=function(a,b){b=this.__INPUT_SL_MODES[b];144==b?(this.buttonCounter.setCount(a,10),this.buttonChecker[a]=new CheeseButtonChecker):this.buttonCounter.setCount(a,0);switch(a){case "Sa":this.__setModeSa(b);break;case "Sb":this.__setModeSb(b);break;case "Sc":this.__setModeSc(b);break;case "La":this.__setModeLa(b);break;case "Lb":this.__setModeLb(b);break;case "Lc":this.__setModeLc(b)}};
Cheese.prototype.setInputRange=function(a,b,c,d,e,f){b=parseFloat(b);c=parseFloat(c);d=parseFloat(d);e=parseFloat(e);"number"==typeof b&&"number"==typeof c&&"number"==typeof d&&"number"==typeof e&&this.range.setLowHigh(a,b,c,d,e,"with"==f)};
Cheese.prototype.setThreeInputRanges=function(a,b,c,d,e,f,g,h){b=parseFloat(b);c=parseFloat(c);d=parseFloat(d);e=parseFloat(e);f=parseFloat(f);g=parseFloat(g);"number"==typeof b&&"number"==typeof c&&"number"==typeof d&&"number"==typeof e&&"number"==typeof f&&"number"==typeof g&&this.range.setLowMidHigh(a,b,c,d,e,f,g,"with"==h)};Cheese.prototype.__PORT_TO_INPUTS={Sa:"inputSa",Sb:"inputSb",Sc:"inputSc",La:"inputLa",Lb:"inputLb",Lc:"inputLc"};
Cheese.prototype.getAnalogInput=function(a){var b=this.__PORT_TO_INPUTS[a];return b?(b=this.sensory[b],this.buttonCounter.isCounting(a)&&(b=0),this.range.calc(a,b)):0};Cheese.prototype.checkDigitalInput=function(a,b){var c=this.__PORT_TO_INPUTS[a];return c?(c=this.sensory[c],this.buttonCounter.isCounting(a)&&(c=0),c===parseInt(b)):!1};
Cheese.prototype.checkButtonState=function(a,b){if(this.buttonCounter.isCounting(a))return!1;var c=this.buttonChecker[a];if(c)switch(b){case "clicked":return c.isClicked();case "long-pressed":return c.isLongPressed()}return!1};Cheese.prototype.checkPulseInput=function(a){switch(a){case "Sc":return this.pulseSc;case "Lc":return this.pulseLc}return!1};
Cheese.prototype.__PORT_TO_OUTPUTS={Sa:"outputSa",Sb:"outputSb",Sc:"outputSc",La:"outputLa",Lb:"outputLb",Lc:"outputLc","Ma(-)b":"outputMab","Mc(-)d":"outputMcd","Ma(-)b(+)c":"outputMab",Mab:"outputMab",Mcd:"outputMcd","high current Ma(-)b":"outputMab","high current Mc(-)d":"outputMcd"};
Cheese.prototype.__setDigitalOutputMode=function(a){switch(a){case "Sa":this.__setModeSa(130);break;case "Sb":this.__setModeSb(130);break;case "Sc":this.__setModeSc(130);break;case "La":this.__setModeLa(130);break;case "Lb":this.__setModeLb(130);break;case "Lc":this.__setModeLc(130);break;case "high current Ma(-)b":this.__setModeMab(0);break;case "high current Mc(-)d":this.__setModeMcd(0)}};
Cheese.prototype.setDigitalOutput=function(a,b){var c=this.__PORT_TO_OUTPUTS[a];c&&(b=parseInt(b),"number"==typeof b&&(this.__setDigitalOutputMode(a),this.motoring[c]=b))};Cheese.prototype.__setPwmOutputMode=function(a){switch(a){case "Sa":this.__setModeSa(2);break;case "Sb":this.__setModeSb(2);break;case "Sc":this.__setModeSc(2);break;case "La":this.__setModeLa(2);break;case "Lb":this.__setModeLb(2);break;case "Lc":this.__setModeLc(2)}};
Cheese.prototype.changePwmOutput=function(a,b){var c=this.__PORT_TO_OUTPUTS[a];c&&(b=parseFloat(b),"number"==typeof b&&(b+=this.motoring[c],this.__setPwmOutputMode(a),this.motoring[c]=b))};Cheese.prototype.setPwmOutput=function(a,b){var c=this.__PORT_TO_OUTPUTS[a];c&&(b=parseFloat(b),"number"==typeof b&&(this.__setPwmOutputMode(a),this.motoring[c]=b))};
Cheese.prototype.__setServoMotorMode=function(a){switch(a){case "Sa":this.__setModeSa(3);break;case "Sb":this.__setModeSb(3);break;case "Sc":this.__setModeSc(3);break;case "La":this.__setModeLa(3);break;case "Lb":this.__setModeLb(3);break;case "Lc":this.__setModeLc(3);break;case "Ma(-)b":this.__setModeMab(2);break;case "Mc(-)d":this.__setModeMcd(2);break;case "Ma(-)b(+)c":this.__setModeMab(64)}};
Cheese.prototype.changeServoMotorAngle=function(a,b){var c=this.__PORT_TO_OUTPUTS[a];c&&(b=parseFloat(b),"number"==typeof b&&(b+=this.motoring[c],1>b?b=1:180<b&&(b=180),this.__setServoMotorMode(a),this.motoring[c]=b))};Cheese.prototype.setServoMotorAngle=function(a,b){var c=this.__PORT_TO_OUTPUTS[a];c&&(b=parseFloat(b),"number"==typeof b&&(1>b?b=1:180<b&&(b=180),this.__setServoMotorMode(a),this.motoring[c]=b))};
Cheese.prototype.turnOffServoMotor=function(a){var b=this.__PORT_TO_OUTPUTS[a];b&&(this.__setServoMotorMode(a),this.motoring[b]=0)};Cheese.prototype.__setDcMotorMode=function(a){switch(a){case "Mab":this.__setModeMab(1);break;case "Mcd":this.__setModeMcd(1)}};Cheese.prototype.changeDcMotorVelocity=function(a,b){var c=this.__PORT_TO_OUTPUTS[a];c&&(b=parseFloat(b),"number"==typeof b&&(b+=this.motoring[c],-100>b?b=-100:100<b&&(b=100),this.__setDcMotorMode(a),this.motoring[c]=b))};
Cheese.prototype.setDcMotorVelocity=function(a,b){var c=this.__PORT_TO_OUTPUTS[a];c&&(b=parseFloat(b),"number"==typeof b&&(-100>b?b=-100:100<b&&(b=100),this.__setDcMotorMode(a),this.motoring[c]=b))};Cheese.prototype.stopDcMotor=function(a){var b=this.__PORT_TO_OUTPUTS[a];b&&(this.__setDcMotorMode(a),this.motoring[b]=0)};
Cheese.prototype.rotateStepMotor=function(a,b,c){this.__cancelStep();this.__setModeMab(this.stepMode);a=parseInt(a);b=parseFloat(b);"number"==typeof a&&"number"==typeof b?(-500>b?b=-500:500<b&&(b=500),this.motoring.velocity=b,this.__setStep(a),this.stepCallback=c):(this.motoring.velocity=0,this.__setStep(0),c())};
Cheese.prototype.changeStepMotorVelocity=function(a){this.__cancelStep();this.__setModeMab(this.stepMode);a=parseFloat(a);"number"==typeof a&&(a+=this.motoring.velocity,-500>a?a=-500:500<a&&(a=500),this.motoring.velocity=a);this.__setStep(0)};Cheese.prototype.setStepMotorVelocity=function(a){this.__cancelStep();this.__setModeMab(this.stepMode);a=parseFloat(a);"number"==typeof a&&(-500>a?a=-500:500<a&&(a=500),this.motoring.velocity=a);this.__setStep(0)};
Cheese.prototype.stopOffStepMotor=function(a){this.__cancelStep();"stop"==a?this.__setModeMab(this.stepMode):this.__setModeMab(128);this.motoring.velocity=0;this.__setStep(0)};Cheese.prototype.__MODE_STEP_MOTORS={normal:144,power:160};Cheese.prototype.setStepMotorMode=function(a){a=this.__MODE_STEP_MOTORS[a];"number"==typeof a&&(this.stepMode=a,this.__setModeMab(a))};Cheese.prototype.getStepCount=function(){return this.sensory.stepCount};
Cheese.prototype.__RGB_COLORS={dark:{red:[15,0,0],orange:[15,3,0],yellow:[15,15,0],green:[0,15,0],"sky blue":[0,15,15],blue:[0,0,15],violet:[3,0,15],purple:[15,0,15],white:[15,15,15]},normal:{red:[63,0,0],orange:[63,15,0],yellow:[63,63,0],green:[0,63,0],"sky blue":[0,63,63],blue:[0,0,63],violet:[15,0,63],purple:[63,0,63],white:[63,63,63]},bright:{red:[255,0,0],orange:[255,63,0],yellow:[255,255,0],green:[0,255,0],"sky blue":[0,255,255],blue:[0,0,255],violet:[63,0,255],purple:[255,0,255],white:[255,
255,255]}};Cheese.prototype.__setLedMode=function(a){switch(a){case "S":this.__setModeSa(2);this.__setModeSb(2);this.__setModeSc(2);break;case "L":this.__setModeLa(2),this.__setModeLb(2),this.__setModeLc(2)}};
Cheese.prototype.__setLedRgb=function(a,b,c,d){var e=this.leds[a];e&&(e.setRgb(b,c,d),b=parseInt(100*b/255),c=parseInt(100*c/255),d=parseInt(100*d/255),0>b?b=0:100<b&&(b=100),0>c?c=0:100<c&&(c=100),0>d?d=0:100<d&&(d=100),e.isAnode()&&(b=100-b,c=100-c,d=100-d),this.__setLedMode(a),(a=this.__PORT_TO_OUTPUTS[e.getPortR()])&&(this.motoring[a]=b),(a=this.__PORT_TO_OUTPUTS[e.getPortG()])&&(this.motoring[a]=c),(a=this.__PORT_TO_OUTPUTS[e.getPortB()])&&(this.motoring[a]=d))};
Cheese.prototype.setLedColor=function(a,b,c){(b=this.__RGB_COLORS[b][c])&&this.__setLedRgb(a,b[0],b[1],b[2])};Cheese.prototype.setLedRgbArray=function(a,b){b&&this.__setLedRgb(a,b[0],b[1],b[2])};Cheese.prototype.changeLedRgb=function(a,b,c,d){var e=this.leds[a];e&&(b=parseInt(b),c=parseInt(c),d=parseInt(d),"number"==typeof b&&"number"==typeof c&&"number"==typeof d&&(b+=e.getR(),c+=e.getG(),d+=e.getB(),0>b?b=0:255<b&&(b=255),0>c?c=0:255<c&&(c=255),0>d?d=0:255<d&&(d=255),this.__setLedRgb(a,b,c,d)))};
Cheese.prototype.setLedRgb=function(a,b,c,d){b=parseInt(b);c=parseInt(c);d=parseInt(d);"number"==typeof b&&"number"==typeof c&&"number"==typeof d&&(0>b?b=0:255<b&&(b=255),0>c?c=0:255<c&&(c=255),0>d?d=0:255<d&&(d=255),this.__setLedRgb(a,b,c,d))};Cheese.prototype.clearLed=function(a){this.__setLedRgb(a,0,0,0)};Cheese.prototype.setLedType=function(a,b){var c=this.leds[a];c&&c.setType(b)};
Cheese.prototype.__refreshNeopixel=function(a){var b=this.neopixel.getPacket();b?(this.__setNeopixel(b),this.neopixelCallback=a):a()};Cheese.prototype.__NEOPIXEL_TYPES={GRB:0,GRBW:1};Cheese.prototype.neopixelSetNumberAndType=function(a,b,c){var d=this;d.neopixelIdleCallbacks.push(function(){a=parseInt(a);b=d.__NEOPIXEL_TYPES[b];"number"==typeof a&&"number"==typeof b?(d.neopixel.setNumLeds(a),d.neopixel.setType(b),d.neopixel.clearAll(),d.__refreshNeopixel(c)):c()})};
Cheese.prototype.neopixelSetAllColor=function(a,b){var c=this;c.neopixelIdleCallbacks.push(function(){var d=c.__RGB_COLORS.bright[a];d?(c.neopixel.setAllRgb(d[0],d[1],d[2]),c.__refreshNeopixel(b)):b()})};Cheese.prototype.neopixelSetAllRgbArray=function(a,b){var c=this;c.neopixelIdleCallbacks.push(function(){a?(c.neopixel.setAllRgb(a[0],a[1],a[2]),c.__refreshNeopixel(b)):b()})};
Cheese.prototype.neopixelChangeAllRgb=function(a,b,c,d){var e=this;e.neopixelIdleCallbacks.push(function(){a=parseInt(a);b=parseInt(b);c=parseInt(c);"number"==typeof a&&"number"==typeof b&&"number"==typeof c?(e.neopixel.changeAllRgb(a,b,c),e.__refreshNeopixel(d)):d()})};
Cheese.prototype.neopixelSetAllRgb=function(a,b,c,d){var e=this;e.neopixelIdleCallbacks.push(function(){a=parseInt(a);b=parseInt(b);c=parseInt(c);"number"==typeof a&&"number"==typeof b&&"number"==typeof c?(e.neopixel.setAllRgb(a,b,c),e.__refreshNeopixel(d)):d()})};
Cheese.prototype.__NEOPIXEL_PATTERNS={"red to green":128,"red to blue":129,"red to white":130,"red getting darker":131,"green to blue":132,"green to red":133,"green to white":134,"green getting darker":135,"blue to red":136,"blue to green":137,"blue to white":138,"blue getting darker":139,"white to red":140,"white to green":141,"white to blue":142,"white getting darker":143,"red getting brighter":144,"green getting brighter":145,"blue getting brighter":146,"white getting brighter":147,"3 colors":192,
"6 colors":193,"12 colors":194};Cheese.prototype.neopixelSetAllPattern=function(a,b){var c=this;c.neopixelIdleCallbacks.push(function(){a=c.__NEOPIXEL_PATTERNS[a];"number"==typeof a?(c.neopixel.setAllPattern(a),c.__refreshNeopixel(b)):b()})};Cheese.prototype.neopixelClearAll=function(a){var b=this;b.neopixelIdleCallbacks.push(function(){b.neopixel.clearAll();b.__refreshNeopixel(a)})};
Cheese.prototype.neopixelSetLedColor=function(a,b,c){var d=this;d.neopixelIdleCallbacks.push(function(){a=parseInt(a);var e=d.__RGB_COLORS.bright[b];"number"==typeof a&&e?d.neopixel.setRgbAt(a-1,e[0],e[1],e[2])?d.__refreshNeopixel(c):c():c()})};Cheese.prototype.neopixelSetLedRgbArray=function(a,b,c){var d=this;d.neopixelIdleCallbacks.push(function(){a=parseInt(a);"number"==typeof a&&b?d.neopixel.setRgbAt(a-1,b[0],b[1],b[2])?d.__refreshNeopixel(c):c():c()})};
Cheese.prototype.neopixelChangeLedRgb=function(a,b,c,d,e){var f=this;f.neopixelIdleCallbacks.push(function(){a=parseInt(a);b=parseInt(b);c=parseInt(c);d=parseInt(d);"number"==typeof a&&"number"==typeof b&&"number"==typeof c&&"number"==typeof d?f.neopixel.changeRgbAt(a-1,b,c,d)?f.__refreshNeopixel(e):e():e()})};
Cheese.prototype.neopixelSetLedRgb=function(a,b,c,d,e){var f=this;f.neopixelIdleCallbacks.push(function(){a=parseInt(a);b=parseInt(b);c=parseInt(c);d=parseInt(d);"number"==typeof a&&"number"==typeof b&&"number"==typeof c&&"number"==typeof d?f.neopixel.setRgbAt(a-1,b,c,d)?f.__refreshNeopixel(e):e():e()})};Cheese.prototype.neopixelClearLed=function(a,b){var c=this;c.neopixelIdleCallbacks.push(function(){a=parseInt(a);"number"==typeof a?c.neopixel.clearAt(a-1)?c.__refreshNeopixel(b):b():b()})};
Cheese.prototype.neopixelSetRangeColor=function(a,b,c,d,e){var f=this;f.neopixelIdleCallbacks.push(function(){a=parseInt(a);b=parseInt(b);c=parseInt(c);var g=f.__RGB_COLORS.bright[d];"number"==typeof a&&"number"==typeof b&&"number"==typeof c&&g?f.neopixel.setRgbFromTo(a-1,b-1,c,g[0],g[1],g[2])?f.__refreshNeopixel(e):e():e()})};
Cheese.prototype.neopixelSetRangeRgbArray=function(a,b,c,d,e){var f=this;f.neopixelIdleCallbacks.push(function(){a=parseInt(a);b=parseInt(b);c=parseInt(c);"number"==typeof a&&"number"==typeof b&&"number"==typeof c&&d?f.neopixel.setRgbFromTo(a-1,b-1,c,d[0],d[1],d[2])?f.__refreshNeopixel(e):e():e()})};
Cheese.prototype.neopixelChangeRangeRgb=function(a,b,c,d,e,f,g){var h=this;h.neopixelIdleCallbacks.push(function(){a=parseInt(a);b=parseInt(b);c=parseInt(c);d=parseInt(d);e=parseInt(e);f=parseInt(f);"number"==typeof a&&"number"==typeof b&&"number"==typeof c&&"number"==typeof d&&"number"==typeof e&&"number"==typeof f?h.neopixel.changeRgbFromTo(a-1,b-1,c,d,e,f)?h.__refreshNeopixel(g):g():g()})};
Cheese.prototype.neopixelSetRangeRgb=function(a,b,c,d,e,f,g){var h=this;h.neopixelIdleCallbacks.push(function(){a=parseInt(a);b=parseInt(b);c=parseInt(c);d=parseInt(d);e=parseInt(e);f=parseInt(f);"number"==typeof a&&"number"==typeof b&&"number"==typeof c&&"number"==typeof d&&"number"==typeof e&&"number"==typeof f?h.neopixel.setRgbFromTo(a-1,b-1,c,d,e,f)?h.__refreshNeopixel(g):g():g()})};
Cheese.prototype.neopixelSetRangePattern=function(a,b,c,d){var e=this;e.neopixelIdleCallbacks.push(function(){a=parseInt(a);b=parseInt(b);c=e.__NEOPIXEL_PATTERNS[c];"number"==typeof a&&"number"==typeof b&&"number"==typeof c?e.neopixel.setPatternFromTo(a-1,b-1,c)?e.__refreshNeopixel(d):d():d()})};
Cheese.prototype.neopixelClearRange=function(a,b,c,d){var e=this;e.neopixelIdleCallbacks.push(function(){a=parseInt(a);b=parseInt(b);c=parseInt(c);"number"==typeof a&&"number"==typeof b&&"number"==typeof c?e.neopixel.clearFromTo(a-1,b-1,c)?e.__refreshNeopixel(d):d():d()})};Cheese.prototype.neopixelShift=function(a,b){var c=this;c.neopixelIdleCallbacks.push(function(){a=parseInt(a);"number"==typeof a?c.neopixel.shiftAll(a)?c.__refreshNeopixel(b):b():b()})};
Cheese.prototype.neopixelRotate=function(a,b){var c=this;c.neopixelIdleCallbacks.push(function(){a=parseInt(a);"number"==typeof a?c.neopixel.rotateAll(a)?c.__refreshNeopixel(b):b():b()})};Cheese.prototype.neopixelChangeBrightness=function(a,b){var c=this;c.neopixelIdleCallbacks.push(function(){a=parseInt(a);"number"==typeof a?(c.neopixel.changeBrightnessBy(a),c.__refreshNeopixel(b)):b()})};
Cheese.prototype.neopixelSetBrightness=function(a,b){var c=this;c.neopixelIdleCallbacks.push(function(){a=parseInt(a);"number"==typeof a?(c.neopixel.setBrightnessTo(a),c.__refreshNeopixel(b)):b()})};Cheese.prototype.writeSerial=function(a,b,c){this.__setSerialModePid();var d=this.writeQueue;d.push(b,"string"!=a);(a=d.pop())?(this.writeSerialCallbacks.push(c),this.__setSerial(a)):c()};
Cheese.prototype.__SERIAL_DELIMITERS={all:0,"until new line":13,"until ,(comma)":44,"until :(colon)":58,"until $":36,"until #":35};Cheese.prototype.readSerialUntil=function(a,b){this.__setSerialModePid();a=this.__SERIAL_DELIMITERS[a];"number"==typeof a?(this.serialDelimiter=a,this.readSerialCallbacks.push(b)):b()};Cheese.prototype.__SERIAL_PORTS={"La(write) Lb(read)":2,"La(read) Lb(write)":3,"La(write)":0,"La(read)":1};
Cheese.prototype.setSerialPort=function(a){a=this.__SERIAL_PORTS[a];"number"==typeof a&&(this.serialPin=a,this.__setSerialModePid())};Cheese.prototype.__SERIAL_BAUDS={9600:0,14400:1,19200:2,28800:3,38400:4,57600:5,76800:6,115200:7};Cheese.prototype.setSerialRate=function(a){a=this.__SERIAL_BAUDS[a];"number"==typeof a&&(this.serialRate=a,this.__setSerialModePid())};Cheese.prototype.getSerialInput=function(){return this.serialInput};
Cheese.prototype.pidStart=function(a){switch(a){case "PID-10 ultrasonic sensor (HC-SR04+)":this.motoring.outputLa=0;this.__setModeLa(255);this.__setModePid(10);break;case "PID-11-1 humidity/temperature sensor (DHT11)":this.motoring.outputLa=1;this.__setModeLa(255);this.__setModePid(11);break;case "PID-11-2 humidity/temperature sensor (DHT21)":this.motoring.outputLa=2;this.__setModeLa(255);this.__setModePid(11);break;case "PID-11-3 humidity/temperature sensor (DHT22)":this.motoring.outputLa=3;this.__setModeLa(255);
this.__setModePid(11);break;case "PID-12 temperature sensor (DS18B20)":this.__setModePid(12);break;case "PID-13 joystick and button":this.__setModePid(13);break;case "PID-14 dual joystick":this.__setModePid(14);break;case "PID-15 IR transceiver":this.__setModePid(15);break;case "PID-16 encoder":this.__setModePid(16),this.__resetEncoder()}};
Cheese.prototype.pidSetRange=function(a,b,c,d,e,f){b=parseFloat(b);c=parseFloat(c);d=parseFloat(d);e=parseFloat(e);"number"==typeof b&&"number"==typeof c&&"number"==typeof d&&"number"==typeof e&&this.range.setLowHigh(a,b,c,d,e,"with"==f)};
Cheese.prototype.pidSetThreeRanges=function(a,b,c,d,e,f,g,h){b=parseFloat(b);c=parseFloat(c);d=parseFloat(d);e=parseFloat(e);f=parseFloat(f);g=parseFloat(g);"number"==typeof b&&"number"==typeof c&&"number"==typeof d&&"number"==typeof e&&"number"==typeof f&&"number"==typeof g&&this.range.setLowMidHigh(a,b,c,d,e,f,g,"with"==h)};
Cheese.prototype.__resetEncoder=function(){if(16==this.motoring.modePid){this.resetEncoderFlag=this.resetEncoderFlag%255+1;var a=this.__getOrCreatePidArray(this.motoring);a[0]=49;a[1]=this.resetEncoderFlag;this.__issuePid()}};Cheese.prototype.pidResetEncoder=function(){this.__resetEncoder()};
Cheese.prototype.pidGetInput=function(a){switch(a){case "distance (cm)":return this.pid.getDistance();case "temperature (\u2103)":return this.pid.getTemperature();case "humidity (%RH)":return this.pid.getHumidity();case "x1":return this.range.calc("x1",this.pid.getX1());case "y1":return this.range.calc("y1",this.pid.getY1());case "x2":return this.range.calc("x2",this.pid.getX2());case "y2":return this.range.calc("y2",this.pid.getY2());case "button1":return this.pid.getButton1();case "button2":return this.pid.getButton2();
case "encoder":return this.pid.getEncoder()}return 0};Cheese.prototype.pidCheckButtonState=function(a,b){switch(a){case "1":switch(b){case "clicked":return this.pid.isButton1Clicked();case "long-pressed":return this.pid.isButton1LongPressed()}break;case "2":switch(b){case "clicked":return this.pid.isButton2Clicked();case "long-pressed":return this.pid.isButton2LongPressed()}}return!1};Cheese.prototype.hat010Start=function(){this.hat.start(10)};
Cheese.prototype.hat010GetButton=function(a){var b=this.hat.getHat(10);if(b)switch(a){case "A":return b.getButtonA();case "B":return b.getButtonB()}return 0};Cheese.prototype.hat010CheckButtonState=function(a,b){var c=this.hat.getHat(10);if(c)switch(a){case "A":switch(b){case "clicked":return c.isButtonAClicked();case "long-pressed":return c.isButtonALongPressed()}break;case "B":switch(b){case "clicked":return c.isButtonBClicked();case "long-pressed":return c.isButtonBLongPressed()}}};
Cheese.prototype.__LED_MATRIX_COLORS={red:4,orange:8,yellow:6,green:2,"sky blue":3,blue:1,purple:5,violet:9,white:7};Cheese.prototype.hat010BackgroundTurnOnXY=function(a,b,c){var d=this.hat.getHat(10);a=parseInt(a);b=parseInt(b);c=this.__LED_MATRIX_COLORS[c];d&&"number"==typeof a&&"number"==typeof b&&"number"==typeof c&&(d.getLedMatrix().setBackgroundPixel(a,b,c),d.issueMatrixUpdate())};
Cheese.prototype.hat010BackgroundTurnOffXY=function(a,b){var c=this.hat.getHat(10);a=parseInt(a);b=parseInt(b);c&&"number"==typeof a&&"number"==typeof b&&(c.getLedMatrix().setBackgroundPixel(a,b,0),c.issueMatrixUpdate())};Cheese.prototype.hat010BackgroundDrawShapeAtXY=function(a,b,c,d){var e=this.hat.getHat(10);c=parseInt(c);d=parseInt(d);a=this.__LED_MATRIX_COLORS[a];e&&"number"==typeof c&&"number"==typeof d&&"number"==typeof a&&b&&e.getLedMatrix().drawBackgroundShape(c,d,b,a)&&e.issueMatrixUpdate()};
Cheese.prototype.hat010BackgroundDrawStringAtXY=function(a,b,c,d){var e=this.hat.getHat(10);c=parseInt(c);d=parseInt(d);a=this.__LED_MATRIX_COLORS[a];e&&"number"==typeof c&&"number"==typeof d&&"number"==typeof a&&b&&e.getLedMatrix().drawBackgroundString(c,d,b,a)&&e.issueMatrixUpdate()};
Cheese.prototype.hat010BackgroundDrawPatternAtXY=function(a,b,c,d){var e=this.hat.getHat(10);c=parseInt(c);d=parseInt(d);a=this.__LED_MATRIX_COLORS[a];e&&"number"==typeof c&&"number"==typeof d&&"number"==typeof a&&b&&e.getLedMatrix().drawBackgroundPattern(c,d,b,a)&&e.issueMatrixUpdate()};Cheese.prototype.hat010Clear=function(a){var b=this.hat.getHat(10);b&&("all"==a?b.getLedMatrix().clearAll():b.getLedMatrix().clearBackground(),b.issueMatrixUpdate())};
Cheese.prototype.hat010ScrollByXY=function(a,b,c){var d=this.hat.getHat(10);b=parseInt(b);c=parseInt(c);d&&"number"==typeof b&&"number"==typeof c&&("all"==a?d.getLedMatrix().scrollAllBy(b,c):d.getLedMatrix().scrollBackgroundBy(b,c),d.issueMatrixUpdate())};Cheese.prototype.hat010SpriteSetToShape=function(a,b,c){var d=this.hat.getHat(10);a=parseInt(a);b=this.__LED_MATRIX_COLORS[b];d&&"number"==typeof a&&"number"==typeof b&&c&&d.getLedMatrix().setSpriteShape(a,c,b)&&d.issueMatrixUpdate()};
Cheese.prototype.hat010SpriteSetToString=function(a,b,c){var d=this.hat.getHat(10);a=parseInt(a);b=this.__LED_MATRIX_COLORS[b];d&&"number"==typeof a&&"number"==typeof b&&c&&d.getLedMatrix().setSpriteString(a,c,b)&&d.issueMatrixUpdate()};Cheese.prototype.hat010SpriteSetToPattern=function(a,b,c){var d=this.hat.getHat(10);a=parseInt(a);b=this.__LED_MATRIX_COLORS[b];d&&"number"==typeof a&&"number"==typeof b&&c&&d.getLedMatrix().setSpritePattern(a,c,b)&&d.issueMatrixUpdate()};
Cheese.prototype.hat010SpriteClearShowHide=function(a,b){var c=this.hat.getHat(10);a=parseInt(a);if(c&&"number"==typeof a){switch(b){case "clear":c.getLedMatrix().clearSprite(a);break;case "show":c.getLedMatrix().showSprite(a);break;case "hide":c.getLedMatrix().hideSprite(a)}c.issueMatrixUpdate()}};
Cheese.prototype.hat010SpriteChangePositionsByXY=function(a,b,c){var d=this.hat.getHat(10);a=parseInt(a);b=parseInt(b);c=parseInt(c);d&&"number"==typeof a&&"number"==typeof b&&"number"==typeof c&&(d.getLedMatrix().changeSpritePositionsBy(a,b,c),d.issueMatrixUpdate())};
Cheese.prototype.hat010SpriteSetPositionsToXY=function(a,b,c){var d=this.hat.getHat(10);a=parseInt(a);b=parseInt(b);c=parseInt(c);d&&"number"==typeof a&&"number"==typeof b&&"number"==typeof c&&(d.getLedMatrix().setSpritePositionsTo(a,b,c),d.issueMatrixUpdate())};Cheese.prototype.hat010SpriteChangePositionByValue=function(a,b,c){var d=this.hat.getHat(10);a=parseInt(a);c=parseInt(c);d&&"number"==typeof a&&"number"==typeof c&&(d.getLedMatrix().changeSpritePositionBy(a,"x"==b,c),d.issueMatrixUpdate())};
Cheese.prototype.hat010SpriteSetPositionToValue=function(a,b,c){var d=this.hat.getHat(10);a=parseInt(a);c=parseInt(c);d&&"number"==typeof a&&"number"==typeof c&&(d.getLedMatrix().setSpritePositionTo(a,"x"==b,c),d.issueMatrixUpdate())};Cheese.prototype.hat010SpriteRotate=function(a,b){var c=this.hat.getHat(10);a=parseInt(a);c&&"number"==typeof a&&(c.getLedMatrix().rotateSprite(a,"clockwise"==b),c.issueMatrixUpdate())};
Cheese.prototype.hat010SpriteFlipInDirection=function(a,b){var c=this.hat.getHat(10);a=parseInt(a);c&&"number"==typeof a&&(c.getLedMatrix().flipSprite(a,"left-right"==b),c.issueMatrixUpdate())};Cheese.prototype.hat010SpriteStampToBackground=function(a){var b=this.hat.getHat(10);a=parseInt(a);b&&"number"==typeof a&&(b.getLedMatrix().stampSprite(a),b.issueMatrixUpdate())};
Cheese.prototype.hat010GetSpritePosition=function(a,b){var c=this.hat.getHat(10);a=parseInt(a);return c&&"number"==typeof a?c.getLedMatrix().getSpritePosition(a,"x"==b):0};Cheese.prototype.hat010CheckCheckSpriteSpriteTouched=function(a,b){var c=this.hat.getHat(10);a=parseInt(a);b=parseInt(b);return c&&"number"==typeof a&&"number"==typeof b?(c=c.getLedMatrix(),c.update(),c.checkSpritesTouched(a,b)):!1};
Cheese.prototype.hat010CheckCheckSpriteTouched=function(a,b){var c=this.hat.getHat(10);a=parseInt(a);if(c&&"number"==typeof a)switch(c=c.getLedMatrix(),c.update(),b){case "background":return c.checkBackgroundTouched(a);case "other sprite":return c.checkOtherSpriteTouched(a);case "left wall":return c.checkWallTouched(a,0);case "right wall":return c.checkWallTouched(a,1);case "top wall":return c.checkWallTouched(a,2);case "bottom wall":return c.checkWallTouched(a,3);case "any wall":return c.checkWallTouched(a,
-1)}return!1};Cheese.prototype.hat010ChangeBrightnessBy=function(a){var b=this.hat.getHat(10);a=parseInt(a);b&&"number"==typeof a&&(b.getLedMatrix().changeBrightnessBy(a),b.issueMatrixUpdate())};Cheese.prototype.hat010SetBrightnessTo=function(a){var b=this.hat.getHat(10);a=parseInt(a);b&&"number"==typeof a&&(b.getLedMatrix().setBrightnessTo(a),b.issueMatrixUpdate())};
